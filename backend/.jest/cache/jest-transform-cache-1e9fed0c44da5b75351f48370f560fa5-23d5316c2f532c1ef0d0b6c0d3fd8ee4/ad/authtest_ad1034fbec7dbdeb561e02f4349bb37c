2a35c8da28a97a9fff19e9b31d1385cb
// Mock models
_getJestObj().mock('../../models/User', () => ({
  findById: jest.fn()
}));
function _getJestObj() {
  const {
    jest
  } = require("@jest/globals");
  _getJestObj = () => jest;
  return jest;
}
const jwt = require('jsonwebtoken');
const express = require('express');

// Import authenticateToken function directly since it's not exported
let authenticateToken;

// This approach creates the middleware function locally for testing
const _createApp = require('express')();

// JWT authentication middleware (same as in server.js)
authenticateToken = async (req, res, next) => {
  try {
    const authHeader = req.headers['authorization'];
    const token = authHeader && authHeader.split(' ')[1];
    if (!token) {
      return res.status(401).json({
        error: 'Access token required',
        code: 'NO_TOKEN'
      });
    }
    const {
      User
    } = require('../../models/User');
    const decoded = jwt.verify(token, process.env.JWT_SECRET);
    const user = await User.findById(decoded.userId);
    if (!user) {
      return res.status(401).json({
        error: 'User not found',
        code: 'USER_NOT_FOUND'
      });
    }
    req.user = user;
    next();
  } catch (error) {
    if (error.name === 'JsonWebTokenError') {
      return res.status(401).json({
        error: 'Invalid token format',
        code: 'INVALID_TOKEN_FORMAT'
      });
    }
    if (error.name === 'TokenExpiredError') {
      return res.status(401).json({
        error: 'Token has expired',
        code: 'TOKEN_EXPIRED'
      });
    }
    return res.status(401).json({
      error: 'Token verification failed',
      code: 'TOKEN_VERIFICATION_FAILED'
    });
  }
};
const User = require('../../models/User');
describe('Authentication Middleware', () => {
  let mockReq;
  let mockRes;
  let mockNext;
  beforeEach(() => {
    // Process.env.JWT_SECRET установлен в setup.js для тестов
    process.env.JWT_SECRET = 'your_super_secure_jwt_secret_key_here_replace_in_production';
    mockReq = {
      headers: {}
    };
    mockRes = {
      status: jest.fn().mockReturnThis(),
      json: jest.fn()
    };
    mockNext = jest.fn();
  });
  afterEach(() => {
    jest.clearAllMocks();
  });
  describe('authenticateToken', () => {
    it('should authenticate user with valid token', async () => {
      const userId = '507f1f77bcf86cd799439011';
      const token = jwt.sign({
        id: userId
      }, process.env.JWT_SECRET || 'test-secret');
      const mockUser = {
        _id: userId,
        nickname: 'testuser',
        role: 'member'
      };
      mockReq.headers.authorization = `Bearer ${token}`;
      User.findById.mockResolvedValue(mockUser);
      await authenticateToken(mockReq, mockRes, mockNext);
      expect(mockNext).toHaveBeenCalled();
      expect(mockReq.user).toEqual(mockUser);
      expect(User.findById).toHaveBeenCalledWith(userId);
    });
    it('should return 401 when no token is provided', async () => {
      delete mockReq.headers.authorization;
      await authenticateToken(mockReq, mockRes, mockNext);
      expect(mockNext).not.toHaveBeenCalled();
      expect(mockRes.status).toHaveBeenCalledWith(401);
      expect(mockRes.json).toHaveBeenCalledWith({
        error: 'Access token required',
        code: 'NO_TOKEN'
      });
    });
    it('should return 401 with malformed authorization header', async () => {
      mockReq.headers.authorization = 'InvalidTokenFormat';
      await authenticateToken(mockReq, mockRes, mockNext);
      expect(mockNext).not.toHaveBeenCalled();
      expect(mockRes.status).toHaveBeenCalledWith(401);
      expect(mockRes.json).toHaveBeenCalledWith({
        error: 'Access token required',
        code: 'NO_TOKEN'
      });
    });
    it('should handle JWT verification errors', async () => {
      const invalidToken = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.invalid';
      mockReq.headers.authorization = `Bearer ${invalidToken}`;
      await authenticateToken(mockReq, mockRes, mockNext);
      expect(mockNext).not.toHaveBeenCalled();
      expect(mockRes.status).toHaveBeenCalledWith(401);
      expect(mockRes.json).toHaveBeenCalledWith({
        error: 'Token verification failed',
        code: 'TOKEN_VERIFICATION_FAILED'
      });
    });
    it('should handle expired tokens', async () => {
      const expiredToken = jwt.sign({
        id: 'testId'
      }, 'test-secret', {
        expiresIn: '-1h'
      });
      mockReq.headers.authorization = `Bearer ${expiredToken}`;
      await authenticateToken(mockReq, mockRes, mockNext);
      expect(mockNext).not.toHaveBeenCalled();
      expect(mockRes.status).toHaveBeenCalledWith(401);
      expect(mockRes.json).toHaveBeenCalledWith({
        error: 'Token has expired',
        code: 'TOKEN_EXPIRED'
      });
    });
    it('should handle malformed JWT tokens', async () => {
      mockReq.headers.authorization = 'Bearer not-a-jwt-token';
      await authenticateToken(mockReq, mockRes, mockNext);
      expect(mockNext).not.toHaveBeenCalled();
      expect(mockRes.status).toHaveBeenCalledWith(401);
      expect(mockRes.json).toHaveBeenCalledWith({
        error: 'Invalid token format',
        code: 'INVALID_TOKEN_FORMAT'
      });
    });
    it('should return 401 when user is not found', async () => {
      const token = jwt.sign({
        id: 'nonexistent'
      }, process.env.JWT_SECRET || 'test-secret');
      mockReq.headers.authorization = `Bearer ${token}`;
      User.findById.mockResolvedValue(null);
      await authenticateToken(mockReq, mockRes, mockNext);
      expect(mockNext).not.toHaveBeenCalled();
      expect(mockRes.status).toHaveBeenCalledWith(401);
      expect(mockRes.json).toHaveBeenCalledWith({
        error: 'User not found',
        code: 'USER_NOT_FOUND'
      });
    });
    it('should handle database errors during user lookup', async () => {
      const token = jwt.sign({
        id: 'testid'
      }, process.env.JWT_SECRET || 'test-secret');
      mockReq.headers.authorization = `Bearer ${token}`;
      const dbError = new Error('Database connection failed');
      User.findById.mockRejectedValue(dbError);

      // Override console methods to avoid spam
      const originalConsole = global.console;
      global.console = {
        warn: jest.fn(),
        error: jest.fn()
      };
      await authenticateToken(mockReq, mockRes, mockNext);

      // Restore console
      global.console = originalConsole;
      expect(mockNext).not.toHaveBeenCalled();
      expect(mockRes.status).toHaveBeenCalledWith(401);
      expect(mockRes.json).toHaveBeenCalledWith({
        error: 'Token verification failed',
        code: 'TOKEN_VERIFICATION_FAILED'
      });
    });
  });
  describe('Token extraction', () => {
    it('should extract token from Bearer authorization header', async () => {
      const token = jwt.sign({
        id: 'testId'
      }, process.env.JWT_SECRET || 'test-secret');
      const authorization = `Bearer ${token}`;
      const mockUser = {
        _id: 'testId',
        nickname: 'testuser'
      };
      mockReq.headers.authorization = authorization;
      User.findById.mockResolvedValue(mockUser);
      await authenticateToken(mockReq, mockRes, mockNext);
      expect(mockNext).toHaveBeenCalled();
      expect(User.findById).toHaveBeenCalledWith('testId');
    });
    it('should handle extra whitespace in authorization header', async () => {
      const token = jwt.sign({
        id: 'whitespacetest'
      }, process.env.JWT_SECRET || 'test-secret');
      mockReq.headers.authorization = `  Bearer    ${token}   `;
      const mockUser = {
        _id: 'whitespacetest',
        nickname: 'testuser'
      };
      User.findById.mockResolvedValue(mockUser);
      await authenticateToken(mockReq, mockRes, mockNext);
      expect(mockNext).toHaveBeenCalled();
      expect(User.findById).toHaveBeenCalledWith('whitespacetest');
    });
  });
  describe('Request properties', () => {
    it('should attach user to request object', async () => {
      const token = jwt.sign({
        id: 'attachTest'
      }, process.env.JWT_SECRET || 'test-secret');
      mockReq.headers.authorization = `Bearer ${token}`;
      const mockUser = {
        _id: 'attachTest',
        nickname: 'attachUser',
        role: 'admin'
      };
      User.findById.mockResolvedValue(mockUser);
      await authenticateToken(mockReq, mockRes, mockNext);
      expect(mockReq.user).toEqual(mockUser);
      expect(mockReq.user._id).toBe('attachTest');
      expect(mockReq.user.nickname).toBe('attachUser');
      expect(mockReq.user.role).toBe('admin');
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfZ2V0SmVzdE9iaiIsIm1vY2siLCJmaW5kQnlJZCIsImplc3QiLCJmbiIsInJlcXVpcmUiLCJqd3QiLCJleHByZXNzIiwiYXV0aGVudGljYXRlVG9rZW4iLCJfY3JlYXRlQXBwIiwicmVxIiwicmVzIiwibmV4dCIsImF1dGhIZWFkZXIiLCJoZWFkZXJzIiwidG9rZW4iLCJzcGxpdCIsInN0YXR1cyIsImpzb24iLCJlcnJvciIsImNvZGUiLCJVc2VyIiwiZGVjb2RlZCIsInZlcmlmeSIsInByb2Nlc3MiLCJlbnYiLCJKV1RfU0VDUkVUIiwidXNlciIsInVzZXJJZCIsIm5hbWUiLCJkZXNjcmliZSIsIm1vY2tSZXEiLCJtb2NrUmVzIiwibW9ja05leHQiLCJiZWZvcmVFYWNoIiwibW9ja1JldHVyblRoaXMiLCJhZnRlckVhY2giLCJjbGVhckFsbE1vY2tzIiwiaXQiLCJzaWduIiwiaWQiLCJtb2NrVXNlciIsIl9pZCIsIm5pY2tuYW1lIiwicm9sZSIsImF1dGhvcml6YXRpb24iLCJtb2NrUmVzb2x2ZWRWYWx1ZSIsImV4cGVjdCIsInRvSGF2ZUJlZW5DYWxsZWQiLCJ0b0VxdWFsIiwidG9IYXZlQmVlbkNhbGxlZFdpdGgiLCJub3QiLCJpbnZhbGlkVG9rZW4iLCJleHBpcmVkVG9rZW4iLCJleHBpcmVzSW4iLCJkYkVycm9yIiwiRXJyb3IiLCJtb2NrUmVqZWN0ZWRWYWx1ZSIsIm9yaWdpbmFsQ29uc29sZSIsImdsb2JhbCIsImNvbnNvbGUiLCJ3YXJuIiwidG9CZSJdLCJzb3VyY2VzIjpbImF1dGgudGVzdC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBqd3QgPSByZXF1aXJlKCdqc29ud2VidG9rZW4nKTtcbmNvbnN0IGV4cHJlc3MgPSByZXF1aXJlKCdleHByZXNzJyk7XG5cbi8vIEltcG9ydCBhdXRoZW50aWNhdGVUb2tlbiBmdW5jdGlvbiBkaXJlY3RseSBzaW5jZSBpdCdzIG5vdCBleHBvcnRlZFxubGV0IGF1dGhlbnRpY2F0ZVRva2VuO1xuXG4vLyBUaGlzIGFwcHJvYWNoIGNyZWF0ZXMgdGhlIG1pZGRsZXdhcmUgZnVuY3Rpb24gbG9jYWxseSBmb3IgdGVzdGluZ1xuY29uc3QgX2NyZWF0ZUFwcCA9IHJlcXVpcmUoJ2V4cHJlc3MnKSgpO1xuXG4vLyBKV1QgYXV0aGVudGljYXRpb24gbWlkZGxld2FyZSAoc2FtZSBhcyBpbiBzZXJ2ZXIuanMpXG5hdXRoZW50aWNhdGVUb2tlbiA9IGFzeW5jIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IGF1dGhIZWFkZXIgPSByZXEuaGVhZGVyc1snYXV0aG9yaXphdGlvbiddO1xuICAgIGNvbnN0IHRva2VuID0gYXV0aEhlYWRlciAmJiBhdXRoSGVhZGVyLnNwbGl0KCcgJylbMV07XG5cbiAgICBpZiAoIXRva2VuKSB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oe1xuICAgICAgICBlcnJvcjogJ0FjY2VzcyB0b2tlbiByZXF1aXJlZCcsXG4gICAgICAgIGNvZGU6ICdOT19UT0tFTidcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGNvbnN0IHsgVXNlciB9ID0gcmVxdWlyZSgnLi4vLi4vbW9kZWxzL1VzZXInKTtcbiAgICBjb25zdCBkZWNvZGVkID0gand0LnZlcmlmeSh0b2tlbiwgcHJvY2Vzcy5lbnYuSldUX1NFQ1JFVCk7XG4gICAgY29uc3QgdXNlciA9IGF3YWl0IFVzZXIuZmluZEJ5SWQoZGVjb2RlZC51c2VySWQpO1xuXG4gICAgaWYgKCF1c2VyKSB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oe1xuICAgICAgICBlcnJvcjogJ1VzZXIgbm90IGZvdW5kJyxcbiAgICAgICAgY29kZTogJ1VTRVJfTk9UX0ZPVU5EJ1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgcmVxLnVzZXIgPSB1c2VyO1xuICAgIG5leHQoKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBpZiAoZXJyb3IubmFtZSA9PT0gJ0pzb25XZWJUb2tlbkVycm9yJykge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAxKS5qc29uKHtcbiAgICAgICAgZXJyb3I6ICdJbnZhbGlkIHRva2VuIGZvcm1hdCcsXG4gICAgICAgIGNvZGU6ICdJTlZBTElEX1RPS0VOX0ZPUk1BVCdcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGlmIChlcnJvci5uYW1lID09PSAnVG9rZW5FeHBpcmVkRXJyb3InKSB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oe1xuICAgICAgICBlcnJvcjogJ1Rva2VuIGhhcyBleHBpcmVkJyxcbiAgICAgICAgY29kZTogJ1RPS0VOX0VYUElSRUQnXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oe1xuICAgICAgZXJyb3I6ICdUb2tlbiB2ZXJpZmljYXRpb24gZmFpbGVkJyxcbiAgICAgIGNvZGU6ICdUT0tFTl9WRVJJRklDQVRJT05fRkFJTEVEJ1xuICAgIH0pO1xuICB9XG59O1xuXG4vLyBNb2NrIG1vZGVsc1xuamVzdC5tb2NrKCcuLi8uLi9tb2RlbHMvVXNlcicsICgpID0+ICh7XG4gIGZpbmRCeUlkOiBqZXN0LmZuKClcbn0pKTtcblxuY29uc3QgVXNlciA9IHJlcXVpcmUoJy4uLy4uL21vZGVscy9Vc2VyJyk7XG5cbmRlc2NyaWJlKCdBdXRoZW50aWNhdGlvbiBNaWRkbGV3YXJlJywgKCkgPT4ge1xuICBsZXQgbW9ja1JlcTtcbiAgbGV0IG1vY2tSZXM7XG4gIGxldCBtb2NrTmV4dDtcblxuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICAvLyBQcm9jZXNzLmVudi5KV1RfU0VDUkVUINGD0YHRgtCw0L3QvtCy0LvQtdC9INCyIHNldHVwLmpzINC00LvRjyDRgtC10YHRgtC+0LJcbiAgICBwcm9jZXNzLmVudi5KV1RfU0VDUkVUID0gJ3lvdXJfc3VwZXJfc2VjdXJlX2p3dF9zZWNyZXRfa2V5X2hlcmVfcmVwbGFjZV9pbl9wcm9kdWN0aW9uJztcbiAgICBtb2NrUmVxID0ge1xuICAgICAgaGVhZGVyczoge31cbiAgICB9O1xuICAgIG1vY2tSZXMgPSB7XG4gICAgICBzdGF0dXM6IGplc3QuZm4oKS5tb2NrUmV0dXJuVGhpcygpLFxuICAgICAganNvbjogamVzdC5mbigpXG4gICAgfTtcbiAgICBtb2NrTmV4dCA9IGplc3QuZm4oKTtcbiAgfSk7XG5cbiAgYWZ0ZXJFYWNoKCgpID0+IHtcbiAgICBqZXN0LmNsZWFyQWxsTW9ja3MoKTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2F1dGhlbnRpY2F0ZVRva2VuJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgYXV0aGVudGljYXRlIHVzZXIgd2l0aCB2YWxpZCB0b2tlbicsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHVzZXJJZCA9ICc1MDdmMWY3N2JjZjg2Y2Q3OTk0MzkwMTEnO1xuICAgICAgY29uc3QgdG9rZW4gPSBqd3Quc2lnbih7IGlkOiB1c2VySWQgfSwgcHJvY2Vzcy5lbnYuSldUX1NFQ1JFVCB8fCAndGVzdC1zZWNyZXQnKTtcbiAgICAgIGNvbnN0IG1vY2tVc2VyID0ge1xuICAgICAgICBfaWQ6IHVzZXJJZCxcbiAgICAgICAgbmlja25hbWU6ICd0ZXN0dXNlcicsXG4gICAgICAgIHJvbGU6ICdtZW1iZXInXG4gICAgICB9O1xuXG4gICAgICBtb2NrUmVxLmhlYWRlcnMuYXV0aG9yaXphdGlvbiA9IGBCZWFyZXIgJHt0b2tlbn1gO1xuICAgICAgVXNlci5maW5kQnlJZC5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrVXNlcik7XG5cbiAgICAgIGF3YWl0IGF1dGhlbnRpY2F0ZVRva2VuKG1vY2tSZXEsIG1vY2tSZXMsIG1vY2tOZXh0KTtcblxuICAgICAgZXhwZWN0KG1vY2tOZXh0KS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgICBleHBlY3QobW9ja1JlcS51c2VyKS50b0VxdWFsKG1vY2tVc2VyKTtcbiAgICAgIGV4cGVjdChVc2VyLmZpbmRCeUlkKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh1c2VySWQpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gNDAxIHdoZW4gbm8gdG9rZW4gaXMgcHJvdmlkZWQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBkZWxldGUgbW9ja1JlcS5oZWFkZXJzLmF1dGhvcml6YXRpb247XG5cbiAgICAgIGF3YWl0IGF1dGhlbnRpY2F0ZVRva2VuKG1vY2tSZXEsIG1vY2tSZXMsIG1vY2tOZXh0KTtcblxuICAgICAgZXhwZWN0KG1vY2tOZXh0KS5ub3QudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgICAgZXhwZWN0KG1vY2tSZXMuc3RhdHVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCg0MDEpO1xuICAgICAgZXhwZWN0KG1vY2tSZXMuanNvbikudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICBlcnJvcjogJ0FjY2VzcyB0b2tlbiByZXF1aXJlZCcsXG4gICAgICAgIGNvZGU6ICdOT19UT0tFTidcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gNDAxIHdpdGggbWFsZm9ybWVkIGF1dGhvcml6YXRpb24gaGVhZGVyJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja1JlcS5oZWFkZXJzLmF1dGhvcml6YXRpb24gPSAnSW52YWxpZFRva2VuRm9ybWF0JztcblxuICAgICAgYXdhaXQgYXV0aGVudGljYXRlVG9rZW4obW9ja1JlcSwgbW9ja1JlcywgbW9ja05leHQpO1xuXG4gICAgICBleHBlY3QobW9ja05leHQpLm5vdC50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgICBleHBlY3QobW9ja1Jlcy5zdGF0dXMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKDQwMSk7XG4gICAgICBleHBlY3QobW9ja1Jlcy5qc29uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgIGVycm9yOiAnQWNjZXNzIHRva2VuIHJlcXVpcmVkJyxcbiAgICAgICAgY29kZTogJ05PX1RPS0VOJ1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBKV1QgdmVyaWZpY2F0aW9uIGVycm9ycycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGludmFsaWRUb2tlbiA9ICdleUpoYkdjaU9pSklVekkxTmlJc0luUjVjQ0k2SWtwWFZDSjkuaW52YWxpZCc7XG4gICAgICBtb2NrUmVxLmhlYWRlcnMuYXV0aG9yaXphdGlvbiA9IGBCZWFyZXIgJHtpbnZhbGlkVG9rZW59YDtcblxuICAgICAgYXdhaXQgYXV0aGVudGljYXRlVG9rZW4obW9ja1JlcSwgbW9ja1JlcywgbW9ja05leHQpO1xuXG4gICAgICBleHBlY3QobW9ja05leHQpLm5vdC50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgICBleHBlY3QobW9ja1Jlcy5zdGF0dXMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKDQwMSk7XG4gICAgICBleHBlY3QobW9ja1Jlcy5qc29uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgIGVycm9yOiAnVG9rZW4gdmVyaWZpY2F0aW9uIGZhaWxlZCcsXG4gICAgICAgIGNvZGU6ICdUT0tFTl9WRVJJRklDQVRJT05fRkFJTEVEJ1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBleHBpcmVkIHRva2VucycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGV4cGlyZWRUb2tlbiA9IGp3dC5zaWduKHsgaWQ6ICd0ZXN0SWQnIH0sICd0ZXN0LXNlY3JldCcsIHsgZXhwaXJlc0luOiAnLTFoJyB9KTtcbiAgICAgIG1vY2tSZXEuaGVhZGVycy5hdXRob3JpemF0aW9uID0gYEJlYXJlciAke2V4cGlyZWRUb2tlbn1gO1xuXG4gICAgICBhd2FpdCBhdXRoZW50aWNhdGVUb2tlbihtb2NrUmVxLCBtb2NrUmVzLCBtb2NrTmV4dCk7XG5cbiAgICAgIGV4cGVjdChtb2NrTmV4dCkubm90LnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICAgIGV4cGVjdChtb2NrUmVzLnN0YXR1cykudG9IYXZlQmVlbkNhbGxlZFdpdGgoNDAxKTtcbiAgICAgIGV4cGVjdChtb2NrUmVzLmpzb24pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgZXJyb3I6ICdUb2tlbiBoYXMgZXhwaXJlZCcsXG4gICAgICAgIGNvZGU6ICdUT0tFTl9FWFBJUkVEJ1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBtYWxmb3JtZWQgSldUIHRva2VucycsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tSZXEuaGVhZGVycy5hdXRob3JpemF0aW9uID0gJ0JlYXJlciBub3QtYS1qd3QtdG9rZW4nO1xuXG4gICAgICBhd2FpdCBhdXRoZW50aWNhdGVUb2tlbihtb2NrUmVxLCBtb2NrUmVzLCBtb2NrTmV4dCk7XG5cbiAgICAgIGV4cGVjdChtb2NrTmV4dCkubm90LnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICAgIGV4cGVjdChtb2NrUmVzLnN0YXR1cykudG9IYXZlQmVlbkNhbGxlZFdpdGgoNDAxKTtcbiAgICAgIGV4cGVjdChtb2NrUmVzLmpzb24pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgZXJyb3I6ICdJbnZhbGlkIHRva2VuIGZvcm1hdCcsXG4gICAgICAgIGNvZGU6ICdJTlZBTElEX1RPS0VOX0ZPUk1BVCdcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gNDAxIHdoZW4gdXNlciBpcyBub3QgZm91bmQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCB0b2tlbiA9IGp3dC5zaWduKHsgaWQ6ICdub25leGlzdGVudCcgfSwgcHJvY2Vzcy5lbnYuSldUX1NFQ1JFVCB8fCAndGVzdC1zZWNyZXQnKTtcbiAgICAgIG1vY2tSZXEuaGVhZGVycy5hdXRob3JpemF0aW9uID0gYEJlYXJlciAke3Rva2VufWA7XG5cbiAgICAgIFVzZXIuZmluZEJ5SWQubW9ja1Jlc29sdmVkVmFsdWUobnVsbCk7XG5cbiAgICAgIGF3YWl0IGF1dGhlbnRpY2F0ZVRva2VuKG1vY2tSZXEsIG1vY2tSZXMsIG1vY2tOZXh0KTtcblxuICAgICAgZXhwZWN0KG1vY2tOZXh0KS5ub3QudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgICAgZXhwZWN0KG1vY2tSZXMuc3RhdHVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCg0MDEpO1xuICAgICAgZXhwZWN0KG1vY2tSZXMuanNvbikudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICBlcnJvcjogJ1VzZXIgbm90IGZvdW5kJyxcbiAgICAgICAgY29kZTogJ1VTRVJfTk9UX0ZPVU5EJ1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBkYXRhYmFzZSBlcnJvcnMgZHVyaW5nIHVzZXIgbG9va3VwJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgdG9rZW4gPSBqd3Quc2lnbih7IGlkOiAndGVzdGlkJyB9LCBwcm9jZXNzLmVudi5KV1RfU0VDUkVUIHx8ICd0ZXN0LXNlY3JldCcpO1xuICAgICAgbW9ja1JlcS5oZWFkZXJzLmF1dGhvcml6YXRpb24gPSBgQmVhcmVyICR7dG9rZW59YDtcblxuICAgICAgY29uc3QgZGJFcnJvciA9IG5ldyBFcnJvcignRGF0YWJhc2UgY29ubmVjdGlvbiBmYWlsZWQnKTtcbiAgICAgIFVzZXIuZmluZEJ5SWQubW9ja1JlamVjdGVkVmFsdWUoZGJFcnJvcik7XG5cbiAgICAgIC8vIE92ZXJyaWRlIGNvbnNvbGUgbWV0aG9kcyB0byBhdm9pZCBzcGFtXG4gICAgICBjb25zdCBvcmlnaW5hbENvbnNvbGUgPSBnbG9iYWwuY29uc29sZTtcbiAgICAgIGdsb2JhbC5jb25zb2xlID0ge1xuICAgICAgICB3YXJuOiBqZXN0LmZuKCksXG4gICAgICAgIGVycm9yOiBqZXN0LmZuKClcbiAgICAgIH07XG5cbiAgICAgIGF3YWl0IGF1dGhlbnRpY2F0ZVRva2VuKG1vY2tSZXEsIG1vY2tSZXMsIG1vY2tOZXh0KTtcblxuICAgICAgLy8gUmVzdG9yZSBjb25zb2xlXG4gICAgICBnbG9iYWwuY29uc29sZSA9IG9yaWdpbmFsQ29uc29sZTtcblxuICAgICAgZXhwZWN0KG1vY2tOZXh0KS5ub3QudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgICAgZXhwZWN0KG1vY2tSZXMuc3RhdHVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCg0MDEpO1xuICAgICAgZXhwZWN0KG1vY2tSZXMuanNvbikudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICBlcnJvcjogJ1Rva2VuIHZlcmlmaWNhdGlvbiBmYWlsZWQnLFxuICAgICAgICBjb2RlOiAnVE9LRU5fVkVSSUZJQ0FUSU9OX0ZBSUxFRCdcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnVG9rZW4gZXh0cmFjdGlvbicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGV4dHJhY3QgdG9rZW4gZnJvbSBCZWFyZXIgYXV0aG9yaXphdGlvbiBoZWFkZXInLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCB0b2tlbiA9IGp3dC5zaWduKHsgaWQ6ICd0ZXN0SWQnIH0sIHByb2Nlc3MuZW52LkpXVF9TRUNSRVQgfHwgJ3Rlc3Qtc2VjcmV0Jyk7XG4gICAgICBjb25zdCBhdXRob3JpemF0aW9uID0gYEJlYXJlciAke3Rva2VufWA7XG4gICAgICBjb25zdCBtb2NrVXNlciA9IHsgX2lkOiAndGVzdElkJywgbmlja25hbWU6ICd0ZXN0dXNlcicgfTtcblxuICAgICAgbW9ja1JlcS5oZWFkZXJzLmF1dGhvcml6YXRpb24gPSBhdXRob3JpemF0aW9uO1xuICAgICAgVXNlci5maW5kQnlJZC5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrVXNlcik7XG5cbiAgICAgIGF3YWl0IGF1dGhlbnRpY2F0ZVRva2VuKG1vY2tSZXEsIG1vY2tSZXMsIG1vY2tOZXh0KTtcblxuICAgICAgZXhwZWN0KG1vY2tOZXh0KS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgICBleHBlY3QoVXNlci5maW5kQnlJZCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ3Rlc3RJZCcpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgZXh0cmEgd2hpdGVzcGFjZSBpbiBhdXRob3JpemF0aW9uIGhlYWRlcicsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHRva2VuID0gand0LnNpZ24oeyBpZDogJ3doaXRlc3BhY2V0ZXN0JyB9LCBwcm9jZXNzLmVudi5KV1RfU0VDUkVUIHx8ICd0ZXN0LXNlY3JldCcpO1xuICAgICAgbW9ja1JlcS5oZWFkZXJzLmF1dGhvcml6YXRpb24gPSBgICBCZWFyZXIgICAgJHt0b2tlbn0gICBgO1xuICAgICAgY29uc3QgbW9ja1VzZXIgPSB7IF9pZDogJ3doaXRlc3BhY2V0ZXN0Jywgbmlja25hbWU6ICd0ZXN0dXNlcicgfTtcblxuICAgICAgVXNlci5maW5kQnlJZC5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrVXNlcik7XG5cbiAgICAgIGF3YWl0IGF1dGhlbnRpY2F0ZVRva2VuKG1vY2tSZXEsIG1vY2tSZXMsIG1vY2tOZXh0KTtcblxuICAgICAgZXhwZWN0KG1vY2tOZXh0KS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgICBleHBlY3QoVXNlci5maW5kQnlJZCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ3doaXRlc3BhY2V0ZXN0Jyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdSZXF1ZXN0IHByb3BlcnRpZXMnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBhdHRhY2ggdXNlciB0byByZXF1ZXN0IG9iamVjdCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHRva2VuID0gand0LnNpZ24oeyBpZDogJ2F0dGFjaFRlc3QnIH0sIHByb2Nlc3MuZW52LkpXVF9TRUNSRVQgfHwgJ3Rlc3Qtc2VjcmV0Jyk7XG4gICAgICBtb2NrUmVxLmhlYWRlcnMuYXV0aG9yaXphdGlvbiA9IGBCZWFyZXIgJHt0b2tlbn1gO1xuICAgICAgY29uc3QgbW9ja1VzZXIgPSB7IF9pZDogJ2F0dGFjaFRlc3QnLCBuaWNrbmFtZTogJ2F0dGFjaFVzZXInLCByb2xlOiAnYWRtaW4nIH07XG5cbiAgICAgIFVzZXIuZmluZEJ5SWQubW9ja1Jlc29sdmVkVmFsdWUobW9ja1VzZXIpO1xuXG4gICAgICBhd2FpdCBhdXRoZW50aWNhdGVUb2tlbihtb2NrUmVxLCBtb2NrUmVzLCBtb2NrTmV4dCk7XG5cbiAgICAgIGV4cGVjdChtb2NrUmVxLnVzZXIpLnRvRXF1YWwobW9ja1VzZXIpO1xuICAgICAgZXhwZWN0KG1vY2tSZXEudXNlci5faWQpLnRvQmUoJ2F0dGFjaFRlc3QnKTtcbiAgICAgIGV4cGVjdChtb2NrUmVxLnVzZXIubmlja25hbWUpLnRvQmUoJ2F0dGFjaFVzZXInKTtcbiAgICAgIGV4cGVjdChtb2NrUmVxLnVzZXIucm9sZSkudG9CZSgnYWRtaW4nKTtcbiAgICB9KTtcbiAgfSk7XG59KTsiXSwibWFwcGluZ3MiOiJBQXlEQTtBQUNBQSxXQUFBLEdBQUtDLElBQUksQ0FBQyxtQkFBbUIsRUFBRSxPQUFPO0VBQ3BDQyxRQUFRLEVBQUVDLElBQUksQ0FBQ0MsRUFBRSxDQUFDO0FBQ3BCLENBQUMsQ0FBQyxDQUFDO0FBQUMsU0FBQUosWUFBQTtFQUFBO0lBQUFHO0VBQUEsSUFBQUUsT0FBQTtFQUFBTCxXQUFBLEdBQUFBLENBQUEsS0FBQUcsSUFBQTtFQUFBLE9BQUFBLElBQUE7QUFBQTtBQTVESixNQUFNRyxHQUFHLEdBQUdELE9BQU8sQ0FBQyxjQUFjLENBQUM7QUFDbkMsTUFBTUUsT0FBTyxHQUFHRixPQUFPLENBQUMsU0FBUyxDQUFDOztBQUVsQztBQUNBLElBQUlHLGlCQUFpQjs7QUFFckI7QUFDQSxNQUFNQyxVQUFVLEdBQUdKLE9BQU8sQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDOztBQUV2QztBQUNBRyxpQkFBaUIsR0FBRyxNQUFBQSxDQUFPRSxHQUFHLEVBQUVDLEdBQUcsRUFBRUMsSUFBSSxLQUFLO0VBQzVDLElBQUk7SUFDRixNQUFNQyxVQUFVLEdBQUdILEdBQUcsQ0FBQ0ksT0FBTyxDQUFDLGVBQWUsQ0FBQztJQUMvQyxNQUFNQyxLQUFLLEdBQUdGLFVBQVUsSUFBSUEsVUFBVSxDQUFD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