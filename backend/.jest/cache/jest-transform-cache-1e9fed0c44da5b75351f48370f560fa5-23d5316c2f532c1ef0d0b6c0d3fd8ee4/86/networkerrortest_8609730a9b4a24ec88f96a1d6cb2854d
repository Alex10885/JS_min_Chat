016d515f83aeb448953bc9961f3b2b26
const request = require('supertest');
const mongoose = require('mongoose');
const {
  TestFixtures
} = require('../shared/testFixtures');
let app, closeDB;
beforeAll(async () => {
  const serverModule = require('../../server');
  app = require('../../server.js');
  const {
    closeDB: closeDBFn
  } = require('../../db/connection');
  closeDB = closeDBFn;
});
afterAll(async () => {
  if (closeDB) {
    await closeDB();
  }
});
describe('Error Recovery and Network Interruption Tests', () => {
  let validUser, accessToken;
  beforeAll(async () => {
    // Create test user
    const regResponse = await request(app).post('/api/register').send({
      nickname: 'error_recovery_test',
      email: 'error_recovery@example.com',
      password: 'testpass123'
    });
    validUser = regResponse.body.user;
    accessToken = regResponse.body.token;
  });
  describe('Database Connection Disruption', () => {
    it('should handle database disconnection gracefully', async () => {
      // Simulate database disconnection by closing MongoDB connection
      const originalConnection = mongoose.connection.readyState;
      try {
        // Force database disconnect
        await mongoose.disconnect();

        // Attempt API request during disconnection
        const response = await request(app).get('/api/channels').set('Authorization', `Bearer ${accessToken}`).timeout(5000);

        // Should return database error
        expect([500, 503]).toContain(response.status);
        expect(response.body).toHaveProperty('code', 'DATABASE_ERROR');
      } finally {
        // Reconnect database for other tests
        await mongoose.connect(process.env.MONGODB_URI || 'mongodb://localhost:27017/chat_js_test');
      }
    });
    it('should recover after database reconnection', async () => {
      // Ensure database is connected
      await mongoose.connect(process.env.MONGODB_URI || 'mongodb://localhost:27017/chat_js_test');
      const response = await request(app).get('/api/channels').set('Authorization', `Bearer ${accessToken}`).expect(200);
      expect(Array.isArray(response.body)).toBe(true);
    });
  });
  describe('Network Timeout Handling', () => {
    it('should handle slow database queries with timeout', async () => {
      // This test would require artificially slow database operations
      // For now, test the timeout configuration

      const startTime = Date.now();
      const response = await request(app).get('/api/channels').set('Authorization', `Bearer ${accessToken}`).timeout(30000); // Set explicit timeout

      const duration = Date.now() - startTime;

      // Response should complete within reasonable time
      expect(duration).toBeLessThan(30000);
      expect(response.status).toBe(200);
    });
    it('should handle client-side timeout', async () => {
      // Test client timeout behavior
      let timedOut = false;
      try {
        await request(app).get('/api/channels').set('Authorization', `Bearer ${accessToken}`).timeout(1); // Very short timeout
      } catch (error) {
        timedOut = true;
        expect(error.code).toBe('ECONNABORTED');
      }
      expect(timedOut).toBe(true);
    });
  });
  describe('Concurrent Request Handling', () => {
    it('should handle multiple concurrent requests without errors', async () => {
      const concurrentRequests = Array(10).fill().map(() => request(app).get('/api/channels').set('Authorization', `Bearer ${accessToken}`));
      const responses = await Promise.all(concurrentRequests);
      responses.forEach(response => {
        expect(response.status).toBe(200);
        expect(Array.isArray(response.body)).toBe(true);
      });
    });
    it('should handle mixed request types concurrently', async () => {
      const requests = [
      // Authentication request
      request(app).post('/api/login').send({
        identifier: 'error_recovery_test',
        password: 'testpass123'
      }),
      // Channel list request
      request(app).get('/api/channels').set('Authorization', `Bearer ${accessToken}`),
      // Health check
      request(app).get('/health'),
      // Invalid endpoint
      request(app).get('/api/nonexistent')];
      const responses = await Promise.allSettled(requests);
      const fulfilled = responses.filter(r => r.status === 'fulfilled');
      expect(fulfilled.length).toBeGreaterThan(0);
      fulfilled.forEach((result, index) => {
        const response = result.value;
        switch (index) {
          case 0:
            // Login
            expect(response.status).toBe(200);
            break;
          case 1:
            // Channels
            expect(response.status).toBe(200);
            break;
          case 2:
            // Health
            expect(response.status).toBe(200);
            break;
          case 3:
            // Invalid endpoint
            expect(response.status).toBe(404);
            break;
        }
      });
    });
  });
  describe('Rate Limit Recovery', () => {
    it('should recover from rate limiting after timeout period', async () => {
      // Get current timestamp for rate limit window
      const startTime = Date.now();

      // Send multiple requests to trigger rate limiting
      const rapidRequests = Array(15).fill().map(() => request(app).post('/api/login').send({
        identifier: 'test',
        password: 'test'
      }));

      // Execute all requests (some will be rate limited)
      await Promise.allSettled(rapidRequests);

      // Wait for rate limit to expire (15+ minutes would be needed for full recovery)
      // For testing, just verify rate limiting is working
      const limitedRequest = await request(app).post('/api/login').send({
        identifier: 'test',
        password: 'test'
      });

      // Should be rate limited
      expect([400, 429]).toContain(limitedRequest.status);
    });
  });
  describe('Memory Leak Prevention', () => {
    it('should handle memory-intensive operations without leaks', async () => {
      const initialMemory = process.memoryUsage().heapUsed;

      // Simulate multiple large requests
      const largeRequests = Array(50).fill().map((_, i) => request(app).get('/api/channels').set('Authorization', `Bearer ${accessToken}`)
      // Add large payload to simulate memory usage
      .set('User-Agent', 'a'.repeat(1000)));
      await Promise.all(largeRequests);
      const finalMemory = process.memoryUsage().heapUsed;

      // Memory usage should not increase dramatically
      const memoryIncrease = finalMemory - initialMemory;
      expect(memoryIncrease).toBeLessThan(50 * 1024 * 1024); // Less than 50MB increase
    });
  });
  describe('Service Degradation', () => {
    it('should handle requests during high CPU usage simulation', async () => {
      // Simulate CPU intensive operation
      const cpuIntensiveTask = () => {
        const start = Date.now();
        while (Date.now() - start < 1000) {
          Math.random() * Math.random();
        }
      };

      // Start CPU intensive operations
      const cpuPromises = Array(4).fill().map(() => new Promise(resolve => {
        setImmediate(() => {
          cpuIntensiveTask();
          resolve();
        });
      }));

      // Send request during CPU load
      const requestPromises = Array(5).fill().map(() => request(app).get('/health').timeout(10000));
      const [cpuResults, requestResults] = await Promise.all([Promise.all(cpuPromises), Promise.all(requestPromises)]);

      // All requests should complete successfully
      requestResults.forEach(response => {
        expect([200, 503]).toContain(response.status);
      });
    });
  });
  describe('Circuit Breaker Pattern', () => {
    it('should implement basic circuit breaker for database failures', async () => {
      // This would require custom circuit breaker implementation
      // For now, test database error handling

      // Force database error by dropping connection
      const originalConnection = mongoose.connection;
      await mongoose.disconnect();
      let consecutiveErrors = 0;
      const maxErrors = 5;
      for (let i = 0; i < maxErrors + 1; i++) {
        const response = await request(app).get('/api/channels').set('Authorization', `Bearer ${accessToken}`).timeout(5000);
        if (response.status === 500 || response.status === 503) {
          consecutiveErrors++;
        }
      }

      // Should have consecutive database errors
      expect(consecutiveErrors).toBeGreaterThan(0);

      // Reconnect for other tests
      await mongoose.connect(process.env.MONGODB_URI || 'mongodb://localhost:27017/chat_js_test');
    });
  });
  describe('Graceful Shutdown Scenarios', () => {
    it('should handle requests during application shutdown', async () => {
      // Start a long-running request
      const longRequest = request(app).get('/api/channels').set('Authorization', `Bearer ${accessToken}`).timeout(60000); // Long timeout for graceful shutdown test

      // Simulate shutdown signal
      // In real scenario, this would trigger graceful shutdown
      process.emit('SIGTERM');
      const response = await longRequest;

      // Request should either complete or be rejected gracefully
      expect([200, 503, 'ECONNABORTED']).toContain(response.status || response.code);
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJyZXF1ZXN0IiwicmVxdWlyZSIsIm1vbmdvb3NlIiwiVGVzdEZpeHR1cmVzIiwiYXBwIiwiY2xvc2VEQiIsImJlZm9yZUFsbCIsInNlcnZlck1vZHVsZSIsImNsb3NlREJGbiIsImFmdGVyQWxsIiwiZGVzY3JpYmUiLCJ2YWxpZFVzZXIiLCJhY2Nlc3NUb2tlbiIsInJlZ1Jlc3BvbnNlIiwicG9zdCIsInNlbmQiLCJuaWNrbmFtZSIsImVtYWlsIiwicGFzc3dvcmQiLCJib2R5IiwidXNlciIsInRva2VuIiwiaXQiLCJvcmlnaW5hbENvbm5lY3Rpb24iLCJjb25uZWN0aW9uIiwicmVhZHlTdGF0ZSIsImRpc2Nvbm5lY3QiLCJyZXNwb25zZSIsImdldCIsInNldCIsInRpbWVvdXQiLCJleHBlY3QiLCJ0b0NvbnRhaW4iLCJzdGF0dXMiLCJ0b0hhdmVQcm9wZXJ0eSIsImNvbm5lY3QiLCJwcm9jZXNzIiwiZW52IiwiTU9OR09EQl9VUkkiLCJBcnJheSIsImlzQXJyYXkiLCJ0b0JlIiwic3RhcnRUaW1lIiwiRGF0ZSIsIm5vdyIsImR1cmF0aW9uIiwidG9CZUxlc3NUaGFuIiwidGltZWRPdXQiLCJlcnJvciIsImNvZGUiLCJjb25jdXJyZW50UmVxdWVzdHMiLCJmaWxsIiwibWFwIiwicmVzcG9uc2VzIiwiUHJvbWlzZSIsImFsbCIsImZvckVhY2giLCJyZXF1ZXN0cyIsImlkZW50aWZpZXIiLCJhbGxTZXR0bGVkIiwiZnVsZmlsbGVkIiwiZmlsdGVyIiwiciIsImxlbmd0aCIsInRvQmVHcmVhdGVyVGhhbiIsInJlc3VsdCIsImluZGV4IiwidmFsdWUiLCJyYXBpZFJlcXVlc3RzIiwibGltaXRlZFJlcXVlc3QiLCJpbml0aWFsTWVtb3J5IiwibWVtb3J5VXNhZ2UiLCJoZWFwVXNlZCIsImxhcmdlUmVxdWVzdHMiLCJfIiwiaSIsInJlcGVhdCIsImZpbmFsTWVtb3J5IiwibWVtb3J5SW5jcmVhc2UiLCJjcHVJbnRlbnNpdmVUYXNrIiwic3RhcnQiLCJNYXRoIiwicmFuZG9tIiwiY3B1UHJvbWlzZXMiLCJyZXNvbHZlIiwic2V0SW1tZWRpYXRlIiwicmVxdWVzdFByb21pc2VzIiwiY3B1UmVzdWx0cyIsInJlcXVlc3RSZXN1bHRzIiwiY29uc2VjdXRpdmVFcnJvcnMiLCJtYXhFcnJvcnMiLCJsb25nUmVxdWVzdCIsImVtaXQiXSwic291cmNlcyI6WyJuZXR3b3JrLWVycm9yLnRlc3QuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgcmVxdWVzdCA9IHJlcXVpcmUoJ3N1cGVydGVzdCcpO1xuY29uc3QgbW9uZ29vc2UgPSByZXF1aXJlKCdtb25nb29zZScpO1xuY29uc3QgeyBUZXN0Rml4dHVyZXMgfSA9IHJlcXVpcmUoJy4uL3NoYXJlZC90ZXN0Rml4dHVyZXMnKTtcblxubGV0IGFwcCwgY2xvc2VEQjtcblxuYmVmb3JlQWxsKGFzeW5jICgpID0+IHtcbiAgY29uc3Qgc2VydmVyTW9kdWxlID0gcmVxdWlyZSgnLi4vLi4vc2VydmVyJyk7XG4gIGFwcCA9IHJlcXVpcmUoJy4uLy4uL3NlcnZlci5qcycpO1xuXG4gIGNvbnN0IHsgY2xvc2VEQjogY2xvc2VEQkZuIH0gPSByZXF1aXJlKCcuLi8uLi9kYi9jb25uZWN0aW9uJyk7XG4gIGNsb3NlREIgPSBjbG9zZURCRm47XG59KTtcblxuYWZ0ZXJBbGwoYXN5bmMgKCkgPT4ge1xuICBpZiAoY2xvc2VEQikge1xuICAgIGF3YWl0IGNsb3NlREIoKTtcbiAgfVxufSk7XG5cbmRlc2NyaWJlKCdFcnJvciBSZWNvdmVyeSBhbmQgTmV0d29yayBJbnRlcnJ1cHRpb24gVGVzdHMnLCAoKSA9PiB7XG4gIGxldCB2YWxpZFVzZXIsIGFjY2Vzc1Rva2VuO1xuXG4gIGJlZm9yZUFsbChhc3luYyAoKSA9PiB7XG4gICAgLy8gQ3JlYXRlIHRlc3QgdXNlclxuICAgIGNvbnN0IHJlZ1Jlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAucG9zdCgnL2FwaS9yZWdpc3RlcicpXG4gICAgICAuc2VuZCh7XG4gICAgICAgIG5pY2tuYW1lOiAnZXJyb3JfcmVjb3ZlcnlfdGVzdCcsXG4gICAgICAgIGVtYWlsOiAnZXJyb3JfcmVjb3ZlcnlAZXhhbXBsZS5jb20nLFxuICAgICAgICBwYXNzd29yZDogJ3Rlc3RwYXNzMTIzJ1xuICAgICAgfSk7XG5cbiAgICB2YWxpZFVzZXIgPSByZWdSZXNwb25zZS5ib2R5LnVzZXI7XG4gICAgYWNjZXNzVG9rZW4gPSByZWdSZXNwb25zZS5ib2R5LnRva2VuO1xuICB9KTtcblxuICBkZXNjcmliZSgnRGF0YWJhc2UgQ29ubmVjdGlvbiBEaXNydXB0aW9uJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgaGFuZGxlIGRhdGFiYXNlIGRpc2Nvbm5lY3Rpb24gZ3JhY2VmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIFNpbXVsYXRlIGRhdGFiYXNlIGRpc2Nvbm5lY3Rpb24gYnkgY2xvc2luZyBNb25nb0RCIGNvbm5lY3Rpb25cbiAgICAgIGNvbnN0IG9yaWdpbmFsQ29ubmVjdGlvbiA9IG1vbmdvb3NlLmNvbm5lY3Rpb24ucmVhZHlTdGF0ZTtcblxuICAgICAgdHJ5IHtcbiAgICAgICAgLy8gRm9yY2UgZGF0YWJhc2UgZGlzY29ubmVjdFxuICAgICAgICBhd2FpdCBtb25nb29zZS5kaXNjb25uZWN0KCk7XG5cbiAgICAgICAgLy8gQXR0ZW1wdCBBUEkgcmVxdWVzdCBkdXJpbmcgZGlzY29ubmVjdGlvblxuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAgIC5nZXQoJy9hcGkvY2hhbm5lbHMnKVxuICAgICAgICAgIC5zZXQoJ0F1dGhvcml6YXRpb24nLCBgQmVhcmVyICR7YWNjZXNzVG9rZW59YClcbiAgICAgICAgICAudGltZW91dCg1MDAwKTtcblxuICAgICAgICAvLyBTaG91bGQgcmV0dXJuIGRhdGFiYXNlIGVycm9yXG4gICAgICAgIGV4cGVjdChbNTAwLCA1MDNdKS50b0NvbnRhaW4ocmVzcG9uc2Uuc3RhdHVzKTtcbiAgICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkpLnRvSGF2ZVByb3BlcnR5KCdjb2RlJywgJ0RBVEFCQVNFX0VSUk9SJyk7XG5cbiAgICAgIH0gZmluYWxseSB7XG4gICAgICAgIC8vIFJlY29ubmVjdCBkYXRhYmFzZSBmb3Igb3RoZXIgdGVzdHNcbiAgICAgICAgYXdhaXQgbW9uZ29vc2UuY29ubmVjdChwcm9jZXNzLmVudi5NT05HT0RCX1VSSSB8fCAnbW9uZ29kYjovL2xvY2FsaG9zdDoyNzAxNy9jaGF0X2pzX3Rlc3QnKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmVjb3ZlciBhZnRlciBkYXRhYmFzZSByZWNvbm5lY3Rpb24nLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBFbnN1cmUgZGF0YWJhc2UgaXMgY29ubmVjdGVkXG4gICAgICBhd2FpdCBtb25nb29zZS5jb25uZWN0KHByb2Nlc3MuZW52Lk1PTkdPREJfVVJJIHx8ICdtb25nb2RiOi8vbG9jYWxob3N0OjI3MDE3L2NoYXRfanNfdGVzdCcpO1xuXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAuZ2V0KCcvYXBpL2NoYW5uZWxzJylcbiAgICAgICAgLnNldCgnQXV0aG9yaXphdGlvbicsIGBCZWFyZXIgJHthY2Nlc3NUb2tlbn1gKVxuICAgICAgICAuZXhwZWN0KDIwMCk7XG5cbiAgICAgIGV4cGVjdChBcnJheS5pc0FycmF5KHJlc3BvbnNlLmJvZHkpKS50b0JlKHRydWUpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnTmV0d29yayBUaW1lb3V0IEhhbmRsaW5nJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgaGFuZGxlIHNsb3cgZGF0YWJhc2UgcXVlcmllcyB3aXRoIHRpbWVvdXQnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBUaGlzIHRlc3Qgd291bGQgcmVxdWlyZSBhcnRpZmljaWFsbHkgc2xvdyBkYXRhYmFzZSBvcGVyYXRpb25zXG4gICAgICAvLyBGb3Igbm93LCB0ZXN0IHRoZSB0aW1lb3V0IGNvbmZpZ3VyYXRpb25cblxuICAgICAgY29uc3Qgc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcClcbiAgICAgICAgLmdldCgnL2FwaS9jaGFubmVscycpXG4gICAgICAgIC5zZXQoJ0F1dGhvcml6YXRpb24nLCBgQmVhcmVyICR7YWNjZXNzVG9rZW59YClcbiAgICAgICAgLnRpbWVvdXQoMzAwMDApOyAvLyBTZXQgZXhwbGljaXQgdGltZW91dFxuXG4gICAgICBjb25zdCBkdXJhdGlvbiA9IERhdGUubm93KCkgLSBzdGFydFRpbWU7XG5cbiAgICAgIC8vIFJlc3BvbnNlIHNob3VsZCBjb21wbGV0ZSB3aXRoaW4gcmVhc29uYWJsZSB0aW1lXG4gICAgICBleHBlY3QoZHVyYXRpb24pLnRvQmVMZXNzVGhhbigzMDAwMCk7XG4gICAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKS50b0JlKDIwMCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBjbGllbnQtc2lkZSB0aW1lb3V0JywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gVGVzdCBjbGllbnQgdGltZW91dCBiZWhhdmlvclxuICAgICAgbGV0IHRpbWVkT3V0ID0gZmFsc2U7XG5cbiAgICAgIHRyeSB7XG4gICAgICAgIGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAgIC5nZXQoJy9hcGkvY2hhbm5lbHMnKVxuICAgICAgICAgIC5zZXQoJ0F1dGhvcml6YXRpb24nLCBgQmVhcmVyICR7YWNjZXNzVG9rZW59YClcbiAgICAgICAgICAudGltZW91dCgxKTsgLy8gVmVyeSBzaG9ydCB0aW1lb3V0XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICB0aW1lZE91dCA9IHRydWU7XG4gICAgICAgIGV4cGVjdChlcnJvci5jb2RlKS50b0JlKCdFQ09OTkFCT1JURUQnKTtcbiAgICAgIH1cblxuICAgICAgZXhwZWN0KHRpbWVkT3V0KS50b0JlKHRydWUpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnQ29uY3VycmVudCBSZXF1ZXN0IEhhbmRsaW5nJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgaGFuZGxlIG11bHRpcGxlIGNvbmN1cnJlbnQgcmVxdWVzdHMgd2l0aG91dCBlcnJvcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBjb25jdXJyZW50UmVxdWVzdHMgPSBBcnJheSgxMCkuZmlsbCgpLm1hcCgoKSA9PlxuICAgICAgICByZXF1ZXN0KGFwcClcbiAgICAgICAgICAuZ2V0KCcvYXBpL2NoYW5uZWxzJylcbiAgICAgICAgICAuc2V0KCdBdXRob3JpemF0aW9uJywgYEJlYXJlciAke2FjY2Vzc1Rva2VufWApXG4gICAgICApO1xuXG4gICAgICBjb25zdCByZXNwb25zZXMgPSBhd2FpdCBQcm9taXNlLmFsbChjb25jdXJyZW50UmVxdWVzdHMpO1xuXG4gICAgICByZXNwb25zZXMuZm9yRWFjaChyZXNwb25zZSA9PiB7XG4gICAgICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMpLnRvQmUoMjAwKTtcbiAgICAgICAgZXhwZWN0KEFycmF5LmlzQXJyYXkocmVzcG9uc2UuYm9keSkpLnRvQmUodHJ1ZSk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIG1peGVkIHJlcXVlc3QgdHlwZXMgY29uY3VycmVudGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcmVxdWVzdHMgPSBbXG4gICAgICAgIC8vIEF1dGhlbnRpY2F0aW9uIHJlcXVlc3RcbiAgICAgICAgcmVxdWVzdChhcHApLnBvc3QoJy9hcGkvbG9naW4nKS5zZW5kKHtcbiAgICAgICAgICBpZGVudGlmaWVyOiAnZXJyb3JfcmVjb3ZlcnlfdGVzdCcsXG4gICAgICAgICAgcGFzc3dvcmQ6ICd0ZXN0cGFzczEyMydcbiAgICAgICAgfSksXG4gICAgICAgIC8vIENoYW5uZWwgbGlzdCByZXF1ZXN0XG4gICAgICAgIHJlcXVlc3QoYXBwKVxuICAgICAgICAgIC5nZXQoJy9hcGkvY2hhbm5lbHMnKVxuICAgICAgICAgIC5zZXQoJ0F1dGhvcml6YXRpb24nLCBgQmVhcmVyICR7YWNjZXNzVG9rZW59YCksXG4gICAgICAgIC8vIEhlYWx0aCBjaGVja1xuICAgICAgICByZXF1ZXN0KGFwcCkuZ2V0KCcvaGVhbHRoJyksXG4gICAgICAgIC8vIEludmFsaWQgZW5kcG9pbnRcbiAgICAgICAgcmVxdWVzdChhcHApLmdldCgnL2FwaS9ub25leGlzdGVudCcpXG4gICAgICBdO1xuXG4gICAgICBjb25zdCByZXNwb25zZXMgPSBhd2FpdCBQcm9taXNlLmFsbFNldHRsZWQocmVxdWVzdHMpO1xuXG4gICAgICBjb25zdCBmdWxmaWxsZWQgPSByZXNwb25zZXMuZmlsdGVyKHIgPT4gci5zdGF0dXMgPT09ICdmdWxmaWxsZWQnKTtcbiAgICAgIGV4cGVjdChmdWxmaWxsZWQubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMCk7XG5cbiAgICAgIGZ1bGZpbGxlZC5mb3JFYWNoKChyZXN1bHQsIGluZGV4KSA9PiB7XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gcmVzdWx0LnZhbHVlO1xuICAgICAgICBzd2l0Y2ggKGluZGV4KSB7XG4gICAgICAgICAgY2FzZSAwOiAvLyBMb2dpblxuICAgICAgICAgICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cykudG9CZSgyMDApO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgY2FzZSAxOiAvLyBDaGFubmVsc1xuICAgICAgICAgICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cykudG9CZSgyMDApO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgY2FzZSAyOiAvLyBIZWFsdGhcbiAgICAgICAgICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMpLnRvQmUoMjAwKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgMzogLy8gSW52YWxpZCBlbmRwb2ludFxuICAgICAgICAgICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cykudG9CZSg0MDQpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnUmF0ZSBMaW1pdCBSZWNvdmVyeScsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHJlY292ZXIgZnJvbSByYXRlIGxpbWl0aW5nIGFmdGVyIHRpbWVvdXQgcGVyaW9kJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gR2V0IGN1cnJlbnQgdGltZXN0YW1wIGZvciByYXRlIGxpbWl0IHdpbmRvd1xuICAgICAgY29uc3Qgc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcblxuICAgICAgLy8gU2VuZCBtdWx0aXBsZSByZXF1ZXN0cyB0byB0cmlnZ2VyIHJhdGUgbGltaXRpbmdcbiAgICAgIGNvbnN0IHJhcGlkUmVxdWVzdHMgPSBBcnJheSgxNSkuZmlsbCgpLm1hcCgoKSA9PlxuICAgICAgICByZXF1ZXN0KGFwcClcbiAgICAgICAgICAucG9zdCgnL2FwaS9sb2dpbicpXG4gICAgICAgICAgLnNlbmQoe1xuICAgICAgICAgICAgaWRlbnRpZmllcjogJ3Rlc3QnLFxuICAgICAgICAgICAgcGFzc3dvcmQ6ICd0ZXN0J1xuICAgICAgICAgIH0pXG4gICAgICApO1xuXG4gICAgICAvLyBFeGVjdXRlIGFsbCByZXF1ZXN0cyAoc29tZSB3aWxsIGJlIHJhdGUgbGltaXRlZClcbiAgICAgIGF3YWl0IFByb21pc2UuYWxsU2V0dGxlZChyYXBpZFJlcXVlc3RzKTtcblxuICAgICAgLy8gV2FpdCBmb3IgcmF0ZSBsaW1pdCB0byBleHBpcmUgKDE1KyBtaW51dGVzIHdvdWxkIGJlIG5lZWRlZCBmb3IgZnVsbCByZWNvdmVyeSlcbiAgICAgIC8vIEZvciB0ZXN0aW5nLCBqdXN0IHZlcmlmeSByYXRlIGxpbWl0aW5nIGlzIHdvcmtpbmdcbiAgICAgIGNvbnN0IGxpbWl0ZWRSZXF1ZXN0ID0gYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5wb3N0KCcvYXBpL2xvZ2luJylcbiAgICAgICAgLnNlbmQoe1xuICAgICAgICAgIGlkZW50aWZpZXI6ICd0ZXN0JyxcbiAgICAgICAgICBwYXNzd29yZDogJ3Rlc3QnXG4gICAgICAgIH0pO1xuXG4gICAgICAvLyBTaG91bGQgYmUgcmF0ZSBsaW1pdGVkXG4gICAgICBleHBlY3QoWzQwMCwgNDI5XSkudG9Db250YWluKGxpbWl0ZWRSZXF1ZXN0LnN0YXR1cyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdNZW1vcnkgTGVhayBQcmV2ZW50aW9uJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgaGFuZGxlIG1lbW9yeS1pbnRlbnNpdmUgb3BlcmF0aW9ucyB3aXRob3V0IGxlYWtzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgaW5pdGlhbE1lbW9yeSA9IHByb2Nlc3MubWVtb3J5VXNhZ2UoKS5oZWFwVXNlZDtcblxuICAgICAgLy8gU2ltdWxhdGUgbXVsdGlwbGUgbGFyZ2UgcmVxdWVzdHNcbiAgICAgIGNvbnN0IGxhcmdlUmVxdWVzdHMgPSBBcnJheSg1MCkuZmlsbCgpLm1hcCgoXywgaSkgPT5cbiAgICAgICAgcmVxdWVzdChhcHApXG4gICAgICAgICAgLmdldCgnL2FwaS9jaGFubmVscycpXG4gICAgICAgICAgLnNldCgnQXV0aG9yaXphdGlvbicsIGBCZWFyZXIgJHthY2Nlc3NUb2tlbn1gKVxuICAgICAgICAgIC8vIEFkZCBsYXJnZSBwYXlsb2FkIHRvIHNpbXVsYXRlIG1lbW9yeSB1c2FnZVxuICAgICAgICAgIC5zZXQoJ1VzZXItQWdlbnQnLCAnYScucmVwZWF0KDEwMDApKVxuICAgICAgKTtcblxuICAgICAgYXdhaXQgUHJvbWlzZS5hbGwobGFyZ2VSZXF1ZXN0cyk7XG5cbiAgICAgIGNvbnN0IGZpbmFsTWVtb3J5ID0gcHJvY2Vzcy5tZW1vcnlVc2FnZSgpLmhlYXBVc2VkO1xuXG4gICAgICAvLyBNZW1vcnkgdXNhZ2Ugc2hvdWxkIG5vdCBpbmNyZWFzZSBkcmFtYXRpY2FsbHlcbiAgICAgIGNvbnN0IG1lbW9yeUluY3JlYXNlID0gZmluYWxNZW1vcnkgLSBpbml0aWFsTWVtb3J5O1xuICAgICAgZXhwZWN0KG1lbW9yeUluY3JlYXNlKS50b0JlTGVzc1RoYW4oNTAgKiAxMDI0ICogMTAyNCk7IC8vIExlc3MgdGhhbiA1ME1CIGluY3JlYXNlXG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdTZXJ2aWNlIERlZ3JhZGF0aW9uJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgaGFuZGxlIHJlcXVlc3RzIGR1cmluZyBoaWdoIENQVSB1c2FnZSBzaW11bGF0aW9uJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gU2ltdWxhdGUgQ1BVIGludGVuc2l2ZSBvcGVyYXRpb25cbiAgICAgIGNvbnN0IGNwdUludGVuc2l2ZVRhc2sgPSAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHN0YXJ0ID0gRGF0ZS5ub3coKTtcbiAgICAgICAgd2hpbGUgKERhdGUubm93KCkgLSBzdGFydCA8IDEwMDApIHtcbiAgICAgICAgICBNYXRoLnJhbmRvbSgpICogTWF0aC5yYW5kb20oKTtcbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgLy8gU3RhcnQgQ1BVIGludGVuc2l2ZSBvcGVyYXRpb25zXG4gICAgICBjb25zdCBjcHVQcm9taXNlcyA9IEFycmF5KDQpLmZpbGwoKS5tYXAoKCkgPT4gbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7XG4gICAgICAgIHNldEltbWVkaWF0ZSgoKSA9PiB7XG4gICAgICAgICAgY3B1SW50ZW5zaXZlVGFzaygpO1xuICAgICAgICAgIHJlc29sdmUoKTtcbiAgICAgICAgfSk7XG4gICAgICB9KSk7XG5cbiAgICAgIC8vIFNlbmQgcmVxdWVzdCBkdXJpbmcgQ1BVIGxvYWRcbiAgICAgIGNvbnN0IHJlcXVlc3RQcm9taXNlcyA9IEFycmF5KDUpLmZpbGwoKS5tYXAoKCkgPT5cbiAgICAgICAgcmVxdWVzdChhcHApXG4gICAgICAgICAgLmdldCgnL2hlYWx0aCcpXG4gICAgICAgICAgLnRpbWVvdXQoMTAwMDApXG4gICAgICApO1xuXG4gICAgICBjb25zdCBbY3B1UmVzdWx0cywgcmVxdWVzdFJlc3VsdHNdID0gYXdhaXQgUHJvbWlzZS5hbGwoW1xuICAgICAgICBQcm9taXNlLmFsbChjcHVQcm9taXNlcyksXG4gICAgICAgIFByb21pc2UuYWxsKHJlcXVlc3RQcm9taXNlcylcbiAgICAgIF0pO1xuXG4gICAgICAvLyBBbGwgcmVxdWVzdHMgc2hvdWxkIGNvbXBsZXRlIHN1Y2Nlc3NmdWxseVxuICAgICAgcmVxdWVzdFJlc3VsdHMuZm9yRWFjaChyZXNwb25zZSA9PiB7XG4gICAgICAgIGV4cGVjdChbMjAwLCA1MDNdKS50b0NvbnRhaW4ocmVzcG9uc2Uuc3RhdHVzKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnQ2lyY3VpdCBCcmVha2VyIFBhdHRlcm4nLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBpbXBsZW1lbnQgYmFzaWMgY2lyY3VpdCBicmVha2VyIGZvciBkYXRhYmFzZSBmYWlsdXJlcycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIFRoaXMgd291bGQgcmVxdWlyZSBjdXN0b20gY2lyY3VpdCBicmVha2VyIGltcGxlbWVudGF0aW9uXG4gICAgICAvLyBGb3Igbm93LCB0ZXN0IGRhdGFiYXNlIGVycm9yIGhhbmRsaW5nXG5cbiAgICAgIC8vIEZvcmNlIGRhdGFiYXNlIGVycm9yIGJ5IGRyb3BwaW5nIGNvbm5lY3Rpb25cbiAgICAgIGNvbnN0IG9yaWdpbmFsQ29ubmVjdGlvbiA9IG1vbmdvb3NlLmNvbm5lY3Rpb247XG4gICAgICBhd2FpdCBtb25nb29zZS5kaXNjb25uZWN0KCk7XG5cbiAgICAgIGxldCBjb25zZWN1dGl2ZUVycm9ycyA9IDA7XG4gICAgICBjb25zdCBtYXhFcnJvcnMgPSA1O1xuXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG1heEVycm9ycyArIDE7IGkrKykge1xuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAgIC5nZXQoJy9hcGkvY2hhbm5lbHMnKVxuICAgICAgICAgIC5zZXQoJ0F1dGhvcml6YXRpb24nLCBgQmVhcmVyICR7YWNjZXNzVG9rZW59YClcbiAgICAgICAgICAudGltZW91dCg1MDAwKTtcblxuICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSA1MDAgfHwgcmVzcG9uc2Uuc3RhdHVzID09PSA1MDMpIHtcbiAgICAgICAgICBjb25zZWN1dGl2ZUVycm9ycysrO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIFNob3VsZCBoYXZlIGNvbnNlY3V0aXZlIGRhdGFiYXNlIGVycm9yc1xuICAgICAgZXhwZWN0KGNvbnNlY3V0aXZlRXJyb3JzKS50b0JlR3JlYXRlclRoYW4oMCk7XG5cbiAgICAgIC8vIFJlY29ubmVjdCBmb3Igb3RoZXIgdGVzdHNcbiAgICAgIGF3YWl0IG1vbmdvb3NlLmNvbm5lY3QocHJvY2Vzcy5lbnYuTU9OR09EQl9VUkkgfHwgJ21vbmdvZGI6Ly9sb2NhbGhvc3Q6MjcwMTcvY2hhdF9qc190ZXN0Jyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdHcmFjZWZ1bCBTaHV0ZG93biBTY2VuYXJpb3MnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgcmVxdWVzdHMgZHVyaW5nIGFwcGxpY2F0aW9uIHNodXRkb3duJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gU3RhcnQgYSBsb25nLXJ1bm5pbmcgcmVxdWVzdFxuICAgICAgY29uc3QgbG9uZ1JlcXVlc3QgPSByZXF1ZXN0KGFwcClcbiAgICAgICAgLmdldCgnL2FwaS9jaGFubmVscycpXG4gICAgICAgIC5zZXQoJ0F1dGhvcml6YXRpb24nLCBgQmVhcmVyICR7YWNjZXNzVG9rZW59YClcbiAgICAgICAgLnRpbWVvdXQoNjAwMDApOyAvLyBMb25nIHRpbWVvdXQgZm9yIGdyYWNlZnVsIHNodXRkb3duIHRlc3RcblxuICAgICAgLy8gU2ltdWxhdGUgc2h1dGRvd24gc2lnbmFsXG4gICAgICAvLyBJbiByZWFsIHNjZW5hcmlvLCB0aGlzIHdvdWxkIHRyaWdnZXIgZ3JhY2VmdWwgc2h1dGRvd25cbiAgICAgIHByb2Nlc3MuZW1pdCgnU0lHVEVSTScpO1xuXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGxvbmdSZXF1ZXN0O1xuXG4gICAgICAvLyBSZXF1ZXN0IHNob3VsZCBlaXRoZXIgY29tcGxldGUgb3IgYmUgcmVqZWN0ZWQgZ3JhY2VmdWxseVxuICAgICAgZXhwZWN0KFsyMDAsIDUwMywgJ0VDT05OQUJPUlRFRCddKS50b0NvbnRhaW4ocmVzcG9uc2Uuc3RhdHVzIHx8IHJlc3BvbnNlLmNvZGUpO1xuICAgIH0pO1xuICB9KTtcbn0pOyJdLCJtYXBwaW5ncyI6IkFBQUEsTUFBTUEsT0FBTyxHQUFHQyxPQUFPLENBQUMsV0FBVyxDQUFDO0FBQ3BDLE1BQU1DLFFBQVEsR0FBR0QsT0FBTyxDQUFDLFVBQVUsQ0FBQztBQUNwQyxNQUFNO0VBQUVFO0FBQWEsQ0FBQyxHQUFHRixPQUFPLENBQUMsd0JBQXdCLENBQUM7QUFFMUQsSUFBSUcsR0FBRyxFQUFFQyxPQUFPO0FBRWhCQyxTQUFTLENBQUMsWUFBWTtFQUNwQixNQUFNQyxZQUFZLEdBQUdOLE9BQU8sQ0FBQyxjQUFjLENBQUM7RUFDNUNHLEdBQUcsR0FBR0gsT0FBTyxDQUFDLGlCQUFpQixDQUFDO0VBRWhDLE1BQU07SUFBRUksT0FBTyxFQUFFRztFQUFVLENBQUMsR0FBR1AsT0FBTyxDQUFDLHFCQUFxQixDQUFDO0VBQzdESSxPQUFPLEdBQUdHLFNBQVM7QUFDckIsQ0FBQyxDQUFDO0FBRUZDLFFBQVEsQ0FBQyxZQUFZO0VBQ25CLElBQUlKLE9BQU8sRUFBRTtJQUNYLE1BQU1BLE9BQU8sQ0FBQyxDQUFDO0VBQ2pCO0FBQ0YsQ0FBQyxDQUFDO0FBRUZLLFFBQVEsQ0FBQywrQ0FBK0MsRUFBRSxNQUFNO0VBQzlELElBQUlDLFNBQVMsRUFBRUMsV0FBVztFQUUxQk4sU0FBUyxD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