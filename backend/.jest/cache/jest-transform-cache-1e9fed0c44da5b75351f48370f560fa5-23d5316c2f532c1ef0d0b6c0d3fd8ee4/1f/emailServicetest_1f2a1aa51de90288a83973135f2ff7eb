5d12d5c9c123157c12c660e05e38b7b8
// Mock nodemailer
_getJestObj().mock('nodemailer', () => ({
  createTransporter: jest.fn(() => ({
    sendMail: jest.fn()
  }))
}));

// Mock console methods to avoid noise
function _getJestObj() {
  const {
    jest
  } = require("@jest/globals");
  _getJestObj = () => jest;
  return jest;
}
const emailService = require('../../services/emailService');
global.console.log = jest.fn();
global.console.error = jest.fn();
describe('EmailService', () => {
  let mockTransporter;
  beforeEach(() => {
    // Reset all mocks
    jest.clearAllMocks();

    // Mock process.env values
    process.env.SMTP_HOST = 'smtp.test.com';
    process.env.SMTP_PORT = '587';
    process.env.SMTP_USER = 'test@example.com';
    process.env.SMTP_PASS = 'test-password';
    process.env.FRONTEND_URL = 'http://localhost:3000';

    // Re-import to trigger constructor with mocked values
    delete require.cache[require.resolve('../../services/emailService')];
    const freshEmailService = require('../../services/emailService');

    // Get the mock transporter from the fresh instance
    mockTransporter = freshEmailService.transporter;
  });
  describe('sendPasswordResetEmail', () => {
    it('should send password reset email successfully', async () => {
      const email = 'user@example.com';
      const resetToken = 'test-reset-token-123';
      const expectedMessageId = 'test-message-id-123';
      mockTransporter.sendMail.mockResolvedValue({
        messageId: expectedMessageId
      });
      const result = await emailService.sendPasswordResetEmail(email, resetToken);
      expect(result).toEqual({
        success: true,
        messageId: expectedMessageId
      });
      expect(mockTransporter.sendMail).toHaveBeenCalledTimes(1);
      const mailOptions = mockTransporter.sendMail.mock.calls[0][0];
      expect(mailOptions.to).toBe(email);
      expect(mailOptions.subject).toContain('Password Reset');
      expect(mailOptions.html).toContain(resetToken);
      expect(mailOptions.text).toContain(resetToken);
    });
    it('should include correct reset URL in email', async () => {
      const email = 'user@example.com';
      const resetToken = 'reset-token-456';
      const expectedUrl = `http://localhost:3000/reset-password/${resetToken}`;
      mockTransporter.sendMail.mockResolvedValue({
        messageId: 'test-id'
      });
      await emailService.sendPasswordResetEmail(email, resetToken);
      const mailOptions = mockTransporter.sendMail.mock.calls[0][0];
      expect(mailOptions.html).toContain(expectedUrl);
      expect(mailOptions.text).toContain(expectedUrl);
    });
    it('should handle missing FRONTEND_URL environment variable', async () => {
      delete process.env.FRONTEND_URL;

      // Re-import with new environment
      delete require.cache[require.resolve('../../services/emailService')];
      const freshService = require('../../services/emailService');
      mockTransporter.sendMail.mockResolvedValue({
        messageId: 'test-id'
      });
      await freshService.sendPasswordResetEmail('user@example.com', 'token');
      const mailOptions = mockTransporter.sendMail.mock.calls[0][0];
      expect(mailOptions.html).toContain('http://localhost:3000/reset-password/token');
    });
    it('should throw error when email sending fails', async () => {
      const error = new Error('SMTP connection failed');
      mockTransporter.sendMail.mockRejectedValue(error);
      await expect(emailService.sendPasswordResetEmail('user@example.com', 'token')).rejects.toThrow('SMTP connection failed');
    });
  });
  describe('sendPasswordResetSuccessEmail', () => {
    it('should send password reset success email successfully', async () => {
      const email = 'user@example.com';
      const expectedMessageId = 'success-message-id-123';
      mockTransporter.sendMail.mockResolvedValue({
        messageId: expectedMessageId
      });
      const result = await emailService.sendPasswordResetSuccessEmail(email);
      expect(result).toEqual({
        success: true,
        messageId: expectedMessageId
      });
      expect(mockTransporter.sendMail).toHaveBeenCalledTimes(1);
      const mailOptions = mockTransporter.sendMail.mock.calls[0][0];
      expect(mailOptions.to).toBe(email);
      expect(mailOptions.subject).toContain('Password Reset Successful');
      expect(mailOptions.html).toContain('Your password has been successfully reset');
      expect(mailOptions.text).toContain('Your password has been successfully reset');
    });
    it('should throw error when success email sending fails', async () => {
      const error = new Error('SMTP timeout');
      mockTransporter.sendMail.mockRejectedValue(error);
      await expect(emailService.sendPasswordResetSuccessEmail('user@example.com')).rejects.toThrow('SMTP timeout');
    });
  });
  describe('Email Service Configuration', () => {
    it('should use environment variables for SMTP configuration', () => {
      const nodemailer = require('nodemailer');
      const createTransporter = nodemailer.createTransporter;
      delete require.cache[require.resolve('../../services/emailService')];
      require('../../services/emailService');
      expect(createTransporter).toHaveBeenCalledWith({
        host: 'smtp.test.com',
        port: '587',
        secure: false,
        auth: {
          user: 'test@example.com',
          pass: 'test-password'
        }
      });
    });
    it('should use defaults when environment variables are missing', () => {
      delete process.env.SMTP_HOST;
      delete process.env.SMTP_PORT;
      delete process.env.SMTP_USER;
      delete process.env.SMTP_PASS;
      const nodemailer = require('nodemailer');
      const createTransporter = nodemailer.createTransporter;
      delete require.cache[require.resolve('../../services/emailService')];
      require('../../services/emailService');
      expect(createTransporter).toHaveBeenCalledWith({
        host: 'smtp.gmail.com',
        port: 587,
        secure: false,
        auth: {
          user: undefined,
          pass: undefined
        }
      });
    });
  });
  describe('Error Handling', () => {
    it('should handle network errors in SMTP connection', async () => {
      const networkError = new Error('Connection timeout');
      networkError.code = 'ENOTFOUND';
      mockTransporter.sendMail.mockRejectedValue(networkError);
      await expect(emailService.sendPasswordResetEmail('user@example.com', 'token')).rejects.toThrow('Connection timeout');
    });
    it('should handle authentication errors', async () => {
      const authError = new Error('Authentication failed');
      authError.responseCode = 535;
      mockTransporter.sendMail.mockRejectedValue(authError);
      await expect(emailService.sendPasswordResetEmail('user@example.com', 'token')).rejects.toThrow('Authentication failed');
    });
  });
  describe('Email Content Validation', () => {
    it('should include proper email headers', async () => {
      const email = 'test@example.com';
      const token = 'reset-token-xyz';
      mockTransporter.sendMail.mockResolvedValue({
        messageId: 'header-test-id'
      });
      await emailService.sendPasswordResetEmail(email, token);
      const mailOptions = mockTransporter.sendMail.mock.calls[0][0];
      expect(mailOptions.from).toEqual({
        name: 'Chat-JS Support',
        address: process.env.SMTP_USER
      });
      expect(mailOptions.to).toBe(email);
      expect(mailOptions.subject).toContain('Password Reset');
    });
    it('should include HTML and text versions', async () => {
      mockTransporter.sendMail.mockResolvedValue({
        messageId: 'content-test-id'
      });
      await emailService.sendPasswordResetEmail('test@example.com', 'token-abc');
      const mailOptions = mockTransporter.sendMail.mock.calls[0][0];
      expect(mailOptions.html).toBeDefined();
      expect(mailOptions.html).toContain('<html');
      expect(mailOptions.html).toContain('Reset Password');
      expect(mailOptions.text).toBeDefined();
      expect(mailOptions.text).toContain('Password Reset Request');
      expect(mailOptions.text).toContain('token-abc');
    });
    it('should properly escape HTML content', async () => {
      const maliciousEmail = '<script>alert("xss")</script>@example.com';
      mockTransporter.sendMail.mockResolvedValue({
        messageId: 'escape-test-id'
      });

      // Should not throw or cause issues with HTML content
      await expect(emailService.sendPasswordResetEmail(maliciousEmail, 'token')).resolves.toBeDefined();
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfZ2V0SmVzdE9iaiIsIm1vY2siLCJjcmVhdGVUcmFuc3BvcnRlciIsImplc3QiLCJmbiIsInNlbmRNYWlsIiwicmVxdWlyZSIsImVtYWlsU2VydmljZSIsImdsb2JhbCIsImNvbnNvbGUiLCJsb2ciLCJlcnJvciIsImRlc2NyaWJlIiwibW9ja1RyYW5zcG9ydGVyIiwiYmVmb3JlRWFjaCIsImNsZWFyQWxsTW9ja3MiLCJwcm9jZXNzIiwiZW52IiwiU01UUF9IT1NUIiwiU01UUF9QT1JUIiwiU01UUF9VU0VSIiwiU01UUF9QQVNTIiwiRlJPTlRFTkRfVVJMIiwiY2FjaGUiLCJyZXNvbHZlIiwiZnJlc2hFbWFpbFNlcnZpY2UiLCJ0cmFuc3BvcnRlciIsIml0IiwiZW1haWwiLCJyZXNldFRva2VuIiwiZXhwZWN0ZWRNZXNzYWdlSWQiLCJtb2NrUmVzb2x2ZWRWYWx1ZSIsIm1lc3NhZ2VJZCIsInJlc3VsdCIsInNlbmRQYXNzd29yZFJlc2V0RW1haWwiLCJleHBlY3QiLCJ0b0VxdWFsIiwic3VjY2VzcyIsInRvSGF2ZUJlZW5DYWxsZWRUaW1lcyIsIm1haWxPcHRpb25zIiwiY2FsbHMiLCJ0byIsInRvQmUiLCJzdWJqZWN0IiwidG9Db250YWluIiwiaHRtbCIsInRleHQiLCJleHBlY3RlZFVybCIsImZyZXNoU2VydmljZSIsIkVycm9yIiwibW9ja1JlamVjdGVkVmFsdWUiLCJyZWplY3RzIiwidG9UaHJvdyIsInNlbmRQYXNzd29yZFJlc2V0U3VjY2Vzc0VtYWlsIiwibm9kZW1haWxlciIsInRvSGF2ZUJlZW5DYWxsZWRXaXRoIiwiaG9zdCIsInBvcnQiLCJzZWN1cmUiLCJhdXRoIiwidXNlciIsInBhc3MiLCJ1bmRlZmluZWQiLCJuZXR3b3JrRXJyb3IiLCJjb2RlIiwiYXV0aEVycm9yIiwicmVzcG9uc2VDb2RlIiwidG9rZW4iLCJmcm9tIiwibmFtZSIsImFkZHJlc3MiLCJ0b0JlRGVmaW5lZCIsIm1hbGljaW91c0VtYWlsIiwicmVzb2x2ZXMiXSwic291cmNlcyI6WyJlbWFpbFNlcnZpY2UudGVzdC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBlbWFpbFNlcnZpY2UgPSByZXF1aXJlKCcuLi8uLi9zZXJ2aWNlcy9lbWFpbFNlcnZpY2UnKTtcblxuLy8gTW9jayBub2RlbWFpbGVyXG5qZXN0Lm1vY2soJ25vZGVtYWlsZXInLCAoKSA9PiAoe1xuICBjcmVhdGVUcmFuc3BvcnRlcjogamVzdC5mbigoKSA9PiAoe1xuICAgIHNlbmRNYWlsOiBqZXN0LmZuKClcbiAgfSkpXG59KSk7XG5cbi8vIE1vY2sgY29uc29sZSBtZXRob2RzIHRvIGF2b2lkIG5vaXNlXG5nbG9iYWwuY29uc29sZS5sb2cgPSBqZXN0LmZuKCk7XG5nbG9iYWwuY29uc29sZS5lcnJvciA9IGplc3QuZm4oKTtcblxuZGVzY3JpYmUoJ0VtYWlsU2VydmljZScsICgpID0+IHtcbiAgbGV0IG1vY2tUcmFuc3BvcnRlcjtcblxuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICAvLyBSZXNldCBhbGwgbW9ja3NcbiAgICBqZXN0LmNsZWFyQWxsTW9ja3MoKTtcblxuICAgIC8vIE1vY2sgcHJvY2Vzcy5lbnYgdmFsdWVzXG4gICAgcHJvY2Vzcy5lbnYuU01UUF9IT1NUID0gJ3NtdHAudGVzdC5jb20nO1xuICAgIHByb2Nlc3MuZW52LlNNVFBfUE9SVCA9ICc1ODcnO1xuICAgIHByb2Nlc3MuZW52LlNNVFBfVVNFUiA9ICd0ZXN0QGV4YW1wbGUuY29tJztcbiAgICBwcm9jZXNzLmVudi5TTVRQX1BBU1MgPSAndGVzdC1wYXNzd29yZCc7XG4gICAgcHJvY2Vzcy5lbnYuRlJPTlRFTkRfVVJMID0gJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMCc7XG5cbiAgICAvLyBSZS1pbXBvcnQgdG8gdHJpZ2dlciBjb25zdHJ1Y3RvciB3aXRoIG1vY2tlZCB2YWx1ZXNcbiAgICBkZWxldGUgcmVxdWlyZS5jYWNoZVtyZXF1aXJlLnJlc29sdmUoJy4uLy4uL3NlcnZpY2VzL2VtYWlsU2VydmljZScpXTtcbiAgICBjb25zdCBmcmVzaEVtYWlsU2VydmljZSA9IHJlcXVpcmUoJy4uLy4uL3NlcnZpY2VzL2VtYWlsU2VydmljZScpO1xuXG4gICAgLy8gR2V0IHRoZSBtb2NrIHRyYW5zcG9ydGVyIGZyb20gdGhlIGZyZXNoIGluc3RhbmNlXG4gICAgbW9ja1RyYW5zcG9ydGVyID0gZnJlc2hFbWFpbFNlcnZpY2UudHJhbnNwb3J0ZXI7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdzZW5kUGFzc3dvcmRSZXNldEVtYWlsJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgc2VuZCBwYXNzd29yZCByZXNldCBlbWFpbCBzdWNjZXNzZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBlbWFpbCA9ICd1c2VyQGV4YW1wbGUuY29tJztcbiAgICAgIGNvbnN0IHJlc2V0VG9rZW4gPSAndGVzdC1yZXNldC10b2tlbi0xMjMnO1xuICAgICAgY29uc3QgZXhwZWN0ZWRNZXNzYWdlSWQgPSAndGVzdC1tZXNzYWdlLWlkLTEyMyc7XG5cbiAgICAgIG1vY2tUcmFuc3BvcnRlci5zZW5kTWFpbC5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIG1lc3NhZ2VJZDogZXhwZWN0ZWRNZXNzYWdlSWRcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBlbWFpbFNlcnZpY2Uuc2VuZFBhc3N3b3JkUmVzZXRFbWFpbChlbWFpbCwgcmVzZXRUb2tlbik7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoe1xuICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICBtZXNzYWdlSWQ6IGV4cGVjdGVkTWVzc2FnZUlkXG4gICAgICB9KTtcblxuICAgICAgZXhwZWN0KG1vY2tUcmFuc3BvcnRlci5zZW5kTWFpbCkudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDEpO1xuXG4gICAgICBjb25zdCBtYWlsT3B0aW9ucyA9IG1vY2tUcmFuc3BvcnRlci5zZW5kTWFpbC5tb2NrLmNhbGxzWzBdWzBdO1xuICAgICAgZXhwZWN0KG1haWxPcHRpb25zLnRvKS50b0JlKGVtYWlsKTtcbiAgICAgIGV4cGVjdChtYWlsT3B0aW9ucy5zdWJqZWN0KS50b0NvbnRhaW4oJ1Bhc3N3b3JkIFJlc2V0Jyk7XG4gICAgICBleHBlY3QobWFpbE9wdGlvbnMuaHRtbCkudG9Db250YWluKHJlc2V0VG9rZW4pO1xuICAgICAgZXhwZWN0KG1haWxPcHRpb25zLnRleHQpLnRvQ29udGFpbihyZXNldFRva2VuKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaW5jbHVkZSBjb3JyZWN0IHJlc2V0IFVSTCBpbiBlbWFpbCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGVtYWlsID0gJ3VzZXJAZXhhbXBsZS5jb20nO1xuICAgICAgY29uc3QgcmVzZXRUb2tlbiA9ICdyZXNldC10b2tlbi00NTYnO1xuICAgICAgY29uc3QgZXhwZWN0ZWRVcmwgPSBgaHR0cDovL2xvY2FsaG9zdDozMDAwL3Jlc2V0LXBhc3N3b3JkLyR7cmVzZXRUb2tlbn1gO1xuXG4gICAgICBtb2NrVHJhbnNwb3J0ZXIuc2VuZE1haWwubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBtZXNzYWdlSWQ6ICd0ZXN0LWlkJ1xuICAgICAgfSk7XG5cbiAgICAgIGF3YWl0IGVtYWlsU2VydmljZS5zZW5kUGFzc3dvcmRSZXNldEVtYWlsKGVtYWlsLCByZXNldFRva2VuKTtcblxuICAgICAgY29uc3QgbWFpbE9wdGlvbnMgPSBtb2NrVHJhbnNwb3J0ZXIuc2VuZE1haWwubW9jay5jYWxsc1swXVswXTtcbiAgICAgIGV4cGVjdChtYWlsT3B0aW9ucy5odG1sKS50b0NvbnRhaW4oZXhwZWN0ZWRVcmwpO1xuICAgICAgZXhwZWN0KG1haWxPcHRpb25zLnRleHQpLnRvQ29udGFpbihleHBlY3RlZFVybCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBtaXNzaW5nIEZST05URU5EX1VSTCBlbnZpcm9ubWVudCB2YXJpYWJsZScsIGFzeW5jICgpID0+IHtcbiAgICAgIGRlbGV0ZSBwcm9jZXNzLmVudi5GUk9OVEVORF9VUkw7XG5cbiAgICAgIC8vIFJlLWltcG9ydCB3aXRoIG5ldyBlbnZpcm9ubWVudFxuICAgICAgZGVsZXRlIHJlcXVpcmUuY2FjaGVbcmVxdWlyZS5yZXNvbHZlKCcuLi8uLi9zZXJ2aWNlcy9lbWFpbFNlcnZpY2UnKV07XG4gICAgICBjb25zdCBmcmVzaFNlcnZpY2UgPSByZXF1aXJlKCcuLi8uLi9zZXJ2aWNlcy9lbWFpbFNlcnZpY2UnKTtcblxuICAgICAgbW9ja1RyYW5zcG9ydGVyLnNlbmRNYWlsLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgbWVzc2FnZUlkOiAndGVzdC1pZCdcbiAgICAgIH0pO1xuXG4gICAgICBhd2FpdCBmcmVzaFNlcnZpY2Uuc2VuZFBhc3N3b3JkUmVzZXRFbWFpbCgndXNlckBleGFtcGxlLmNvbScsICd0b2tlbicpO1xuXG4gICAgICBjb25zdCBtYWlsT3B0aW9ucyA9IG1vY2tUcmFuc3BvcnRlci5zZW5kTWFpbC5tb2NrLmNhbGxzWzBdWzBdO1xuICAgICAgZXhwZWN0KG1haWxPcHRpb25zLmh0bWwpLnRvQ29udGFpbignaHR0cDovL2xvY2FsaG9zdDozMDAwL3Jlc2V0LXBhc3N3b3JkL3Rva2VuJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHRocm93IGVycm9yIHdoZW4gZW1haWwgc2VuZGluZyBmYWlscycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKCdTTVRQIGNvbm5lY3Rpb24gZmFpbGVkJyk7XG4gICAgICBtb2NrVHJhbnNwb3J0ZXIuc2VuZE1haWwubW9ja1JlamVjdGVkVmFsdWUoZXJyb3IpO1xuXG4gICAgICBhd2FpdCBleHBlY3QoXG4gICAgICAgIGVtYWlsU2VydmljZS5zZW5kUGFzc3dvcmRSZXNldEVtYWlsKCd1c2VyQGV4YW1wbGUuY29tJywgJ3Rva2VuJylcbiAgICAgICkucmVqZWN0cy50b1Rocm93KCdTTVRQIGNvbm5lY3Rpb24gZmFpbGVkJyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdzZW5kUGFzc3dvcmRSZXNldFN1Y2Nlc3NFbWFpbCcsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHNlbmQgcGFzc3dvcmQgcmVzZXQgc3VjY2VzcyBlbWFpbCBzdWNjZXNzZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBlbWFpbCA9ICd1c2VyQGV4YW1wbGUuY29tJztcbiAgICAgIGNvbnN0IGV4cGVjdGVkTWVzc2FnZUlkID0gJ3N1Y2Nlc3MtbWVzc2FnZS1pZC0xMjMnO1xuXG4gICAgICBtb2NrVHJhbnNwb3J0ZXIuc2VuZE1haWwubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBtZXNzYWdlSWQ6IGV4cGVjdGVkTWVzc2FnZUlkXG4gICAgICB9KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZW1haWxTZXJ2aWNlLnNlbmRQYXNzd29yZFJlc2V0U3VjY2Vzc0VtYWlsKGVtYWlsKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbCh7XG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgIG1lc3NhZ2VJZDogZXhwZWN0ZWRNZXNzYWdlSWRcbiAgICAgIH0pO1xuXG4gICAgICBleHBlY3QobW9ja1RyYW5zcG9ydGVyLnNlbmRNYWlsKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMSk7XG5cbiAgICAgIGNvbnN0IG1haWxPcHRpb25zID0gbW9ja1RyYW5zcG9ydGVyLnNlbmRNYWlsLm1vY2suY2FsbHNbMF1bMF07XG4gICAgICBleHBlY3QobWFpbE9wdGlvbnMudG8pLnRvQmUoZW1haWwpO1xuICAgICAgZXhwZWN0KG1haWxPcHRpb25zLnN1YmplY3QpLnRvQ29udGFpbignUGFzc3dvcmQgUmVzZXQgU3VjY2Vzc2Z1bCcpO1xuICAgICAgZXhwZWN0KG1haWxPcHRpb25zLmh0bWwpLnRvQ29udGFpbignWW91ciBwYXNzd29yZCBoYXMgYmVlbiBzdWNjZXNzZnVsbHkgcmVzZXQnKTtcbiAgICAgIGV4cGVjdChtYWlsT3B0aW9ucy50ZXh0KS50b0NvbnRhaW4oJ1lvdXIgcGFzc3dvcmQgaGFzIGJlZW4gc3VjY2Vzc2Z1bGx5IHJlc2V0Jyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHRocm93IGVycm9yIHdoZW4gc3VjY2VzcyBlbWFpbCBzZW5kaW5nIGZhaWxzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZXJyb3IgPSBuZXcgRXJyb3IoJ1NNVFAgdGltZW91dCcpO1xuICAgICAgbW9ja1RyYW5zcG9ydGVyLnNlbmRNYWlsLm1vY2tSZWplY3RlZFZhbHVlKGVycm9yKTtcblxuICAgICAgYXdhaXQgZXhwZWN0KFxuICAgICAgICBlbWFpbFNlcnZpY2Uuc2VuZFBhc3N3b3JkUmVzZXRTdWNjZXNzRW1haWwoJ3VzZXJAZXhhbXBsZS5jb20nKVxuICAgICAgKS5yZWplY3RzLnRvVGhyb3coJ1NNVFAgdGltZW91dCcpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnRW1haWwgU2VydmljZSBDb25maWd1cmF0aW9uJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgdXNlIGVudmlyb25tZW50IHZhcmlhYmxlcyBmb3IgU01UUCBjb25maWd1cmF0aW9uJywgKCkgPT4ge1xuICAgICAgY29uc3Qgbm9kZW1haWxlciA9IHJlcXVpcmUoJ25vZGVtYWlsZXInKTtcbiAgICAgIGNvbnN0IGNyZWF0ZVRyYW5zcG9ydGVyID0gbm9kZW1haWxlci5jcmVhdGVUcmFuc3BvcnRlcjtcblxuICAgICAgZGVsZXRlIHJlcXVpcmUuY2FjaGVbcmVxdWlyZS5yZXNvbHZlKCcuLi8uLi9zZXJ2aWNlcy9lbWFpbFNlcnZpY2UnKV07XG4gICAgICByZXF1aXJlKCcuLi8uLi9zZXJ2aWNlcy9lbWFpbFNlcnZpY2UnKTtcblxuICAgICAgZXhwZWN0KGNyZWF0ZVRyYW5zcG9ydGVyKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgIGhvc3Q6ICdzbXRwLnRlc3QuY29tJyxcbiAgICAgICAgcG9ydDogJzU4NycsXG4gICAgICAgIHNlY3VyZTogZmFsc2UsXG4gICAgICAgIGF1dGg6IHtcbiAgICAgICAgICB1c2VyOiAndGVzdEBleGFtcGxlLmNvbScsXG4gICAgICAgICAgcGFzczogJ3Rlc3QtcGFzc3dvcmQnXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB1c2UgZGVmYXVsdHMgd2hlbiBlbnZpcm9ubWVudCB2YXJpYWJsZXMgYXJlIG1pc3NpbmcnLCAoKSA9PiB7XG4gICAgICBkZWxldGUgcHJvY2Vzcy5lbnYuU01UUF9IT1NUO1xuICAgICAgZGVsZXRlIHByb2Nlc3MuZW52LlNNVFBfUE9SVDtcbiAgICAgIGRlbGV0ZSBwcm9jZXNzLmVudi5TTVRQX1VTRVI7XG4gICAgICBkZWxldGUgcHJvY2Vzcy5lbnYuU01UUF9QQVNTO1xuXG4gICAgICBjb25zdCBub2RlbWFpbGVyID0gcmVxdWlyZSgnbm9kZW1haWxlcicpO1xuICAgICAgY29uc3QgY3JlYXRlVHJhbnNwb3J0ZXIgPSBub2RlbWFpbGVyLmNyZWF0ZVRyYW5zcG9ydGVyO1xuXG4gICAgICBkZWxldGUgcmVxdWlyZS5jYWNoZVtyZXF1aXJlLnJlc29sdmUoJy4uLy4uL3NlcnZpY2VzL2VtYWlsU2VydmljZScpXTtcbiAgICAgIHJlcXVpcmUoJy4uLy4uL3NlcnZpY2VzL2VtYWlsU2VydmljZScpO1xuXG4gICAgICBleHBlY3QoY3JlYXRlVHJhbnNwb3J0ZXIpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgaG9zdDogJ3NtdHAuZ21haWwuY29tJyxcbiAgICAgICAgcG9ydDogNTg3LFxuICAgICAgICBzZWN1cmU6IGZhbHNlLFxuICAgICAgICBhdXRoOiB7XG4gICAgICAgICAgdXNlcjogdW5kZWZpbmVkLFxuICAgICAgICAgIHBhc3M6IHVuZGVmaW5lZFxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0Vycm9yIEhhbmRsaW5nJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgaGFuZGxlIG5ldHdvcmsgZXJyb3JzIGluIFNNVFAgY29ubmVjdGlvbicsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG5ldHdvcmtFcnJvciA9IG5ldyBFcnJvcignQ29ubmVjdGlvbiB0aW1lb3V0Jyk7XG4gICAgICBuZXR3b3JrRXJyb3IuY29kZSA9ICdFTk9URk9VTkQnO1xuXG4gICAgICBtb2NrVHJhbnNwb3J0ZXIuc2VuZE1haWwubW9ja1JlamVjdGVkVmFsdWUobmV0d29ya0Vycm9yKTtcblxuICAgICAgYXdhaXQgZXhwZWN0KFxuICAgICAgICBlbWFpbFNlcnZpY2Uuc2VuZFBhc3N3b3JkUmVzZXRFbWFpbCgndXNlckBleGFtcGxlLmNvbScsICd0b2tlbicpXG4gICAgICApLnJlamVjdHMudG9UaHJvdygnQ29ubmVjdGlvbiB0aW1lb3V0Jyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBhdXRoZW50aWNhdGlvbiBlcnJvcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBhdXRoRXJyb3IgPSBuZXcgRXJyb3IoJ0F1dGhlbnRpY2F0aW9uIGZhaWxlZCcpO1xuICAgICAgYXV0aEVycm9yLnJlc3BvbnNlQ29kZSA9IDUzNTtcblxuICAgICAgbW9ja1RyYW5zcG9ydGVyLnNlbmRNYWlsLm1vY2tSZWplY3RlZFZhbHVlKGF1dGhFcnJvcik7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgZW1haWxTZXJ2aWNlLnNlbmRQYXNzd29yZFJlc2V0RW1haWwoJ3VzZXJAZXhhbXBsZS5jb20nLCAndG9rZW4nKVxuICAgICAgKS5yZWplY3RzLnRvVGhyb3coJ0F1dGhlbnRpY2F0aW9uIGZhaWxlZCcpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnRW1haWwgQ29udGVudCBWYWxpZGF0aW9uJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgaW5jbHVkZSBwcm9wZXIgZW1haWwgaGVhZGVycycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGVtYWlsID0gJ3Rlc3RAZXhhbXBsZS5jb20nO1xuICAgICAgY29uc3QgdG9rZW4gPSAncmVzZXQtdG9rZW4teHl6JztcblxuICAgICAgbW9ja1RyYW5zcG9ydGVyLnNlbmRNYWlsLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgbWVzc2FnZUlkOiAnaGVhZGVyLXRlc3QtaWQnXG4gICAgICB9KTtcblxuICAgICAgYXdhaXQgZW1haWxTZXJ2aWNlLnNlbmRQYXNzd29yZFJlc2V0RW1haWwoZW1haWwsIHRva2VuKTtcblxuICAgICAgY29uc3QgbWFpbE9wdGlvbnMgPSBtb2NrVHJhbnNwb3J0ZXIuc2VuZE1haWwubW9jay5jYWxsc1swXVswXTtcblxuICAgICAgZXhwZWN0KG1haWxPcHRpb25zLmZyb20pLnRvRXF1YWwoe1xuICAgICAgICBuYW1lOiAnQ2hhdC1KUyBTdXBwb3J0JyxcbiAgICAgICAgYWRkcmVzczogcHJvY2Vzcy5lbnYuU01UUF9VU0VSXG4gICAgICB9KTtcbiAgICAgIGV4cGVjdChtYWlsT3B0aW9ucy50bykudG9CZShlbWFpbCk7XG4gICAgICBleHBlY3QobWFpbE9wdGlvbnMuc3ViamVjdCkudG9Db250YWluKCdQYXNzd29yZCBSZXNldCcpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBpbmNsdWRlIEhUTUwgYW5kIHRleHQgdmVyc2lvbnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrVHJhbnNwb3J0ZXIuc2VuZE1haWwubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBtZXNzYWdlSWQ6ICdjb250ZW50LXRlc3QtaWQnXG4gICAgICB9KTtcblxuICAgICAgYXdhaXQgZW1haWxTZXJ2aWNlLnNlbmRQYXNzd29yZFJlc2V0RW1haWwoJ3Rlc3RAZXhhbXBsZS5jb20nLCAndG9rZW4tYWJjJyk7XG5cbiAgICAgIGNvbnN0IG1haWxPcHRpb25zID0gbW9ja1RyYW5zcG9ydGVyLnNlbmRNYWlsLm1vY2suY2FsbHNbMF1bMF07XG5cbiAgICAgIGV4cGVjdChtYWlsT3B0aW9ucy5odG1sKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KG1haWxPcHRpb25zLmh0bWwpLnRvQ29udGFpbignPGh0bWwnKTtcbiAgICAgIGV4cGVjdChtYWlsT3B0aW9ucy5odG1sKS50b0NvbnRhaW4oJ1Jlc2V0IFBhc3N3b3JkJyk7XG5cbiAgICAgIGV4cGVjdChtYWlsT3B0aW9ucy50ZXh0KS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KG1haWxPcHRpb25zLnRleHQpLnRvQ29udGFpbignUGFzc3dvcmQgUmVzZXQgUmVxdWVzdCcpO1xuICAgICAgZXhwZWN0KG1haWxPcHRpb25zLnRleHQpLnRvQ29udGFpbigndG9rZW4tYWJjJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHByb3Blcmx5IGVzY2FwZSBIVE1MIGNvbnRlbnQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtYWxpY2lvdXNFbWFpbCA9ICc8c2NyaXB0PmFsZXJ0KFwieHNzXCIpPC9zY3JpcHQ+QGV4YW1wbGUuY29tJztcblxuICAgICAgbW9ja1RyYW5zcG9ydGVyLnNlbmRNYWlsLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgbWVzc2FnZUlkOiAnZXNjYXBlLXRlc3QtaWQnXG4gICAgICB9KTtcblxuICAgICAgLy8gU2hvdWxkIG5vdCB0aHJvdyBvciBjYXVzZSBpc3N1ZXMgd2l0aCBIVE1MIGNvbnRlbnRcbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgZW1haWxTZXJ2aWNlLnNlbmRQYXNzd29yZFJlc2V0RW1haWwobWFsaWNpb3VzRW1haWwsICd0b2tlbicpXG4gICAgICApLnJlc29sdmVzLnRvQmVEZWZpbmVkKCk7XG4gICAgfSk7XG4gIH0pO1xufSk7Il0sIm1hcHBpbmdzIjoiQUFFQTtBQUNBQSxXQUFBLEdBQUtDLElBQUksQ0FBQyxZQUFZLEVBQUUsT0FBTztFQUM3QkMsaUJBQWlCLEVBQUVDLElBQUksQ0FBQ0MsRUFBRSxDQUFDLE9BQU87SUFDaENDLFFBQVEsRUFBRUYsSUFB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