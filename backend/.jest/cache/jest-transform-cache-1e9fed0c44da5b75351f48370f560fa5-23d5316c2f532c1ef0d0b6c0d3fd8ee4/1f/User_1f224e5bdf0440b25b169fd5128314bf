26bda4f420ba920c831c92d631334f88
const mongoose = require('mongoose');
const bcrypt = require('bcryptjs');
const crypto = require('crypto');
const userSchema = new mongoose.Schema({
  nickname: {
    type: String,
    required: true,
    unique: true,
    trim: true,
    minlength: 3,
    maxlength: 50,
    index: true // Remove duplicate index call below
  },
  email: {
    type: String,
    required: true,
    unique: true,
    lowercase: true,
    trim: true,
    index: true // Remove duplicate index call below
  },
  password: {
    type: String,
    required: true,
    minlength: 6
  },
  role: {
    type: String,
    enum: ['admin', 'moderator', 'member'],
    default: 'member'
  },
  createdAt: {
    type: Date,
    default: Date.now
  },
  lastActive: {
    type: Date,
    default: Date.now
  },
  status: {
    type: String,
    enum: ['online', 'offline'],
    default: 'offline'
  },
  // Moderation fields
  banned: {
    type: Boolean,
    default: false
  },
  banReason: {
    type: String,
    default: null
  },
  banExpires: {
    type: Date,
    default: null
  },
  warnings: [{
    reason: String,
    issuedBy: {
      type: mongoose.Schema.Types.ObjectId,
      ref: 'User'
    },
    issuedAt: {
      type: Date,
      default: Date.now
    },
    expires: Date
  }],
  muteExpires: {
    type: Date,
    default: null
  },
  // Temporary tokens
  resetPasswordToken: {
    type: String,
    default: null
  },
  resetPasswordExpires: {
    type: Date,
    default: null
  },
  moderationToken: {
    type: String,
    default: null
  },
  moderationTokenExpires: {
    type: Date,
    default: null
  }
});

// Hash password before saving
userSchema.pre('save', async function (next) {
  if (!this.isModified('password')) return next();
  console.log('Hashing password for user:', this.nickname);
  try {
    const salt = await bcrypt.genSalt(12);
    console.log('Salt generated:', salt);
    this.password = await bcrypt.hash(this.password, salt);
    console.log('Password hashed successfully');
    next();
  } catch (error) {
    console.error('Error hashing password:', error.message);
    next(error);
  }
});

// Compare password method
userSchema.methods.comparePassword = async function (candidatePassword) {
  return bcrypt.compare(candidatePassword, this.password);
};

// Generate reset password token
userSchema.methods.generateResetToken = function () {
  // Generate random token
  const resetToken = crypto.randomBytes(32).toString('hex');

  // Hash token before storing
  this.resetPasswordToken = crypto.createHash('sha256').update(resetToken).digest('hex');

  // Set expiration (1 hour from now)
  this.resetPasswordExpires = Date.now() + 60 * 60 * 1000; // 1 hour

  return resetToken;
};

// Reset password using token
userSchema.methods.resetPassword = function (token, newPassword) {
  const hashedToken = crypto.createHash('sha256').update(token).digest('hex');
  if (hashedToken !== this.resetPasswordToken) {
    throw new Error('Invalid or expired password reset token');
  }
  if (Date.now() > this.resetPasswordExpires) {
    throw new Error('Password reset token has expired');
  }
  this.password = newPassword;
  this.resetPasswordToken = null;
  this.resetPasswordExpires = null;
  return this.save();
};

// Ban user
userSchema.methods.ban = function (reason, duration = null, issuedBy = null) {
  this.banned = true;
  this.banReason = reason;
  if (duration) {
    this.banExpires = new Date(Date.now() + duration);
  } else {
    this.banExpires = null; // permanent ban
  }
  return this.save();
};

// Unban user
userSchema.methods.unban = function () {
  this.banned = false;
  this.banReason = null;
  this.banExpires = null;
  return this.save();
};

// Check if user is banned and if ban is active
userSchema.methods.isBanned = function () {
  if (!this.banned) return false;
  if (!this.banExpires) return true; // permanent ban
  return this.banExpires > new Date(); // temporary ban still active
};

// Add warning to user
userSchema.methods.warn = function (reason, issuedBy, duration = null) {
  const warning = {
    reason: reason,
    issuedBy: issuedBy,
    issuedAt: new Date(),
    expires: duration ? new Date(Date.now() + duration) : null
  };
  this.warnings.push(warning);
  return this.save();
};

// Remove expired warnings
userSchema.methods.cleanWarnings = function () {
  this.warnings = this.warnings.filter(warning => {
    return !warning.expires || warning.expires > new Date();
  });
  return this.save();
};

// Get active warnings count
userSchema.methods.getActiveWarningsCount = function () {
  this.cleanWarnings();
  return this.warnings.length;
};

// Mute user (for chat)
userSchema.methods.mute = function (duration = 3600000) {
  // default 1 hour
  this.muteExpires = new Date(Date.now() + duration);
  return this.save();
};

// Unmute user
userSchema.methods.unmute = function () {
  this.muteExpires = null;
  return this.save();
};

// Check if user is muted
userSchema.methods.isMuted = function () {
  return this.muteExpires && this.muteExpires > new Date();
};

// Generate moderation token for admin actions
userSchema.methods.generateModerationToken = function () {
  const moderationToken = crypto.randomBytes(32).toString('hex');
  this.moderationToken = crypto.createHash('sha256').update(moderationToken).digest('hex');
  this.moderationTokenExpires = Date.now() + 3600000; // 1 hour
  return this.save().then(() => moderationToken);
};

// Verify moderation token
userSchema.methods.verifyModerationToken = function (token) {
  const hashedToken = crypto.createHash('sha256').update(token).digest('hex');
  if (hashedToken !== this.moderationToken) {
    throw new Error('Invalid moderation token');
  }
  if (Date.now() > this.moderationTokenExpires) {
    throw new Error('Moderation token expired');
  }
  this.moderationToken = null;
  this.moderationTokenExpires = null;
  return this.save();
};

// Check if user has moderator/admin permissions
userSchema.methods.hasModeratorPrivileges = function () {
  return this.role === 'admin' || this.role === 'moderator';
};
userSchema.methods.hasAdminPrivileges = function () {
  return this.role === 'admin';
};

// Remove password and sensitive data from JSON output
userSchema.methods.toJSON = function () {
  const userObject = this.toObject();
  delete userObject.password;
  delete userObject.resetPasswordToken;
  delete userObject.resetPasswordExpires;
  delete userObject.moderationToken;
  delete userObject.moderationTokenExpires;
  // Don't show ban details to regular users
  if (!this.hasModeratorPrivileges()) {
    delete userObject.banReason;
    delete userObject.banExpires;
    delete userObject.warnings;
  }
  return userObject;
};
module.exports = mongoose.model('User', userSchema);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJtb25nb29zZSIsInJlcXVpcmUiLCJiY3J5cHQiLCJjcnlwdG8iLCJ1c2VyU2NoZW1hIiwiU2NoZW1hIiwibmlja25hbWUiLCJ0eXBlIiwiU3RyaW5nIiwicmVxdWlyZWQiLCJ1bmlxdWUiLCJ0cmltIiwibWlubGVuZ3RoIiwibWF4bGVuZ3RoIiwiaW5kZXgiLCJlbWFpbCIsImxvd2VyY2FzZSIsInBhc3N3b3JkIiwicm9sZSIsImVudW0iLCJkZWZhdWx0IiwiY3JlYXRlZEF0IiwiRGF0ZSIsIm5vdyIsImxhc3RBY3RpdmUiLCJzdGF0dXMiLCJiYW5uZWQiLCJCb29sZWFuIiwiYmFuUmVhc29uIiwiYmFuRXhwaXJlcyIsIndhcm5pbmdzIiwicmVhc29uIiwiaXNzdWVkQnkiLCJUeXBlcyIsIk9iamVjdElkIiwicmVmIiwiaXNzdWVkQXQiLCJleHBpcmVzIiwibXV0ZUV4cGlyZXMiLCJyZXNldFBhc3N3b3JkVG9rZW4iLCJyZXNldFBhc3N3b3JkRXhwaXJlcyIsIm1vZGVyYXRpb25Ub2tlbiIsIm1vZGVyYXRpb25Ub2tlbkV4cGlyZXMiLCJwcmUiLCJuZXh0IiwiaXNNb2RpZmllZCIsImNvbnNvbGUiLCJsb2ciLCJzYWx0IiwiZ2VuU2FsdCIsImhhc2giLCJlcnJvciIsIm1lc3NhZ2UiLCJtZXRob2RzIiwiY29tcGFyZVBhc3N3b3JkIiwiY2FuZGlkYXRlUGFzc3dvcmQiLCJjb21wYXJlIiwiZ2VuZXJhdGVSZXNldFRva2VuIiwicmVzZXRUb2tlbiIsInJhbmRvbUJ5dGVzIiwidG9TdHJpbmciLCJjcmVhdGVIYXNoIiwidXBkYXRlIiwiZGlnZXN0IiwicmVzZXRQYXNzd29yZCIsInRva2VuIiwibmV3UGFzc3dvcmQiLCJoYXNoZWRUb2tlbiIsIkVycm9yIiwic2F2ZSIsImJhbiIsImR1cmF0aW9uIiwidW5iYW4iLCJpc0Jhbm5lZCIsIndhcm4iLCJ3YXJuaW5nIiwicHVzaCIsImNsZWFuV2FybmluZ3MiLCJmaWx0ZXIiLCJnZXRBY3RpdmVXYXJuaW5nc0NvdW50IiwibGVuZ3RoIiwibXV0ZSIsInVubXV0ZSIsImlzTXV0ZWQiLCJnZW5lcmF0ZU1vZGVyYXRpb25Ub2tlbiIsInRoZW4iLCJ2ZXJpZnlNb2RlcmF0aW9uVG9rZW4iLCJoYXNNb2RlcmF0b3JQcml2aWxlZ2VzIiwiaGFzQWRtaW5Qcml2aWxlZ2VzIiwidG9KU09OIiwidXNlck9iamVjdCIsInRvT2JqZWN0IiwibW9kdWxlIiwiZXhwb3J0cyIsIm1vZGVsIl0sInNvdXJjZXMiOlsiVXNlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBtb25nb29zZSA9IHJlcXVpcmUoJ21vbmdvb3NlJyk7XG5jb25zdCBiY3J5cHQgPSByZXF1aXJlKCdiY3J5cHRqcycpO1xuY29uc3QgY3J5cHRvID0gcmVxdWlyZSgnY3J5cHRvJyk7XG5cbmNvbnN0IHVzZXJTY2hlbWEgPSBuZXcgbW9uZ29vc2UuU2NoZW1hKHtcbiAgbmlja25hbWU6IHtcbiAgICB0eXBlOiBTdHJpbmcsXG4gICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgdW5pcXVlOiB0cnVlLFxuICAgIHRyaW06IHRydWUsXG4gICAgbWlubGVuZ3RoOiAzLFxuICAgIG1heGxlbmd0aDogNTAsXG4gICAgaW5kZXg6IHRydWUgLy8gUmVtb3ZlIGR1cGxpY2F0ZSBpbmRleCBjYWxsIGJlbG93XG4gIH0sXG4gIGVtYWlsOiB7XG4gICAgdHlwZTogU3RyaW5nLFxuICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIHVuaXF1ZTogdHJ1ZSxcbiAgICBsb3dlcmNhc2U6IHRydWUsXG4gICAgdHJpbTogdHJ1ZSxcbiAgICBpbmRleDogdHJ1ZSAvLyBSZW1vdmUgZHVwbGljYXRlIGluZGV4IGNhbGwgYmVsb3dcbiAgfSxcbiAgcGFzc3dvcmQ6IHtcbiAgICB0eXBlOiBTdHJpbmcsXG4gICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgbWlubGVuZ3RoOiA2XG4gIH0sXG4gIHJvbGU6IHtcbiAgICB0eXBlOiBTdHJpbmcsXG4gICAgZW51bTogWydhZG1pbicsICdtb2RlcmF0b3InLCAnbWVtYmVyJ10sXG4gICAgZGVmYXVsdDogJ21lbWJlcidcbiAgfSxcbiAgY3JlYXRlZEF0OiB7XG4gICAgdHlwZTogRGF0ZSxcbiAgICBkZWZhdWx0OiBEYXRlLm5vd1xuICB9LFxuICBsYXN0QWN0aXZlOiB7XG4gICAgdHlwZTogRGF0ZSxcbiAgICBkZWZhdWx0OiBEYXRlLm5vd1xuICB9LFxuICBzdGF0dXM6IHtcbiAgICB0eXBlOiBTdHJpbmcsXG4gICAgZW51bTogWydvbmxpbmUnLCAnb2ZmbGluZSddLFxuICAgIGRlZmF1bHQ6ICdvZmZsaW5lJ1xuICB9LFxuICAvLyBNb2RlcmF0aW9uIGZpZWxkc1xuICBiYW5uZWQ6IHtcbiAgICB0eXBlOiBCb29sZWFuLFxuICAgIGRlZmF1bHQ6IGZhbHNlXG4gIH0sXG4gIGJhblJlYXNvbjoge1xuICAgIHR5cGU6IFN0cmluZyxcbiAgICBkZWZhdWx0OiBudWxsXG4gIH0sXG4gIGJhbkV4cGlyZXM6IHtcbiAgICB0eXBlOiBEYXRlLFxuICAgIGRlZmF1bHQ6IG51bGxcbiAgfSxcbiAgd2FybmluZ3M6IFt7XG4gICAgcmVhc29uOiBTdHJpbmcsXG4gICAgaXNzdWVkQnk6IHsgdHlwZTogbW9uZ29vc2UuU2NoZW1hLlR5cGVzLk9iamVjdElkLCByZWY6ICdVc2VyJyB9LFxuICAgIGlzc3VlZEF0OiB7IHR5cGU6IERhdGUsIGRlZmF1bHQ6IERhdGUubm93IH0sXG4gICAgZXhwaXJlczogRGF0ZVxuICB9XSxcbiAgbXV0ZUV4cGlyZXM6IHtcbiAgICB0eXBlOiBEYXRlLFxuICAgIGRlZmF1bHQ6IG51bGxcbiAgfSxcbiAgLy8gVGVtcG9yYXJ5IHRva2Vuc1xuICByZXNldFBhc3N3b3JkVG9rZW46IHtcbiAgICB0eXBlOiBTdHJpbmcsXG4gICAgZGVmYXVsdDogbnVsbFxuICB9LFxuICByZXNldFBhc3N3b3JkRXhwaXJlczoge1xuICAgIHR5cGU6IERhdGUsXG4gICAgZGVmYXVsdDogbnVsbFxuICB9LFxuICBtb2RlcmF0aW9uVG9rZW46IHtcbiAgICB0eXBlOiBTdHJpbmcsXG4gICAgZGVmYXVsdDogbnVsbFxuICB9LFxuICBtb2RlcmF0aW9uVG9rZW5FeHBpcmVzOiB7XG4gICAgdHlwZTogRGF0ZSxcbiAgICBkZWZhdWx0OiBudWxsXG4gIH1cbn0pO1xuXG4vLyBIYXNoIHBhc3N3b3JkIGJlZm9yZSBzYXZpbmdcbnVzZXJTY2hlbWEucHJlKCdzYXZlJywgYXN5bmMgZnVuY3Rpb24obmV4dCkge1xuICAgaWYgKCF0aGlzLmlzTW9kaWZpZWQoJ3Bhc3N3b3JkJykpIHJldHVybiBuZXh0KCk7XG5cbiAgIGNvbnNvbGUubG9nKCdIYXNoaW5nIHBhc3N3b3JkIGZvciB1c2VyOicsIHRoaXMubmlja25hbWUpO1xuICAgdHJ5IHtcbiAgICAgY29uc3Qgc2FsdCA9IGF3YWl0IGJjcnlwdC5nZW5TYWx0KDEyKTtcbiAgICAgY29uc29sZS5sb2coJ1NhbHQgZ2VuZXJhdGVkOicsIHNhbHQpO1xuICAgICB0aGlzLnBhc3N3b3JkID0gYXdhaXQgYmNyeXB0Lmhhc2godGhpcy5wYXNzd29yZCwgc2FsdCk7XG4gICAgIGNvbnNvbGUubG9nKCdQYXNzd29yZCBoYXNoZWQgc3VjY2Vzc2Z1bGx5Jyk7XG4gICAgIG5leHQoKTtcbiAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGhhc2hpbmcgcGFzc3dvcmQ6JywgZXJyb3IubWVzc2FnZSk7XG4gICAgIG5leHQoZXJyb3IpO1xuICAgfVxuIH0pO1xuXG4vLyBDb21wYXJlIHBhc3N3b3JkIG1ldGhvZFxudXNlclNjaGVtYS5tZXRob2RzLmNvbXBhcmVQYXNzd29yZCA9IGFzeW5jIGZ1bmN0aW9uKGNhbmRpZGF0ZVBhc3N3b3JkKSB7XG4gIHJldHVybiBiY3J5cHQuY29tcGFyZShjYW5kaWRhdGVQYXNzd29yZCwgdGhpcy5wYXNzd29yZCk7XG59O1xuXG4vLyBHZW5lcmF0ZSByZXNldCBwYXNzd29yZCB0b2tlblxudXNlclNjaGVtYS5tZXRob2RzLmdlbmVyYXRlUmVzZXRUb2tlbiA9IGZ1bmN0aW9uKCkge1xuICAvLyBHZW5lcmF0ZSByYW5kb20gdG9rZW5cbiAgY29uc3QgcmVzZXRUb2tlbiA9IGNyeXB0by5yYW5kb21CeXRlcygzMikudG9TdHJpbmcoJ2hleCcpO1xuXG4gIC8vIEhhc2ggdG9rZW4gYmVmb3JlIHN0b3JpbmdcbiAgdGhpcy5yZXNldFBhc3N3b3JkVG9rZW4gPSBjcnlwdG9cbiAgICAuY3JlYXRlSGFzaCgnc2hhMjU2JylcbiAgICAudXBkYXRlKHJlc2V0VG9rZW4pXG4gICAgLmRpZ2VzdCgnaGV4Jyk7XG5cbiAgLy8gU2V0IGV4cGlyYXRpb24gKDEgaG91ciBmcm9tIG5vdylcbiAgdGhpcy5yZXNldFBhc3N3b3JkRXhwaXJlcyA9IERhdGUubm93KCkgKyA2MCAqIDYwICogMTAwMDsgLy8gMSBob3VyXG5cbiAgcmV0dXJuIHJlc2V0VG9rZW47XG59O1xuXG4vLyBSZXNldCBwYXNzd29yZCB1c2luZyB0b2tlblxudXNlclNjaGVtYS5tZXRob2RzLnJlc2V0UGFzc3dvcmQgPSBmdW5jdGlvbih0b2tlbiwgbmV3UGFzc3dvcmQpIHtcbiAgY29uc3QgaGFzaGVkVG9rZW4gPSBjcnlwdG9cbiAgICAuY3JlYXRlSGFzaCgnc2hhMjU2JylcbiAgICAudXBkYXRlKHRva2VuKVxuICAgIC5kaWdlc3QoJ2hleCcpO1xuXG4gIGlmIChoYXNoZWRUb2tlbiAhPT0gdGhpcy5yZXNldFBhc3N3b3JkVG9rZW4pIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgb3IgZXhwaXJlZCBwYXNzd29yZCByZXNldCB0b2tlbicpO1xuICB9XG5cbiAgaWYgKERhdGUubm93KCkgPiB0aGlzLnJlc2V0UGFzc3dvcmRFeHBpcmVzKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdQYXNzd29yZCByZXNldCB0b2tlbiBoYXMgZXhwaXJlZCcpO1xuICB9XG5cbiAgdGhpcy5wYXNzd29yZCA9IG5ld1Bhc3N3b3JkO1xuICB0aGlzLnJlc2V0UGFzc3dvcmRUb2tlbiA9IG51bGw7XG4gIHRoaXMucmVzZXRQYXNzd29yZEV4cGlyZXMgPSBudWxsO1xuXG4gIHJldHVybiB0aGlzLnNhdmUoKTtcbn07XG5cbi8vIEJhbiB1c2VyXG51c2VyU2NoZW1hLm1ldGhvZHMuYmFuID0gZnVuY3Rpb24ocmVhc29uLCBkdXJhdGlvbiA9IG51bGwsIGlzc3VlZEJ5ID0gbnVsbCkge1xuICB0aGlzLmJhbm5lZCA9IHRydWU7XG4gIHRoaXMuYmFuUmVhc29uID0gcmVhc29uO1xuICBpZiAoZHVyYXRpb24pIHtcbiAgICB0aGlzLmJhbkV4cGlyZXMgPSBuZXcgRGF0ZShEYXRlLm5vdygpICsgZHVyYXRpb24pO1xuICB9IGVsc2Uge1xuICAgIHRoaXMuYmFuRXhwaXJlcyA9IG51bGw7IC8vIHBlcm1hbmVudCBiYW5cbiAgfVxuICByZXR1cm4gdGhpcy5zYXZlKCk7XG59O1xuXG4vLyBVbmJhbiB1c2VyXG51c2VyU2NoZW1hLm1ldGhvZHMudW5iYW4gPSBmdW5jdGlvbigpIHtcbiAgdGhpcy5iYW5uZWQgPSBmYWxzZTtcbiAgdGhpcy5iYW5SZWFzb24gPSBudWxsO1xuICB0aGlzLmJhbkV4cGlyZXMgPSBudWxsO1xuICByZXR1cm4gdGhpcy5zYXZlKCk7XG59O1xuXG4vLyBDaGVjayBpZiB1c2VyIGlzIGJhbm5lZCBhbmQgaWYgYmFuIGlzIGFjdGl2ZVxudXNlclNjaGVtYS5tZXRob2RzLmlzQmFubmVkID0gZnVuY3Rpb24oKSB7XG4gIGlmICghdGhpcy5iYW5uZWQpIHJldHVybiBmYWxzZTtcbiAgaWYgKCF0aGlzLmJhbkV4cGlyZXMpIHJldHVybiB0cnVlOyAvLyBwZXJtYW5lbnQgYmFuXG4gIHJldHVybiB0aGlzLmJhbkV4cGlyZXMgPiBuZXcgRGF0ZSgpOyAvLyB0ZW1wb3JhcnkgYmFuIHN0aWxsIGFjdGl2ZVxufTtcblxuLy8gQWRkIHdhcm5pbmcgdG8gdXNlclxudXNlclNjaGVtYS5tZXRob2RzLndhcm4gPSBmdW5jdGlvbihyZWFzb24sIGlzc3VlZEJ5LCBkdXJhdGlvbiA9IG51bGwpIHtcbiAgY29uc3Qgd2FybmluZyA9IHtcbiAgICByZWFzb246IHJlYXNvbixcbiAgICBpc3N1ZWRCeTogaXNzdWVkQnksXG4gICAgaXNzdWVkQXQ6IG5ldyBEYXRlKCksXG4gICAgZXhwaXJlczogZHVyYXRpb24gPyBuZXcgRGF0ZShEYXRlLm5vdygpICsgZHVyYXRpb24pIDogbnVsbFxuICB9O1xuICB0aGlzLndhcm5pbmdzLnB1c2god2FybmluZyk7XG4gIHJldHVybiB0aGlzLnNhdmUoKTtcbn07XG5cbi8vIFJlbW92ZSBleHBpcmVkIHdhcm5pbmdzXG51c2VyU2NoZW1hLm1ldGhvZHMuY2xlYW5XYXJuaW5ncyA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLndhcm5pbmdzID0gdGhpcy53YXJuaW5ncy5maWx0ZXIod2FybmluZyA9PiB7XG4gICAgcmV0dXJuICF3YXJuaW5nLmV4cGlyZXMgfHwgd2FybmluZy5leHBpcmVzID4gbmV3IERhdGUoKTtcbiAgfSk7XG4gIHJldHVybiB0aGlzLnNhdmUoKTtcbn07XG5cbi8vIEdldCBhY3RpdmUgd2FybmluZ3MgY291bnRcbnVzZXJTY2hlbWEubWV0aG9kcy5nZXRBY3RpdmVXYXJuaW5nc0NvdW50ID0gZnVuY3Rpb24oKSB7XG4gIHRoaXMuY2xlYW5XYXJuaW5ncygpO1xuICByZXR1cm4gdGhpcy53YXJuaW5ncy5sZW5ndGg7XG59O1xuXG4vLyBNdXRlIHVzZXIgKGZvciBjaGF0KVxudXNlclNjaGVtYS5tZXRob2RzLm11dGUgPSBmdW5jdGlvbihkdXJhdGlvbiA9IDM2MDAwMDApIHsgLy8gZGVmYXVsdCAxIGhvdXJcbiAgdGhpcy5tdXRlRXhwaXJlcyA9IG5ldyBEYXRlKERhdGUubm93KCkgKyBkdXJhdGlvbik7XG4gIHJldHVybiB0aGlzLnNhdmUoKTtcbn07XG5cbi8vIFVubXV0ZSB1c2VyXG51c2VyU2NoZW1hLm1ldGhvZHMudW5tdXRlID0gZnVuY3Rpb24oKSB7XG4gIHRoaXMubXV0ZUV4cGlyZXMgPSBudWxsO1xuICByZXR1cm4gdGhpcy5zYXZlKCk7XG59O1xuXG4vLyBDaGVjayBpZiB1c2VyIGlzIG11dGVkXG51c2VyU2NoZW1hLm1ldGhvZHMuaXNNdXRlZCA9IGZ1bmN0aW9uKCkge1xuICByZXR1cm4gdGhpcy5tdXRlRXhwaXJlcyAmJiB0aGlzLm11dGVFeHBpcmVzID4gbmV3IERhdGUoKTtcbn07XG5cbi8vIEdlbmVyYXRlIG1vZGVyYXRpb24gdG9rZW4gZm9yIGFkbWluIGFjdGlvbnNcbnVzZXJTY2hlbWEubWV0aG9kcy5nZW5lcmF0ZU1vZGVyYXRpb25Ub2tlbiA9IGZ1bmN0aW9uKCkge1xuICBjb25zdCBtb2RlcmF0aW9uVG9rZW4gPSBjcnlwdG8ucmFuZG9tQnl0ZXMoMzIpLnRvU3RyaW5nKCdoZXgnKTtcbiAgdGhpcy5tb2RlcmF0aW9uVG9rZW4gPSBjcnlwdG9cbiAgICAuY3JlYXRlSGFzaCgnc2hhMjU2JylcbiAgICAudXBkYXRlKG1vZGVyYXRpb25Ub2tlbilcbiAgICAuZGlnZXN0KCdoZXgnKTtcbiAgdGhpcy5tb2RlcmF0aW9uVG9rZW5FeHBpcmVzID0gRGF0ZS5ub3coKSArIDM2MDAwMDA7IC8vIDEgaG91clxuICByZXR1cm4gdGhpcy5zYXZlKCkudGhlbigoKSA9PiBtb2RlcmF0aW9uVG9rZW4pO1xufTtcblxuLy8gVmVyaWZ5IG1vZGVyYXRpb24gdG9rZW5cbnVzZXJTY2hlbWEubWV0aG9kcy52ZXJpZnlNb2RlcmF0aW9uVG9rZW4gPSBmdW5jdGlvbih0b2tlbikge1xuICBjb25zdCBoYXNoZWRUb2tlbiA9IGNyeXB0b1xuICAgIC5jcmVhdGVIYXNoKCdzaGEyNTYnKVxuICAgIC51cGRhdGUodG9rZW4pXG4gICAgLmRpZ2VzdCgnaGV4Jyk7XG5cbiAgaWYgKGhhc2hlZFRva2VuICE9PSB0aGlzLm1vZGVyYXRpb25Ub2tlbikge1xuICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBtb2RlcmF0aW9uIHRva2VuJyk7XG4gIH1cblxuICBpZiAoRGF0ZS5ub3coKSA+IHRoaXMubW9kZXJhdGlvblRva2VuRXhwaXJlcykge1xuICAgIHRocm93IG5ldyBFcnJvcignTW9kZXJhdGlvbiB0b2tlbiBleHBpcmVkJyk7XG4gIH1cblxuICB0aGlzLm1vZGVyYXRpb25Ub2tlbiA9IG51bGw7XG4gIHRoaXMubW9kZXJhdGlvblRva2VuRXhwaXJlcyA9IG51bGw7XG4gIHJldHVybiB0aGlzLnNhdmUoKTtcbn07XG5cbi8vIENoZWNrIGlmIHVzZXIgaGFzIG1vZGVyYXRvci9hZG1pbiBwZXJtaXNzaW9uc1xudXNlclNjaGVtYS5tZXRob2RzLmhhc01vZGVyYXRvclByaXZpbGVnZXMgPSBmdW5jdGlvbigpIHtcbiAgcmV0dXJuIHRoaXMucm9sZSA9PT0gJ2FkbWluJyB8fCB0aGlzLnJvbGUgPT09ICdtb2RlcmF0b3InO1xufTtcblxudXNlclNjaGVtYS5tZXRob2RzLmhhc0FkbWluUHJpdmlsZWdlcyA9IGZ1bmN0aW9uKCkge1xuICByZXR1cm4gdGhpcy5yb2xlID09PSAnYWRtaW4nO1xufTtcblxuLy8gUmVtb3ZlIHBhc3N3b3JkIGFuZCBzZW5zaXRpdmUgZGF0YSBmcm9tIEpTT04gb3V0cHV0XG51c2VyU2NoZW1hLm1ldGhvZHMudG9KU09OID0gZnVuY3Rpb24oKSB7XG4gIGNvbnN0IHVzZXJPYmplY3QgPSB0aGlzLnRvT2JqZWN0KCk7XG4gIGRlbGV0ZSB1c2VyT2JqZWN0LnBhc3N3b3JkO1xuICBkZWxldGUgdXNlck9iamVjdC5yZXNldFBhc3N3b3JkVG9rZW47XG4gIGRlbGV0ZSB1c2VyT2JqZWN0LnJlc2V0UGFzc3dvcmRFeHBpcmVzO1xuICBkZWxldGUgdXNlck9iamVjdC5tb2RlcmF0aW9uVG9rZW47XG4gIGRlbGV0ZSB1c2VyT2JqZWN0Lm1vZGVyYXRpb25Ub2tlbkV4cGlyZXM7XG4gIC8vIERvbid0IHNob3cgYmFuIGRldGFpbHMgdG8gcmVndWxhciB1c2Vyc1xuICBpZiAoIXRoaXMuaGFzTW9kZXJhdG9yUHJpdmlsZWdlcygpKSB7XG4gICAgZGVsZXRlIHVzZXJPYmplY3QuYmFuUmVhc29uO1xuICAgIGRlbGV0ZSB1c2VyT2JqZWN0LmJhbkV4cGlyZXM7XG4gICAgZGVsZXRlIHVzZXJPYmplY3Qud2FybmluZ3M7XG4gIH1cbiAgcmV0dXJuIHVzZXJPYmplY3Q7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vbmdvb3NlLm1vZGVsKCdVc2VyJywgdXNlclNjaGVtYSk7Il0sIm1hcHBpbmdzIjoiQUFBQSxNQUFNQSxRQUFRLEdBQUdDLE9BQU8sQ0FBQyxVQUFVLENBQUM7QUFDcEMsTUFBTUMsTUFBTSxHQUFHRCxPQUFPLENBQUMsVUFBVSxDQUFDO0FBQ2xDLE1BQU1FLE1BQU0sR0FBR0YsT0FBTyxDQUFDLFFBQVEsQ0FBQztBQUVoQyxNQUFNRyxVQUFVLEdBQUcsSUFBSUosUUFBUSxDQUFDSyxNQUFNLENBQUM7RUFDckNDLFFBQVEsRUFBRTtJQUNSQyxJQUFJLEVBQUVDLE1BQU07SUFDWkMsUUFBUSxFQUFFLElBQUk7SUFDZEMsTUFBTSxFQUFFLElBQUk7SUFDWkMsSUFBSSxFQUFFLElBQUk7SUFDVkMsU0FBUyxFQUFFLENBQUM7SUFDWkMsU0FBUyxFQUFFLEVBQUU7SUFDYkMsS0FBSyxFQUFFLElBQUksQ0FBQztFQUNkLENBQUM7RUFDREMsS0FBSyxFQUFFO0lBQ0xSLElBQUksRUFBRUMsTUFBTTtJQUNaQyxRQUFRLEVBQUUsSUFBSTtJQUNkQyxNQUFNLEVBQUUsSUFBSTtJQUNaTSxTQUFTLEVBQUUsSUFBSTtJQUNmTCxJQUFJLEVBQUUsSUFBSTtJQUNWRyxLQUFLLEVBQUUsSUFBSSxDQUFDO0VBQ2QsQ0FBQztFQUNERyxRQUFRLEVBQUU7SUFDUlYsSUFBSSxFQUFFQyxNQUFNO0lBQ1pDLFFBQVEsRUFBRSxJQUFJO0lBQ2RHLFNBQVMsRUFBRTtFQUNiLENBQUM7RUFDRE0sSUFBSSxFQUFFO0lBQ0pYLElBQUksRUFBRUMsTUFBTTtJQUNaVyxJQUFJLEVBQUUsQ0FBQyxPQUFPLEVBQUUsV0FBVyxFQUFFLFFBQVEsQ0FBQztJQUN0Q0MsT0FBTyxFQUFFO0VBQ1gsQ0FBQztFQUNEQyxTQUFTLEVBQUU7SUFDVGQsSUFBSSxFQUFFZSxJQUFJO0lBQ1ZGLE9BQU8sRUFBRUUsSUFBSSxDQUFD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QyxDQUNiRixNQUFNLENBQUMsS0FBSyxDQUFDO0VBRWhCLElBQUlJLFdBQVcsS0FBSyxJQUFJLENBQUMxQixlQUFlLEVBQUU7SUFDeEMsTUFBTSxJQUFJMkIsS0FBSyxDQUFDLDBCQUEwQixDQUFDO0VBQzdDO0VBRUEsSUFBSTlDLElBQUksQ0FBQ0MsR0FBRyxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUNtQixzQkFBc0IsRUFBRTtJQUM1QyxNQUFNLElBQUkwQixLQUFLLENBQUMsMEJBQTBCLENBQUM7RUFDN0M7RUFFQSxJQUFJLENBQUMzQixlQUFlLEdBQUcsSUFBSTtFQUMzQixJQUFJLENBQUNDLHNCQUFzQixHQUFHLElBQUk7RUFDbEMsT0FBTyxJQUFJLENBQUMyQixJQUFJLENBQUMsQ0FBQztBQUNwQixDQUFDOztBQUVEO0FBQ0FqRSxVQUFVLENBQUNpRCxPQUFPLENBQUNrQyxzQkFBc0IsR0FBRyxZQUFXO0VBQ3JELE9BQU8sSUFBSSxDQUFDckUsSUFBSSxLQUFLLE9BQU8sSUFBSSxJQUFJLENBQUNBLElBQUksS0FBSyxXQUFXO0FBQzNELENBQUM7QUFFRGQsVUFBVSxDQUFDaUQsT0FBTyxDQUFDbUMsa0JBQWtCLEdBQUcsWUFBVztFQUNqRCxPQUFPLElBQUksQ0FBQ3RFLElBQUksS0FBSyxPQUFPO0FBQzlCLENBQUM7O0FBRUQ7QUFDQWQsVUFBVSxDQUFDaUQsT0FBTyxDQUFDb0MsTUFBTSxHQUFHLFlBQVc7RUFDckMsTUFBTUMsVUFBVSxHQUFHLElBQUksQ0FBQ0MsUUFBUSxDQUFDLENBQUM7RUFDbEMsT0FBT0QsVUFBVSxDQUFDekUsUUFBUTtFQUMxQixPQUFPeUUsVUFBVSxDQUFDbkQsa0JBQWtCO0VBQ3BDLE9BQU9tRCxVQUFVLENBQUNsRCxvQkFBb0I7RUFDdEMsT0FBT2tELFVBQVUsQ0FBQ2pELGVBQWU7RUFDakMsT0FBT2lELFVBQVUsQ0FBQ2hELHNCQUFzQjtFQUN4QztFQUNBLElBQUksQ0FBQyxJQUFJLENBQUM2QyxzQkFBc0IsQ0FBQyxDQUFDLEVBQUU7SUFDbEMsT0FBT0csVUFBVSxDQUFDOUQsU0FBUztJQUMzQixPQUFPOEQsVUFBVSxDQUFDN0QsVUFBVTtJQUM1QixPQUFPNkQsVUFBVSxDQUFDNUQsUUFBUTtFQUM1QjtFQUNBLE9BQU80RCxVQUFVO0FBQ25CLENBQUM7QUFFREUsTUFBTSxDQUFDQyxPQUFPLEdBQUc3RixRQUFRLENBQUM4RixLQUFLLENBQUMsTUFBTSxFQUFFMUYsVUFBVSxDQUFDIiwiaWdub3JlTGlzdCI6W119