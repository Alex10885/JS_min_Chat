{"version":3,"names":["cov_27kbpnqs8d","actualCoverage","nodemailer","s","require","EmailService","constructor","f","transporter","createTransport","host","b","process","env","SMTP_HOST","port","SMTP_PORT","secure","auth","user","SMTP_USER","pass","SMTP_PASS","sendPasswordResetEmail","email","resetToken","resetUrl","FRONTEND_URL","mailOptions","from","name","address","to","subject","html","text","info","sendMail","console","log","messageId","success","error","sendPasswordResetSuccessEmail","module","exports"],"sources":["emailService.js"],"sourcesContent":["const nodemailer = require('nodemailer');\n\nclass EmailService {\n  constructor() {\n    this.transporter = nodemailer.createTransport({\n      host: process.env.SMTP_HOST || 'smtp.gmail.com',\n      port: process.env.SMTP_PORT || 587,\n      secure: false, // true for 465, false for other ports\n      auth: {\n        user: process.env.SMTP_USER,\n        pass: process.env.SMTP_PASS\n      }\n    });\n  }\n\n  async sendPasswordResetEmail(email, resetToken) {\n    const resetUrl = `${process.env.FRONTEND_URL || 'http://localhost:3000'}/reset-password/${resetToken}`;\n\n    const mailOptions = {\n      from: {\n        name: 'Chat-JS Support',\n        address: process.env.SMTP_USER\n      },\n      to: email,\n      subject: 'Password Reset Request - Chat-JS',\n      html: `\n        <!DOCTYPE html>\n        <html lang=\"en\">\n        <head>\n            <meta charset=\"UTF-8\">\n            <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n            <title>Password Reset</title>\n            <style>\n                body { font-family: Arial, sans-serif; line-height: 1.6; color: #333; }\n                .container { max-width: 600px; margin: 0 auto; padding: 20px; }\n                .header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 10px 10px 0 0; }\n                .content { background: #f8f9fa; padding: 20px; border: 1px solid #dee2e6; }\n                .button { display: inline-block; padding: 12px 24px; background: #007bff; color: white; text-decoration: none; border-radius: 5px; margin: 20px 0; }\n                .footer { background: #6c757d; color: white; padding: 20px; border-radius: 0 0 10px 10px; font-size: 12px; }\n            </style>\n        </head>\n        <body>\n            <div class=\"container\">\n                <div class=\"header\">\n                    <h2>Password Reset Request</h2>\n                </div>\n                <div class=\"content\">\n                    <p>You have requested to reset your password for your Chat-JS account.</p>\n                    <p>Please click the button below to reset your password:</p>\n\n                    <a href=\"${resetUrl}\" class=\"button\">Reset Password</a>\n\n                    <p><strong>This link will expire in 1 hour.</strong></p>\n\n                    <p>If you did not request this password reset, please ignore this email.</p>\n\n                    <p>For security reasons, this link can only be used once.</p>\n                </div>\n                <div class=\"footer\">\n                    <p>If the button doesn't work, copy and paste this URL into your browser:</p>\n                    <p>${resetUrl}</p>\n                    <p>&copy; 2024 Chat-JS. All rights reserved.</p>\n                </div>\n            </div>\n        </body>\n        </html>\n      `,\n      text: `\n        Password Reset Request - Chat-JS\n\n        You have requested to reset your password.\n\n        Please use the following link to reset your password:\n        ${resetUrl}\n\n        This link will expire in 1 hour.\n\n        If you did not request this password reset, please ignore this email.\n\n        Best regards,\n        Chat-JS Support Team\n      `\n    };\n\n    try {\n      const info = await this.transporter.sendMail(mailOptions);\n      console.log('Password reset email sent:', info.messageId);\n      return { success: true, messageId: info.messageId };\n    } catch (error) {\n      console.error('Error sending password reset email:', error);\n      throw error;\n    }\n  }\n\n  async sendPasswordResetSuccessEmail(email) {\n    const mailOptions = {\n      from: {\n        name: 'Chat-JS Support',\n        address: process.env.SMTP_USER\n      },\n      to: email,\n      subject: 'Password Reset Successful - Chat-JS',\n      html: `\n        <!DOCTYPE html>\n        <html lang=\"en\">\n        <head>\n            <meta charset=\"UTF-8\">\n            <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n            <title>Password Reset Successful</title>\n            <style>\n                body { font-family: Arial, sans-serif; line-height: 1.6; color: #333; }\n                .container { max-width: 600px; margin: 0 auto; padding: 20px; }\n                .header { background: linear-gradient(135deg, #28a745 0%, #20c997 100%); color: white; padding: 20px; border-radius: 10px 10px 0 0; }\n                .content { background: #f8f9fa; padding: 20px; border: 1px solid #dee2e6; }\n                .footer { background: #6c757d; color: white; padding: 20px; border-radius: 0 0 10px 10px; font-size: 12px; }\n            </style>\n        </head>\n        <body>\n            <div class=\"container\">\n                <div class=\"header\">\n                    <h2>Password Reset Successful</h2>\n                </div>\n                <div class=\"content\">\n                    <p>Your password has been successfully reset!</p>\n                    <p>You can now sign in to your Chat-JS account with your new password.</p>\n                    <p>If you did not make this change, please contact our support team immediately.</p>\n                </div>\n                <div class=\"footer\">\n                    <p>&copy; 2024 Chat-JS. All rights reserved.</p>\n                </div>\n            </div>\n        </body>\n        </html>\n      `,\n      text: `\n        Password Reset Successful - Chat-JS\n\n        Your password has been successfully reset!\n\n        You can now sign in to your Chat-JS account with your new password.\n\n        If you did not make this change, please contact our support team immediately.\n\n        Best regards,\n        Chat-JS Support Team\n      `\n    };\n\n    try {\n      const info = await this.transporter.sendMail(mailOptions);\n      console.log('Password reset success email sent:', info.messageId);\n      return { success: true, messageId: info.messageId };\n    } catch (error) {\n      console.error('Error sending password reset success email:', error);\n      throw error;\n    }\n  }\n}\n\nmodule.exports = new EmailService();"],"mappings":"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","ignoreList":[]}