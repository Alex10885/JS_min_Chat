c8f0eeaf653739e4d637c1a9ef379fe1
const mongoose = require('mongoose');
const bcrypt = require('bcryptjs');
const crypto = require('crypto');
const userSchema = new mongoose.Schema({
  nickname: {
    type: String,
    required: true,
    unique: true,
    trim: true,
    minlength: 3,
    maxlength: 50,
    index: true // Remove duplicate index call below
  },
  email: {
    type: String,
    required: true,
    unique: true,
    lowercase: true,
    trim: true,
    index: true // Remove duplicate index call below
  },
  password: {
    type: String,
    required: true,
    minlength: 6
  },
  role: {
    type: String,
    enum: ['admin', 'moderator', 'member'],
    default: 'member'
  },
  createdAt: {
    type: Date,
    default: Date.now
  },
  lastActive: {
    type: Date,
    default: Date.now
  },
  status: {
    type: String,
    enum: ['online', 'offline'],
    default: 'offline'
  },
  // Moderation fields
  banned: {
    type: Boolean,
    default: false
  },
  banReason: {
    type: String,
    default: null
  },
  banExpires: {
    type: Date,
    default: null
  },
  warnings: [{
    reason: String,
    issuedBy: {
      type: mongoose.Schema.Types.ObjectId,
      ref: 'User'
    },
    issuedAt: {
      type: Date,
      default: Date.now
    },
    expires: Date
  }],
  muteExpires: {
    type: Date,
    default: null
  },
  // Temporary tokens
  resetPasswordToken: {
    type: String,
    default: null
  },
  resetPasswordExpires: {
    type: Date,
    default: null
  },
  moderationToken: {
    type: String,
    default: null
  },
  moderationTokenExpires: {
    type: Date,
    default: null
  }
});

// Hash password before saving
userSchema.pre('save', async function (next) {
  if (!this.isModified('password')) return next();
  console.log('Hashing password for user:', this.nickname);
  try {
    const salt = await bcrypt.genSalt(12);
    console.log('Salt generated:', salt);
    this.password = await bcrypt.hash(this.password, salt);
    console.log('Password hashed successfully');
    next();
  } catch (error) {
    console.error('Error hashing password:', error.message);
    next(error);
  }
});

// Compare password method
userSchema.methods.comparePassword = async function (candidatePassword) {
  return bcrypt.compare(candidatePassword, this.password);
};

// Generate reset password token
userSchema.methods.generateResetToken = function () {
  // Generate random token
  const resetToken = crypto.randomBytes(32).toString('hex');

  // Hash token before storing
  this.resetPasswordToken = crypto.createHash('sha256').update(resetToken).digest('hex');

  // Set expiration (1 hour from now)
  this.resetPasswordExpires = Date.now() + 60 * 60 * 1000; // 1 hour

  return resetToken;
};

// Reset password using token
userSchema.methods.resetPassword = function (token, newPassword) {
  const hashedToken = crypto.createHash('sha256').update(token).digest('hex');
  if (hashedToken !== this.resetPasswordToken) {
    throw new Error('Invalid or expired password reset token');
  }
  if (Date.now() > this.resetPasswordExpires) {
    throw new Error('Password reset token has expired');
  }
  this.password = newPassword;
  this.resetPasswordToken = null;
  this.resetPasswordExpires = null;
  return this.save();
};

// Ban user
userSchema.methods.ban = function (reason, duration = null, _issuedBy = null) {
  this.banned = true;
  this.banReason = reason;
  if (duration) {
    this.banExpires = new Date(Date.now() + duration);
  } else {
    this.banExpires = null; // permanent ban
  }
  return this.save();
};

// Unban user
userSchema.methods.unban = function () {
  this.banned = false;
  this.banReason = null;
  this.banExpires = null;
  return this.save();
};

// Check if user is banned and if ban is active
userSchema.methods.isBanned = function () {
  if (!this.banned) return false;
  if (!this.banExpires) return true; // permanent ban
  return this.banExpires > new Date(); // temporary ban still active
};

// Add warning to user
userSchema.methods.warn = function (reason, issuedBy, duration = null) {
  const warning = {
    reason: reason,
    issuedBy: issuedBy,
    issuedAt: new Date(),
    expires: duration ? new Date(Date.now() + duration) : null
  };
  this.warnings.push(warning);
  return this.save();
};

// Remove expired warnings
userSchema.methods.cleanWarnings = function () {
  this.warnings = this.warnings.filter(warning => {
    return !warning.expires || warning.expires > new Date();
  });
  return this.save();
};

// Get active warnings count
userSchema.methods.getActiveWarningsCount = function () {
  this.cleanWarnings();
  return this.warnings.length;
};

// Mute user (for chat)
userSchema.methods.mute = function (duration = 3600000) {
  // default 1 hour
  this.muteExpires = new Date(Date.now() + duration);
  return this.save();
};

// Unmute user
userSchema.methods.unmute = function () {
  this.muteExpires = null;
  return this.save();
};

// Check if user is muted
userSchema.methods.isMuted = function () {
  return this.muteExpires && this.muteExpires > new Date();
};

// Generate moderation token for admin actions
userSchema.methods.generateModerationToken = function () {
  const moderationToken = crypto.randomBytes(32).toString('hex');
  this.moderationToken = crypto.createHash('sha256').update(moderationToken).digest('hex');
  this.moderationTokenExpires = Date.now() + 3600000; // 1 hour
  return this.save().then(() => moderationToken);
};

// Verify moderation token
userSchema.methods.verifyModerationToken = function (token) {
  const hashedToken = crypto.createHash('sha256').update(token).digest('hex');
  if (hashedToken !== this.moderationToken) {
    throw new Error('Invalid moderation token');
  }
  if (Date.now() > this.moderationTokenExpires) {
    throw new Error('Moderation token expired');
  }
  this.moderationToken = null;
  this.moderationTokenExpires = null;
  return this.save();
};

// Check if user has moderator/admin permissions
userSchema.methods.hasModeratorPrivileges = function () {
  return this.role === 'admin' || this.role === 'moderator';
};
userSchema.methods.hasAdminPrivileges = function () {
  return this.role === 'admin';
};

// Remove password and sensitive data from JSON output
userSchema.methods.toJSON = function () {
  const userObject = this.toObject();
  delete userObject.password;
  delete userObject.resetPasswordToken;
  delete userObject.resetPasswordExpires;
  delete userObject.moderationToken;
  delete userObject.moderationTokenExpires;
  // Don't show ban details to regular users
  if (!this.hasModeratorPrivileges()) {
    delete userObject.banReason;
    delete userObject.banExpires;
    delete userObject.warnings;
  }
  return userObject;
};

// Prevent OverwriteModelError by checking existing models
module.exports = mongoose.models.User || mongoose.model('User', userSchema);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJtb25nb29zZSIsInJlcXVpcmUiLCJiY3J5cHQiLCJjcnlwdG8iLCJ1c2VyU2NoZW1hIiwiU2NoZW1hIiwibmlja25hbWUiLCJ0eXBlIiwiU3RyaW5nIiwicmVxdWlyZWQiLCJ1bmlxdWUiLCJ0cmltIiwibWlubGVuZ3RoIiwibWF4bGVuZ3RoIiwiaW5kZXgiLCJlbWFpbCIsImxvd2VyY2FzZSIsInBhc3N3b3JkIiwicm9sZSIsImVudW0iLCJkZWZhdWx0IiwiY3JlYXRlZEF0IiwiRGF0ZSIsIm5vdyIsImxhc3RBY3RpdmUiLCJzdGF0dXMiLCJiYW5uZWQiLCJCb29sZWFuIiwiYmFuUmVhc29uIiwiYmFuRXhwaXJlcyIsIndhcm5pbmdzIiwicmVhc29uIiwiaXNzdWVkQnkiLCJUeXBlcyIsIk9iamVjdElkIiwicmVmIiwiaXNzdWVkQXQiLCJleHBpcmVzIiwibXV0ZUV4cGlyZXMiLCJyZXNldFBhc3N3b3JkVG9rZW4iLCJyZXNldFBhc3N3b3JkRXhwaXJlcyIsIm1vZGVyYXRpb25Ub2tlbiIsIm1vZGVyYXRpb25Ub2tlbkV4cGlyZXMiLCJwcmUiLCJuZXh0IiwiaXNNb2RpZmllZCIsImNvbnNvbGUiLCJsb2ciLCJzYWx0IiwiZ2VuU2FsdCIsImhhc2giLCJlcnJvciIsIm1lc3NhZ2UiLCJtZXRob2RzIiwiY29tcGFyZVBhc3N3b3JkIiwiY2FuZGlkYXRlUGFzc3dvcmQiLCJjb21wYXJlIiwiZ2VuZXJhdGVSZXNldFRva2VuIiwicmVzZXRUb2tlbiIsInJhbmRvbUJ5dGVzIiwidG9TdHJpbmciLCJjcmVhdGVIYXNoIiwidXBkYXRlIiwiZGlnZXN0IiwicmVzZXRQYXNzd29yZCIsInRva2VuIiwibmV3UGFzc3dvcmQiLCJoYXNoZWRUb2tlbiIsIkVycm9yIiwic2F2ZSIsImJhbiIsImR1cmF0aW9uIiwiX2lzc3VlZEJ5IiwidW5iYW4iLCJpc0Jhbm5lZCIsIndhcm4iLCJ3YXJuaW5nIiwicHVzaCIsImNsZWFuV2FybmluZ3MiLCJmaWx0ZXIiLCJnZXRBY3RpdmVXYXJuaW5nc0NvdW50IiwibGVuZ3RoIiwibXV0ZSIsInVubXV0ZSIsImlzTXV0ZWQiLCJnZW5lcmF0ZU1vZGVyYXRpb25Ub2tlbiIsInRoZW4iLCJ2ZXJpZnlNb2RlcmF0aW9uVG9rZW4iLCJoYXNNb2RlcmF0b3JQcml2aWxlZ2VzIiwiaGFzQWRtaW5Qcml2aWxlZ2VzIiwidG9KU09OIiwidXNlck9iamVjdCIsInRvT2JqZWN0IiwibW9kdWxlIiwiZXhwb3J0cyIsIm1vZGVscyIsIlVzZXIiLCJtb2RlbCJdLCJzb3VyY2VzIjpbIlVzZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgbW9uZ29vc2UgPSByZXF1aXJlKCdtb25nb29zZScpO1xuY29uc3QgYmNyeXB0ID0gcmVxdWlyZSgnYmNyeXB0anMnKTtcbmNvbnN0IGNyeXB0byA9IHJlcXVpcmUoJ2NyeXB0bycpO1xuXG5jb25zdCB1c2VyU2NoZW1hID0gbmV3IG1vbmdvb3NlLlNjaGVtYSh7XG4gIG5pY2tuYW1lOiB7XG4gICAgdHlwZTogU3RyaW5nLFxuICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIHVuaXF1ZTogdHJ1ZSxcbiAgICB0cmltOiB0cnVlLFxuICAgIG1pbmxlbmd0aDogMyxcbiAgICBtYXhsZW5ndGg6IDUwLFxuICAgIGluZGV4OiB0cnVlIC8vIFJlbW92ZSBkdXBsaWNhdGUgaW5kZXggY2FsbCBiZWxvd1xuICB9LFxuICBlbWFpbDoge1xuICAgIHR5cGU6IFN0cmluZyxcbiAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICB1bmlxdWU6IHRydWUsXG4gICAgbG93ZXJjYXNlOiB0cnVlLFxuICAgIHRyaW06IHRydWUsXG4gICAgaW5kZXg6IHRydWUgLy8gUmVtb3ZlIGR1cGxpY2F0ZSBpbmRleCBjYWxsIGJlbG93XG4gIH0sXG4gIHBhc3N3b3JkOiB7XG4gICAgdHlwZTogU3RyaW5nLFxuICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIG1pbmxlbmd0aDogNlxuICB9LFxuICByb2xlOiB7XG4gICAgdHlwZTogU3RyaW5nLFxuICAgIGVudW06IFsnYWRtaW4nLCAnbW9kZXJhdG9yJywgJ21lbWJlciddLFxuICAgIGRlZmF1bHQ6ICdtZW1iZXInXG4gIH0sXG4gIGNyZWF0ZWRBdDoge1xuICAgIHR5cGU6IERhdGUsXG4gICAgZGVmYXVsdDogRGF0ZS5ub3dcbiAgfSxcbiAgbGFzdEFjdGl2ZToge1xuICAgIHR5cGU6IERhdGUsXG4gICAgZGVmYXVsdDogRGF0ZS5ub3dcbiAgfSxcbiAgc3RhdHVzOiB7XG4gICAgdHlwZTogU3RyaW5nLFxuICAgIGVudW06IFsnb25saW5lJywgJ29mZmxpbmUnXSxcbiAgICBkZWZhdWx0OiAnb2ZmbGluZSdcbiAgfSxcbiAgLy8gTW9kZXJhdGlvbiBmaWVsZHNcbiAgYmFubmVkOiB7XG4gICAgdHlwZTogQm9vbGVhbixcbiAgICBkZWZhdWx0OiBmYWxzZVxuICB9LFxuICBiYW5SZWFzb246IHtcbiAgICB0eXBlOiBTdHJpbmcsXG4gICAgZGVmYXVsdDogbnVsbFxuICB9LFxuICBiYW5FeHBpcmVzOiB7XG4gICAgdHlwZTogRGF0ZSxcbiAgICBkZWZhdWx0OiBudWxsXG4gIH0sXG4gIHdhcm5pbmdzOiBbe1xuICAgIHJlYXNvbjogU3RyaW5nLFxuICAgIGlzc3VlZEJ5OiB7IHR5cGU6IG1vbmdvb3NlLlNjaGVtYS5UeXBlcy5PYmplY3RJZCwgcmVmOiAnVXNlcicgfSxcbiAgICBpc3N1ZWRBdDogeyB0eXBlOiBEYXRlLCBkZWZhdWx0OiBEYXRlLm5vdyB9LFxuICAgIGV4cGlyZXM6IERhdGVcbiAgfV0sXG4gIG11dGVFeHBpcmVzOiB7XG4gICAgdHlwZTogRGF0ZSxcbiAgICBkZWZhdWx0OiBudWxsXG4gIH0sXG4gIC8vIFRlbXBvcmFyeSB0b2tlbnNcbiAgcmVzZXRQYXNzd29yZFRva2VuOiB7XG4gICAgdHlwZTogU3RyaW5nLFxuICAgIGRlZmF1bHQ6IG51bGxcbiAgfSxcbiAgcmVzZXRQYXNzd29yZEV4cGlyZXM6IHtcbiAgICB0eXBlOiBEYXRlLFxuICAgIGRlZmF1bHQ6IG51bGxcbiAgfSxcbiAgbW9kZXJhdGlvblRva2VuOiB7XG4gICAgdHlwZTogU3RyaW5nLFxuICAgIGRlZmF1bHQ6IG51bGxcbiAgfSxcbiAgbW9kZXJhdGlvblRva2VuRXhwaXJlczoge1xuICAgIHR5cGU6IERhdGUsXG4gICAgZGVmYXVsdDogbnVsbFxuICB9XG59KTtcblxuLy8gSGFzaCBwYXNzd29yZCBiZWZvcmUgc2F2aW5nXG51c2VyU2NoZW1hLnByZSgnc2F2ZScsIGFzeW5jIGZ1bmN0aW9uKG5leHQpIHtcbiAgIGlmICghdGhpcy5pc01vZGlmaWVkKCdwYXNzd29yZCcpKSByZXR1cm4gbmV4dCgpO1xuXG4gICBjb25zb2xlLmxvZygnSGFzaGluZyBwYXNzd29yZCBmb3IgdXNlcjonLCB0aGlzLm5pY2tuYW1lKTtcbiAgIHRyeSB7XG4gICAgIGNvbnN0IHNhbHQgPSBhd2FpdCBiY3J5cHQuZ2VuU2FsdCgxMik7XG4gICAgIGNvbnNvbGUubG9nKCdTYWx0IGdlbmVyYXRlZDonLCBzYWx0KTtcbiAgICAgdGhpcy5wYXNzd29yZCA9IGF3YWl0IGJjcnlwdC5oYXNoKHRoaXMucGFzc3dvcmQsIHNhbHQpO1xuICAgICBjb25zb2xlLmxvZygnUGFzc3dvcmQgaGFzaGVkIHN1Y2Nlc3NmdWxseScpO1xuICAgICBuZXh0KCk7XG4gICB9IGNhdGNoIChlcnJvcikge1xuICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBoYXNoaW5nIHBhc3N3b3JkOicsIGVycm9yLm1lc3NhZ2UpO1xuICAgICBuZXh0KGVycm9yKTtcbiAgIH1cbiB9KTtcblxuLy8gQ29tcGFyZSBwYXNzd29yZCBtZXRob2RcbnVzZXJTY2hlbWEubWV0aG9kcy5jb21wYXJlUGFzc3dvcmQgPSBhc3luYyBmdW5jdGlvbihjYW5kaWRhdGVQYXNzd29yZCkge1xuICByZXR1cm4gYmNyeXB0LmNvbXBhcmUoY2FuZGlkYXRlUGFzc3dvcmQsIHRoaXMucGFzc3dvcmQpO1xufTtcblxuLy8gR2VuZXJhdGUgcmVzZXQgcGFzc3dvcmQgdG9rZW5cbnVzZXJTY2hlbWEubWV0aG9kcy5nZW5lcmF0ZVJlc2V0VG9rZW4gPSBmdW5jdGlvbigpIHtcbiAgLy8gR2VuZXJhdGUgcmFuZG9tIHRva2VuXG4gIGNvbnN0IHJlc2V0VG9rZW4gPSBjcnlwdG8ucmFuZG9tQnl0ZXMoMzIpLnRvU3RyaW5nKCdoZXgnKTtcblxuICAvLyBIYXNoIHRva2VuIGJlZm9yZSBzdG9yaW5nXG4gIHRoaXMucmVzZXRQYXNzd29yZFRva2VuID0gY3J5cHRvXG4gICAgLmNyZWF0ZUhhc2goJ3NoYTI1NicpXG4gICAgLnVwZGF0ZShyZXNldFRva2VuKVxuICAgIC5kaWdlc3QoJ2hleCcpO1xuXG4gIC8vIFNldCBleHBpcmF0aW9uICgxIGhvdXIgZnJvbSBub3cpXG4gIHRoaXMucmVzZXRQYXNzd29yZEV4cGlyZXMgPSBEYXRlLm5vdygpICsgNjAgKiA2MCAqIDEwMDA7IC8vIDEgaG91clxuXG4gIHJldHVybiByZXNldFRva2VuO1xufTtcblxuLy8gUmVzZXQgcGFzc3dvcmQgdXNpbmcgdG9rZW5cbnVzZXJTY2hlbWEubWV0aG9kcy5yZXNldFBhc3N3b3JkID0gZnVuY3Rpb24odG9rZW4sIG5ld1Bhc3N3b3JkKSB7XG4gIGNvbnN0IGhhc2hlZFRva2VuID0gY3J5cHRvXG4gICAgLmNyZWF0ZUhhc2goJ3NoYTI1NicpXG4gICAgLnVwZGF0ZSh0b2tlbilcbiAgICAuZGlnZXN0KCdoZXgnKTtcblxuICBpZiAoaGFzaGVkVG9rZW4gIT09IHRoaXMucmVzZXRQYXNzd29yZFRva2VuKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIG9yIGV4cGlyZWQgcGFzc3dvcmQgcmVzZXQgdG9rZW4nKTtcbiAgfVxuXG4gIGlmIChEYXRlLm5vdygpID4gdGhpcy5yZXNldFBhc3N3b3JkRXhwaXJlcykge1xuICAgIHRocm93IG5ldyBFcnJvcignUGFzc3dvcmQgcmVzZXQgdG9rZW4gaGFzIGV4cGlyZWQnKTtcbiAgfVxuXG4gIHRoaXMucGFzc3dvcmQgPSBuZXdQYXNzd29yZDtcbiAgdGhpcy5yZXNldFBhc3N3b3JkVG9rZW4gPSBudWxsO1xuICB0aGlzLnJlc2V0UGFzc3dvcmRFeHBpcmVzID0gbnVsbDtcblxuICByZXR1cm4gdGhpcy5zYXZlKCk7XG59O1xuXG4vLyBCYW4gdXNlclxudXNlclNjaGVtYS5tZXRob2RzLmJhbiA9IGZ1bmN0aW9uKHJlYXNvbiwgZHVyYXRpb24gPSBudWxsLCBfaXNzdWVkQnkgPSBudWxsKSB7XG4gIHRoaXMuYmFubmVkID0gdHJ1ZTtcbiAgdGhpcy5iYW5SZWFzb24gPSByZWFzb247XG4gIGlmIChkdXJhdGlvbikge1xuICAgIHRoaXMuYmFuRXhwaXJlcyA9IG5ldyBEYXRlKERhdGUubm93KCkgKyBkdXJhdGlvbik7XG4gIH0gZWxzZSB7XG4gICAgdGhpcy5iYW5FeHBpcmVzID0gbnVsbDsgLy8gcGVybWFuZW50IGJhblxuICB9XG4gIHJldHVybiB0aGlzLnNhdmUoKTtcbn07XG5cbi8vIFVuYmFuIHVzZXJcbnVzZXJTY2hlbWEubWV0aG9kcy51bmJhbiA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLmJhbm5lZCA9IGZhbHNlO1xuICB0aGlzLmJhblJlYXNvbiA9IG51bGw7XG4gIHRoaXMuYmFuRXhwaXJlcyA9IG51bGw7XG4gIHJldHVybiB0aGlzLnNhdmUoKTtcbn07XG5cbi8vIENoZWNrIGlmIHVzZXIgaXMgYmFubmVkIGFuZCBpZiBiYW4gaXMgYWN0aXZlXG51c2VyU2NoZW1hLm1ldGhvZHMuaXNCYW5uZWQgPSBmdW5jdGlvbigpIHtcbiAgaWYgKCF0aGlzLmJhbm5lZCkgcmV0dXJuIGZhbHNlO1xuICBpZiAoIXRoaXMuYmFuRXhwaXJlcykgcmV0dXJuIHRydWU7IC8vIHBlcm1hbmVudCBiYW5cbiAgcmV0dXJuIHRoaXMuYmFuRXhwaXJlcyA+IG5ldyBEYXRlKCk7IC8vIHRlbXBvcmFyeSBiYW4gc3RpbGwgYWN0aXZlXG59O1xuXG4vLyBBZGQgd2FybmluZyB0byB1c2VyXG51c2VyU2NoZW1hLm1ldGhvZHMud2FybiA9IGZ1bmN0aW9uKHJlYXNvbiwgaXNzdWVkQnksIGR1cmF0aW9uID0gbnVsbCkge1xuICBjb25zdCB3YXJuaW5nID0ge1xuICAgIHJlYXNvbjogcmVhc29uLFxuICAgIGlzc3VlZEJ5OiBpc3N1ZWRCeSxcbiAgICBpc3N1ZWRBdDogbmV3IERhdGUoKSxcbiAgICBleHBpcmVzOiBkdXJhdGlvbiA/IG5ldyBEYXRlKERhdGUubm93KCkgKyBkdXJhdGlvbikgOiBudWxsXG4gIH07XG4gIHRoaXMud2FybmluZ3MucHVzaCh3YXJuaW5nKTtcbiAgcmV0dXJuIHRoaXMuc2F2ZSgpO1xufTtcblxuLy8gUmVtb3ZlIGV4cGlyZWQgd2FybmluZ3NcbnVzZXJTY2hlbWEubWV0aG9kcy5jbGVhbldhcm5pbmdzID0gZnVuY3Rpb24oKSB7XG4gIHRoaXMud2FybmluZ3MgPSB0aGlzLndhcm5pbmdzLmZpbHRlcih3YXJuaW5nID0+IHtcbiAgICByZXR1cm4gIXdhcm5pbmcuZXhwaXJlcyB8fCB3YXJuaW5nLmV4cGlyZXMgPiBuZXcgRGF0ZSgpO1xuICB9KTtcbiAgcmV0dXJuIHRoaXMuc2F2ZSgpO1xufTtcblxuLy8gR2V0IGFjdGl2ZSB3YXJuaW5ncyBjb3VudFxudXNlclNjaGVtYS5tZXRob2RzLmdldEFjdGl2ZVdhcm5pbmdzQ291bnQgPSBmdW5jdGlvbigpIHtcbiAgdGhpcy5jbGVhbldhcm5pbmdzKCk7XG4gIHJldHVybiB0aGlzLndhcm5pbmdzLmxlbmd0aDtcbn07XG5cbi8vIE11dGUgdXNlciAoZm9yIGNoYXQpXG51c2VyU2NoZW1hLm1ldGhvZHMubXV0ZSA9IGZ1bmN0aW9uKGR1cmF0aW9uID0gMzYwMDAwMCkgeyAvLyBkZWZhdWx0IDEgaG91clxuICB0aGlzLm11dGVFeHBpcmVzID0gbmV3IERhdGUoRGF0ZS5ub3coKSArIGR1cmF0aW9uKTtcbiAgcmV0dXJuIHRoaXMuc2F2ZSgpO1xufTtcblxuLy8gVW5tdXRlIHVzZXJcbnVzZXJTY2hlbWEubWV0aG9kcy51bm11dGUgPSBmdW5jdGlvbigpIHtcbiAgdGhpcy5tdXRlRXhwaXJlcyA9IG51bGw7XG4gIHJldHVybiB0aGlzLnNhdmUoKTtcbn07XG5cbi8vIENoZWNrIGlmIHVzZXIgaXMgbXV0ZWRcbnVzZXJTY2hlbWEubWV0aG9kcy5pc011dGVkID0gZnVuY3Rpb24oKSB7XG4gIHJldHVybiB0aGlzLm11dGVFeHBpcmVzICYmIHRoaXMubXV0ZUV4cGlyZXMgPiBuZXcgRGF0ZSgpO1xufTtcblxuLy8gR2VuZXJhdGUgbW9kZXJhdGlvbiB0b2tlbiBmb3IgYWRtaW4gYWN0aW9uc1xudXNlclNjaGVtYS5tZXRob2RzLmdlbmVyYXRlTW9kZXJhdGlvblRva2VuID0gZnVuY3Rpb24oKSB7XG4gIGNvbnN0IG1vZGVyYXRpb25Ub2tlbiA9IGNyeXB0by5yYW5kb21CeXRlcygzMikudG9TdHJpbmcoJ2hleCcpO1xuICB0aGlzLm1vZGVyYXRpb25Ub2tlbiA9IGNyeXB0b1xuICAgIC5jcmVhdGVIYXNoKCdzaGEyNTYnKVxuICAgIC51cGRhdGUobW9kZXJhdGlvblRva2VuKVxuICAgIC5kaWdlc3QoJ2hleCcpO1xuICB0aGlzLm1vZGVyYXRpb25Ub2tlbkV4cGlyZXMgPSBEYXRlLm5vdygpICsgMzYwMDAwMDsgLy8gMSBob3VyXG4gIHJldHVybiB0aGlzLnNhdmUoKS50aGVuKCgpID0+IG1vZGVyYXRpb25Ub2tlbik7XG59O1xuXG4vLyBWZXJpZnkgbW9kZXJhdGlvbiB0b2tlblxudXNlclNjaGVtYS5tZXRob2RzLnZlcmlmeU1vZGVyYXRpb25Ub2tlbiA9IGZ1bmN0aW9uKHRva2VuKSB7XG4gIGNvbnN0IGhhc2hlZFRva2VuID0gY3J5cHRvXG4gICAgLmNyZWF0ZUhhc2goJ3NoYTI1NicpXG4gICAgLnVwZGF0ZSh0b2tlbilcbiAgICAuZGlnZXN0KCdoZXgnKTtcblxuICBpZiAoaGFzaGVkVG9rZW4gIT09IHRoaXMubW9kZXJhdGlvblRva2VuKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIG1vZGVyYXRpb24gdG9rZW4nKTtcbiAgfVxuXG4gIGlmIChEYXRlLm5vdygpID4gdGhpcy5tb2RlcmF0aW9uVG9rZW5FeHBpcmVzKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdNb2RlcmF0aW9uIHRva2VuIGV4cGlyZWQnKTtcbiAgfVxuXG4gIHRoaXMubW9kZXJhdGlvblRva2VuID0gbnVsbDtcbiAgdGhpcy5tb2RlcmF0aW9uVG9rZW5FeHBpcmVzID0gbnVsbDtcbiAgcmV0dXJuIHRoaXMuc2F2ZSgpO1xufTtcblxuLy8gQ2hlY2sgaWYgdXNlciBoYXMgbW9kZXJhdG9yL2FkbWluIHBlcm1pc3Npb25zXG51c2VyU2NoZW1hLm1ldGhvZHMuaGFzTW9kZXJhdG9yUHJpdmlsZWdlcyA9IGZ1bmN0aW9uKCkge1xuICByZXR1cm4gdGhpcy5yb2xlID09PSAnYWRtaW4nIHx8IHRoaXMucm9sZSA9PT0gJ21vZGVyYXRvcic7XG59O1xuXG51c2VyU2NoZW1hLm1ldGhvZHMuaGFzQWRtaW5Qcml2aWxlZ2VzID0gZnVuY3Rpb24oKSB7XG4gIHJldHVybiB0aGlzLnJvbGUgPT09ICdhZG1pbic7XG59O1xuXG4vLyBSZW1vdmUgcGFzc3dvcmQgYW5kIHNlbnNpdGl2ZSBkYXRhIGZyb20gSlNPTiBvdXRwdXRcbnVzZXJTY2hlbWEubWV0aG9kcy50b0pTT04gPSBmdW5jdGlvbigpIHtcbiAgY29uc3QgdXNlck9iamVjdCA9IHRoaXMudG9PYmplY3QoKTtcbiAgZGVsZXRlIHVzZXJPYmplY3QucGFzc3dvcmQ7XG4gIGRlbGV0ZSB1c2VyT2JqZWN0LnJlc2V0UGFzc3dvcmRUb2tlbjtcbiAgZGVsZXRlIHVzZXJPYmplY3QucmVzZXRQYXNzd29yZEV4cGlyZXM7XG4gIGRlbGV0ZSB1c2VyT2JqZWN0Lm1vZGVyYXRpb25Ub2tlbjtcbiAgZGVsZXRlIHVzZXJPYmplY3QubW9kZXJhdGlvblRva2VuRXhwaXJlcztcbiAgLy8gRG9uJ3Qgc2hvdyBiYW4gZGV0YWlscyB0byByZWd1bGFyIHVzZXJzXG4gIGlmICghdGhpcy5oYXNNb2RlcmF0b3JQcml2aWxlZ2VzKCkpIHtcbiAgICBkZWxldGUgdXNlck9iamVjdC5iYW5SZWFzb247XG4gICAgZGVsZXRlIHVzZXJPYmplY3QuYmFuRXhwaXJlcztcbiAgICBkZWxldGUgdXNlck9iamVjdC53YXJuaW5ncztcbiAgfVxuICByZXR1cm4gdXNlck9iamVjdDtcbn07XG5cbi8vIFByZXZlbnQgT3ZlcndyaXRlTW9kZWxFcnJvciBieSBjaGVja2luZyBleGlzdGluZyBtb2RlbHNcbm1vZHVsZS5leHBvcnRzID0gbW9uZ29vc2UubW9kZWxzLlVzZXIgfHwgbW9uZ29vc2UubW9kZWwoJ1VzZXInLCB1c2VyU2NoZW1hKTsiXSwibWFwcGluZ3MiOiJBQUFBLE1BQU1BLFFBQVEsR0FBR0MsT0FBTyxDQUFDLFVBQVUsQ0FBQztBQUNwQyxNQUFNQyxNQUFNLEdBQUdELE9BQU8sQ0FBQyxVQUFVLENBQUM7QUFDbEMsTUFBTUUsTUFBTSxHQUFHRixPQUFPLENBQUMsUUFBUSxDQUFDO0FBRWhDLE1BQU1HLFVBQVUsR0FBRyxJQUFJSixRQUFRLENBQUNLLE1BQU0sQ0FBQztFQUNyQ0MsUUFBUSxFQUFFO0lBQ1JDLElBQUksRUFBRUMsTUFBTTtJQUNaQyxRQUFRLEVBQUUsSUFBSTtJQUNkQyxNQUFNLEVBQUUsSUFBSTtJQUNaQyxJQUFJLEVBQUUsSUFBSTtJQUNWQyxTQUFTLEVBQUUsQ0FBQztJQUNaQyxTQUFTLEVBQUUsRUFBRTtJQUNiQyxLQUFLLEVBQUUsSUFBSSxDQUFDO0VBQ2QsQ0FBQztFQUNEQyxLQUFLLEVBQUU7SUFDTFIsSUFBSSxFQUFFQyxNQUFNO0lBQ1pDLFFBQVEsRUFBRSxJQUFJO0lBQ2RDLE1BQU0sRUFBRSxJQUFJO0lBQ1pNLFNBQVMsRUFBRSxJQUFJO0lBQ2ZMLElBQUksRUFBRSxJQUFJO0lBQ1ZHLEtBQUssRUFBRSxJQUFJLENBQUM7RUFDZCxDQUFDO0VBQ0RHLFFBQVEsRUFBRTtJQUNSVixJQUFJLEVBQUVDLE1BQU07SUFDWkMsUUFBUSxFQUFFLElBQUk7SUFDZEcsU0FBUyxFQUFFO0VBQ2IsQ0FBQztFQUNETSxJQUFJLEVBQUU7SUFDSlgsSUFBSSxFQUFFQyxNQUFNO0lBQ1pXLElBQUksRUFBRSxDQUFDLE9BQU8sRUFB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