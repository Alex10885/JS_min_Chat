d5593ee2a5b88b213291ea00a2cd76bf
const jwt = require('jsonwebtoken');
const winston = require('winston');
const config = require('../config');
const User = require('../models/User');
const logger = winston.createLogger({
  level: config.logger.level,
  format: winston.format.combine(winston.format.timestamp(), winston.format.errors({
    stack: true
  }), winston.format.json()),
  defaultMeta: {
    service: 'chat-server-auth'
  },
  transports: [new winston.transports.File({
    filename: 'logs/server.log'
  }), new winston.transports.Console({
    format: winston.format.combine(winston.format.colorize(), winston.format.simple())
  })]
});

// Session authentication middleware (works parallel to JWT)
const authenticateSession = async (req, res, next) => {
  try {
    console.log('ðŸ” Session authentication middleware called:', {
      url: req.url,
      method: req.method,
      sessionId: req.sessionID,
      sessionExists: !!req.session,
      sessionData: req.session ? {
        authenticated: req.session.authenticated,
        userId: req.session.userId,
        nickname: req.session.nickname,
        role: req.session.role,
        loginTime: req.session.loginTime,
        csrfToken: req.session.csrfToken?.substring(0, 8) + '...'
      } : null
    });

    // Check if session exists and has authenticated user
    if (req.session && req.session.authenticated && req.session.userId) {
      console.log('ðŸŽ¯ Found authenticated session for userId:', req.session.userId);
      console.log('ðŸ”“ Session fingerprint check:', {
        sid: req.sessionID,
        csrfToken: req.session.csrfToken?.substring(0, 4) + '...',
        userAgent: req.session.userAgent?.substring(0, 20) + '...',
        loginTime: req.session.loginTime
      });
      const user = await User.findById(req.session.userId);
      if (user) {
        console.log('âœ… Session user found in DB:', {
          nickname: user.nickname,
          id: user._id,
          status: user.status,
          sessionValid: true
        });
        req.sessionUser = user; // Store in req.sessionUser to avoid conflict with JWT req.user

        // Update session fingerprint if needed
        if (req.session.csrfToken && req.session.userAgent) {
          req.session.lastSessionCheck = new Date().toISOString();
          console.log('ðŸ” Session fingerprint verified and updated');
        }
      } else {
        console.log('âš ï¸ Session user not found in DB, cleaning session:', req.session.userId);
        // Clean invalid session
        delete req.session.authenticated;
        delete req.session.userId;
        delete req.session.nickname;
        delete req.session.role;
      }
    } else {
      console.log('ðŸ” No authenticated session found or session not initialized', {
        sessionId: req.sessionID,
        session: !!req.session,
        authenticated: req.session?.authenticated,
        userId: req.session?.userId
      });
      req.sessionUser = null; // Explicitly set to null when no session
    }
    next();
  } catch (error) {
    logger.warn('Session authentication error:', {
      error: error.message,
      sessionId: req.sessionID,
      ip: req.ip
    });
    req.sessionUser = null; // Set to null on error
    next();
  }
};

// JWT authentication middleware
const authenticateToken = async (req, res, next) => {
  try {
    console.log('ðŸ” JWT authentication middleware called:', {
      url: req.url,
      method: req.method
    });
    const authHeader = req.headers['authorization'];
    const token = authHeader && authHeader.split(' ')[1]; // Bearer TOKEN

    console.log('ðŸ”‘ Token extraction result:', {
      hasAuthHeader: !!authHeader,
      hasToken: !!token
    });
    if (!token) {
      console.log('âŒ No token provided');
      return res.status(401).json({
        error: 'Access token required',
        code: 'NO_TOKEN'
      });
    }
    const decoded = jwt.verify(token, config.security.jwtSecret);
    console.log('âœ… JWT decoded:', {
      userId: decoded.userId,
      nickname: decoded.nickname
    });
    const user = await User.findById(decoded.userId);
    if (!user) {
      console.log('âŒ User not found in DB for JWT userId:', decoded.userId);
      return res.status(401).json({
        error: 'User not found',
        code: 'USER_NOT_FOUND'
      });
    }
    req.user = user;
    console.log('âœ… JWT authentication successful for user:', user.nickname, {
      id: user._id,
      status: user.status
    });
    next();
  } catch (error) {
    logger.warn('JWT authentication failed:', {
      error: error.message,
      ip: req.ip
    });
    if (error.name === 'JsonWebTokenError') {
      return res.status(401).json({
        error: 'Invalid token format',
        code: 'INVALID_TOKEN_FORMAT'
      });
    }
    if (error.name === 'TokenExpiredError') {
      return res.status(401).json({
        error: 'Token has expired',
        code: 'TOKEN_EXPIRED'
      });
    }
    return res.status(401).json({
      error: 'Token verification failed',
      code: 'TOKEN_VERIFICATION_FAILED'
    });
  }
};

// Role-based access control middleware
const requireModerator = async (req, res, next) => {
  try {
    if (!req.user) {
      return res.status(401).json({
        error: 'Authentication required',
        code: 'AUTH_REQUIRED'
      });
    }
    if (!req.user.hasModeratorPrivileges()) {
      return res.status(403).json({
        error: 'Moderator privileges required',
        code: 'MODERATOR_REQUIRED'
      });
    }
    next();
  } catch (error) {
    logger.error('Moderator check error:', error);
    res.status(500).json({
      error: 'Server error during authorization check',
      code: 'AUTH_CHECK_ERROR'
    });
  }
};
const requireAdmin = async (req, res, next) => {
  try {
    if (!req.user) {
      return res.status(401).json({
        error: 'Authentication required',
        code: 'AUTH_REQUIRED'
      });
    }
    if (!req.user.hasAdminPrivileges()) {
      return res.status(403).json({
        error: 'Administrator privileges required',
        code: 'ADMIN_REQUIRED'
      });
    }
    next();
  } catch (error) {
    logger.error('Admin check error:', error);
    res.status(500).json({
      error: 'Server error during authorization check',
      code: 'AUTH_CHECK_ERROR'
    });
  }
};
module.exports = {
  authenticateSession,
  authenticateToken,
  requireModerator,
  requireAdmin,
  logger
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJqd3QiLCJyZXF1aXJlIiwid2luc3RvbiIsImNvbmZpZyIsIlVzZXIiLCJsb2dnZXIiLCJjcmVhdGVMb2dnZXIiLCJsZXZlbCIsImZvcm1hdCIsImNvbWJpbmUiLCJ0aW1lc3RhbXAiLCJlcnJvcnMiLCJzdGFjayIsImpzb24iLCJkZWZhdWx0TWV0YSIsInNlcnZpY2UiLCJ0cmFuc3BvcnRzIiwiRmlsZSIsImZpbGVuYW1lIiwiQ29uc29sZSIsImNvbG9yaXplIiwic2ltcGxlIiwiYXV0aGVudGljYXRlU2Vzc2lvbiIsInJlcSIsInJlcyIsIm5leHQiLCJjb25zb2xlIiwibG9nIiwidXJsIiwibWV0aG9kIiwic2Vzc2lvbklkIiwic2Vzc2lvbklEIiwic2Vzc2lvbkV4aXN0cyIsInNlc3Npb24iLCJzZXNzaW9uRGF0YSIsImF1dGhlbnRpY2F0ZWQiLCJ1c2VySWQiLCJuaWNrbmFtZSIsInJvbGUiLCJsb2dpblRpbWUiLCJjc3JmVG9rZW4iLCJzdWJzdHJpbmciLCJzaWQiLCJ1c2VyQWdlbnQiLCJ1c2VyIiwiZmluZEJ5SWQiLCJpZCIsIl9pZCIsInN0YXR1cyIsInNlc3Npb25WYWxpZCIsInNlc3Npb25Vc2VyIiwibGFzdFNlc3Npb25DaGVjayIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsImVycm9yIiwid2FybiIsIm1lc3NhZ2UiLCJpcCIsImF1dGhlbnRpY2F0ZVRva2VuIiwiYXV0aEhlYWRlciIsImhlYWRlcnMiLCJ0b2tlbiIsInNwbGl0IiwiaGFzQXV0aEhlYWRlciIsImhhc1Rva2VuIiwiY29kZSIsImRlY29kZWQiLCJ2ZXJpZnkiLCJzZWN1cml0eSIsImp3dFNlY3JldCIsIm5hbWUiLCJyZXF1aXJlTW9kZXJhdG9yIiwiaGFzTW9kZXJhdG9yUHJpdmlsZWdlcyIsInJlcXVpcmVBZG1pbiIsImhhc0FkbWluUHJpdmlsZWdlcyIsIm1vZHVsZSIsImV4cG9ydHMiXSwic291cmNlcyI6WyJhdXRoLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGp3dCA9IHJlcXVpcmUoJ2pzb253ZWJ0b2tlbicpO1xuY29uc3Qgd2luc3RvbiA9IHJlcXVpcmUoJ3dpbnN0b24nKTtcbmNvbnN0IGNvbmZpZyA9IHJlcXVpcmUoJy4uL2NvbmZpZycpO1xuY29uc3QgVXNlciA9IHJlcXVpcmUoJy4uL21vZGVscy9Vc2VyJyk7XG5cbmNvbnN0IGxvZ2dlciA9IHdpbnN0b24uY3JlYXRlTG9nZ2VyKHtcbiAgbGV2ZWw6IGNvbmZpZy5sb2dnZXIubGV2ZWwsXG4gIGZvcm1hdDogd2luc3Rvbi5mb3JtYXQuY29tYmluZShcbiAgICB3aW5zdG9uLmZvcm1hdC50aW1lc3RhbXAoKSxcbiAgICB3aW5zdG9uLmZvcm1hdC5lcnJvcnMoeyBzdGFjazogdHJ1ZSB9KSxcbiAgICB3aW5zdG9uLmZvcm1hdC5qc29uKClcbiAgKSxcbiAgZGVmYXVsdE1ldGE6IHsgc2VydmljZTogJ2NoYXQtc2VydmVyLWF1dGgnIH0sXG4gIHRyYW5zcG9ydHM6IFtcbiAgICBuZXcgd2luc3Rvbi50cmFuc3BvcnRzLkZpbGUoeyBmaWxlbmFtZTogJ2xvZ3Mvc2VydmVyLmxvZycgfSksXG4gICAgbmV3IHdpbnN0b24udHJhbnNwb3J0cy5Db25zb2xlKHtcbiAgICAgIGZvcm1hdDogd2luc3Rvbi5mb3JtYXQuY29tYmluZShcbiAgICAgICAgd2luc3Rvbi5mb3JtYXQuY29sb3JpemUoKSxcbiAgICAgICAgd2luc3Rvbi5mb3JtYXQuc2ltcGxlKClcbiAgICAgIClcbiAgICB9KVxuICBdXG59KTtcblxuLy8gU2Vzc2lvbiBhdXRoZW50aWNhdGlvbiBtaWRkbGV3YXJlICh3b3JrcyBwYXJhbGxlbCB0byBKV1QpXG5jb25zdCBhdXRoZW50aWNhdGVTZXNzaW9uID0gYXN5bmMgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gIHRyeSB7XG4gICAgY29uc29sZS5sb2coJ/CflJAgU2Vzc2lvbiBhdXRoZW50aWNhdGlvbiBtaWRkbGV3YXJlIGNhbGxlZDonLCB7XG4gICAgICB1cmw6IHJlcS51cmwsXG4gICAgICBtZXRob2Q6IHJlcS5tZXRob2QsXG4gICAgICBzZXNzaW9uSWQ6IHJlcS5zZXNzaW9uSUQsXG4gICAgICBzZXNzaW9uRXhpc3RzOiAhIXJlcS5zZXNzaW9uLFxuICAgICAgc2Vzc2lvbkRhdGE6IHJlcS5zZXNzaW9uID8ge1xuICAgICAgICBhdXRoZW50aWNhdGVkOiByZXEuc2Vzc2lvbi5hdXRoZW50aWNhdGVkLFxuICAgICAgICB1c2VySWQ6IHJlcS5zZXNzaW9uLnVzZXJJZCxcbiAgICAgICAgbmlja25hbWU6IHJlcS5zZXNzaW9uLm5pY2tuYW1lLFxuICAgICAgICByb2xlOiByZXEuc2Vzc2lvbi5yb2xlLFxuICAgICAgICBsb2dpblRpbWU6IHJlcS5zZXNzaW9uLmxvZ2luVGltZSxcbiAgICAgICAgY3NyZlRva2VuOiByZXEuc2Vzc2lvbi5jc3JmVG9rZW4/LnN1YnN0cmluZygwLCA4KSArICcuLi4nXG4gICAgICB9IDogbnVsbFxuICAgIH0pO1xuXG4gICAgLy8gQ2hlY2sgaWYgc2Vzc2lvbiBleGlzdHMgYW5kIGhhcyBhdXRoZW50aWNhdGVkIHVzZXJcbiAgICBpZiAocmVxLnNlc3Npb24gJiYgcmVxLnNlc3Npb24uYXV0aGVudGljYXRlZCAmJiByZXEuc2Vzc2lvbi51c2VySWQpIHtcbiAgICAgIGNvbnNvbGUubG9nKCfwn46vIEZvdW5kIGF1dGhlbnRpY2F0ZWQgc2Vzc2lvbiBmb3IgdXNlcklkOicsIHJlcS5zZXNzaW9uLnVzZXJJZCk7XG4gICAgICBjb25zb2xlLmxvZygn8J+UkyBTZXNzaW9uIGZpbmdlcnByaW50IGNoZWNrOicsIHtcbiAgICAgICAgc2lkOiByZXEuc2Vzc2lvbklELFxuICAgICAgICBjc3JmVG9rZW46IHJlcS5zZXNzaW9uLmNzcmZUb2tlbj8uc3Vic3RyaW5nKDAsIDQpICsgJy4uLicsXG4gICAgICAgIHVzZXJBZ2VudDogcmVxLnNlc3Npb24udXNlckFnZW50Py5zdWJzdHJpbmcoMCwgMjApICsgJy4uLicsXG4gICAgICAgIGxvZ2luVGltZTogcmVxLnNlc3Npb24ubG9naW5UaW1lXG4gICAgICB9KTtcblxuICAgICAgY29uc3QgdXNlciA9IGF3YWl0IFVzZXIuZmluZEJ5SWQocmVxLnNlc3Npb24udXNlcklkKTtcbiAgICAgIGlmICh1c2VyKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCfinIUgU2Vzc2lvbiB1c2VyIGZvdW5kIGluIERCOicsIHtcbiAgICAgICAgICBuaWNrbmFtZTogdXNlci5uaWNrbmFtZSxcbiAgICAgICAgICBpZDogdXNlci5faWQsXG4gICAgICAgICAgc3RhdHVzOiB1c2VyLnN0YXR1cyxcbiAgICAgICAgICBzZXNzaW9uVmFsaWQ6IHRydWVcbiAgICAgICAgfSk7XG4gICAgICAgIHJlcS5zZXNzaW9uVXNlciA9IHVzZXI7IC8vIFN0b3JlIGluIHJlcS5zZXNzaW9uVXNlciB0byBhdm9pZCBjb25mbGljdCB3aXRoIEpXVCByZXEudXNlclxuXG4gICAgICAgIC8vIFVwZGF0ZSBzZXNzaW9uIGZpbmdlcnByaW50IGlmIG5lZWRlZFxuICAgICAgICBpZiAocmVxLnNlc3Npb24uY3NyZlRva2VuICYmIHJlcS5zZXNzaW9uLnVzZXJBZ2VudCkge1xuICAgICAgICAgIHJlcS5zZXNzaW9uLmxhc3RTZXNzaW9uQ2hlY2sgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCk7XG4gICAgICAgICAgY29uc29sZS5sb2coJ/CflJAgU2Vzc2lvbiBmaW5nZXJwcmludCB2ZXJpZmllZCBhbmQgdXBkYXRlZCcpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zb2xlLmxvZygn4pqg77iPIFNlc3Npb24gdXNlciBub3QgZm91bmQgaW4gREIsIGNsZWFuaW5nIHNlc3Npb246JywgcmVxLnNlc3Npb24udXNlcklkKTtcbiAgICAgICAgLy8gQ2xlYW4gaW52YWxpZCBzZXNzaW9uXG4gICAgICAgIGRlbGV0ZSByZXEuc2Vzc2lvbi5hdXRoZW50aWNhdGVkO1xuICAgICAgICBkZWxldGUgcmVxLnNlc3Npb24udXNlcklkO1xuICAgICAgICBkZWxldGUgcmVxLnNlc3Npb24ubmlja25hbWU7XG4gICAgICAgIGRlbGV0ZSByZXEuc2Vzc2lvbi5yb2xlO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBjb25zb2xlLmxvZygn8J+UjSBObyBhdXRoZW50aWNhdGVkIHNlc3Npb24gZm91bmQgb3Igc2Vzc2lvbiBub3QgaW5pdGlhbGl6ZWQnLCB7XG4gICAgICAgIHNlc3Npb25JZDogcmVxLnNlc3Npb25JRCxcbiAgICAgICAgc2Vzc2lvbjogISFyZXEuc2Vzc2lvbixcbiAgICAgICAgYXV0aGVudGljYXRlZDogcmVxLnNlc3Npb24/LmF1dGhlbnRpY2F0ZWQsXG4gICAgICAgIHVzZXJJZDogcmVxLnNlc3Npb24/LnVzZXJJZFxuICAgICAgfSk7XG4gICAgICByZXEuc2Vzc2lvblVzZXIgPSBudWxsOyAvLyBFeHBsaWNpdGx5IHNldCB0byBudWxsIHdoZW4gbm8gc2Vzc2lvblxuICAgIH1cbiAgICBuZXh0KCk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgbG9nZ2VyLndhcm4oJ1Nlc3Npb24gYXV0aGVudGljYXRpb24gZXJyb3I6Jywge1xuICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2UsXG4gICAgICBzZXNzaW9uSWQ6IHJlcS5zZXNzaW9uSUQsXG4gICAgICBpcDogcmVxLmlwXG4gICAgfSk7XG4gICAgcmVxLnNlc3Npb25Vc2VyID0gbnVsbDsgLy8gU2V0IHRvIG51bGwgb24gZXJyb3JcbiAgICBuZXh0KCk7XG4gIH1cbn07XG5cbi8vIEpXVCBhdXRoZW50aWNhdGlvbiBtaWRkbGV3YXJlXG5jb25zdCBhdXRoZW50aWNhdGVUb2tlbiA9IGFzeW5jIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICB0cnkge1xuICAgIGNvbnNvbGUubG9nKCfwn5SQIEpXVCBhdXRoZW50aWNhdGlvbiBtaWRkbGV3YXJlIGNhbGxlZDonLCB7IHVybDogcmVxLnVybCwgbWV0aG9kOiByZXEubWV0aG9kIH0pO1xuICAgIGNvbnN0IGF1dGhIZWFkZXIgPSByZXEuaGVhZGVyc1snYXV0aG9yaXphdGlvbiddO1xuICAgIGNvbnN0IHRva2VuID0gYXV0aEhlYWRlciAmJiBhdXRoSGVhZGVyLnNwbGl0KCcgJylbMV07IC8vIEJlYXJlciBUT0tFTlxuXG4gICAgY29uc29sZS5sb2coJ/CflJEgVG9rZW4gZXh0cmFjdGlvbiByZXN1bHQ6JywgeyBoYXNBdXRoSGVhZGVyOiAhIWF1dGhIZWFkZXIsIGhhc1Rva2VuOiAhIXRva2VuIH0pO1xuXG4gICAgaWYgKCF0b2tlbikge1xuICAgICAgY29uc29sZS5sb2coJ+KdjCBObyB0b2tlbiBwcm92aWRlZCcpO1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAxKS5qc29uKHtcbiAgICAgICAgZXJyb3I6ICdBY2Nlc3MgdG9rZW4gcmVxdWlyZWQnLFxuICAgICAgICBjb2RlOiAnTk9fVE9LRU4nXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBjb25zdCBkZWNvZGVkID0gand0LnZlcmlmeSh0b2tlbiwgY29uZmlnLnNlY3VyaXR5Lmp3dFNlY3JldCk7XG4gICAgY29uc29sZS5sb2coJ+KchSBKV1QgZGVjb2RlZDonLCB7IHVzZXJJZDogZGVjb2RlZC51c2VySWQsIG5pY2tuYW1lOiBkZWNvZGVkLm5pY2tuYW1lIH0pO1xuICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBVc2VyLmZpbmRCeUlkKGRlY29kZWQudXNlcklkKTtcblxuICAgIGlmICghdXNlcikge1xuICAgICAgY29uc29sZS5sb2coJ+KdjCBVc2VyIG5vdCBmb3VuZCBpbiBEQiBmb3IgSldUIHVzZXJJZDonLCBkZWNvZGVkLnVzZXJJZCk7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oe1xuICAgICAgICBlcnJvcjogJ1VzZXIgbm90IGZvdW5kJyxcbiAgICAgICAgY29kZTogJ1VTRVJfTk9UX0ZPVU5EJ1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgcmVxLnVzZXIgPSB1c2VyO1xuICAgIGNvbnNvbGUubG9nKCfinIUgSldUIGF1dGhlbnRpY2F0aW9uIHN1Y2Nlc3NmdWwgZm9yIHVzZXI6JywgdXNlci5uaWNrbmFtZSwgeyBpZDogdXNlci5faWQsIHN0YXR1czogdXNlci5zdGF0dXMgfSk7XG4gICAgbmV4dCgpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGxvZ2dlci53YXJuKCdKV1QgYXV0aGVudGljYXRpb24gZmFpbGVkOicsIHtcbiAgICAgIGVycm9yOiBlcnJvci5tZXNzYWdlLFxuICAgICAgaXA6IHJlcS5pcFxuICAgIH0pO1xuXG4gICAgaWYgKGVycm9yLm5hbWUgPT09ICdKc29uV2ViVG9rZW5FcnJvcicpIHtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMSkuanNvbih7XG4gICAgICAgIGVycm9yOiAnSW52YWxpZCB0b2tlbiBmb3JtYXQnLFxuICAgICAgICBjb2RlOiAnSU5WQUxJRF9UT0tFTl9GT1JNQVQnXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBpZiAoZXJyb3IubmFtZSA9PT0gJ1Rva2VuRXhwaXJlZEVycm9yJykge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAxKS5qc29uKHtcbiAgICAgICAgZXJyb3I6ICdUb2tlbiBoYXMgZXhwaXJlZCcsXG4gICAgICAgIGNvZGU6ICdUT0tFTl9FWFBJUkVEJ1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAxKS5qc29uKHtcbiAgICAgIGVycm9yOiAnVG9rZW4gdmVyaWZpY2F0aW9uIGZhaWxlZCcsXG4gICAgICBjb2RlOiAnVE9LRU5fVkVSSUZJQ0FUSU9OX0ZBSUxFRCdcbiAgICB9KTtcbiAgfVxufTtcblxuLy8gUm9sZS1iYXNlZCBhY2Nlc3MgY29udHJvbCBtaWRkbGV3YXJlXG5jb25zdCByZXF1aXJlTW9kZXJhdG9yID0gYXN5bmMgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gIHRyeSB7XG4gICAgaWYgKCFyZXEudXNlcikge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAxKS5qc29uKHtcbiAgICAgICAgZXJyb3I6ICdBdXRoZW50aWNhdGlvbiByZXF1aXJlZCcsXG4gICAgICAgIGNvZGU6ICdBVVRIX1JFUVVJUkVEJ1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgaWYgKCFyZXEudXNlci5oYXNNb2RlcmF0b3JQcml2aWxlZ2VzKCkpIHtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMykuanNvbih7XG4gICAgICAgIGVycm9yOiAnTW9kZXJhdG9yIHByaXZpbGVnZXMgcmVxdWlyZWQnLFxuICAgICAgICBjb2RlOiAnTU9ERVJBVE9SX1JFUVVJUkVEJ1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgbmV4dCgpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGxvZ2dlci5lcnJvcignTW9kZXJhdG9yIGNoZWNrIGVycm9yOicsIGVycm9yKTtcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7XG4gICAgICBlcnJvcjogJ1NlcnZlciBlcnJvciBkdXJpbmcgYXV0aG9yaXphdGlvbiBjaGVjaycsXG4gICAgICBjb2RlOiAnQVVUSF9DSEVDS19FUlJPUidcbiAgICB9KTtcbiAgfVxufTtcblxuY29uc3QgcmVxdWlyZUFkbWluID0gYXN5bmMgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gIHRyeSB7XG4gICAgaWYgKCFyZXEudXNlcikge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAxKS5qc29uKHtcbiAgICAgICAgZXJyb3I6ICdBdXRoZW50aWNhdGlvbiByZXF1aXJlZCcsXG4gICAgICAgIGNvZGU6ICdBVVRIX1JFUVVJUkVEJ1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgaWYgKCFyZXEudXNlci5oYXNBZG1pblByaXZpbGVnZXMoKSkge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAzKS5qc29uKHtcbiAgICAgICAgZXJyb3I6ICdBZG1pbmlzdHJhdG9yIHByaXZpbGVnZXMgcmVxdWlyZWQnLFxuICAgICAgICBjb2RlOiAnQURNSU5fUkVRVUlSRUQnXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBuZXh0KCk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgbG9nZ2VyLmVycm9yKCdBZG1pbiBjaGVjayBlcnJvcjonLCBlcnJvcik7XG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oe1xuICAgICAgZXJyb3I6ICdTZXJ2ZXIgZXJyb3IgZHVyaW5nIGF1dGhvcml6YXRpb24gY2hlY2snLFxuICAgICAgY29kZTogJ0FVVEhfQ0hFQ0tfRVJST1InXG4gICAgfSk7XG4gIH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICBhdXRoZW50aWNhdGVTZXNzaW9uLFxuICBhdXRoZW50aWNhdGVUb2tlbixcbiAgcmVxdWlyZU1vZGVyYXRvcixcbiAgcmVxdWlyZUFkbWluLFxuICBsb2dnZXJcbn07Il0sIm1hcHBpbmdzIjoiQUFBQSxNQUFNQSxHQUFHLEdBQUdDLE9BQU8sQ0FBQyxjQUFjLENBQUM7QUFDbkMsTUFBTUMsT0FBTyxHQUFHRCxPQUFPLENBQUMsU0FBUyxDQUFDO0FBQ2xDLE1BQU1FLE1BQU0sR0FBR0YsT0FBTyxDQUFDLFdBQVcsQ0FBQztBQUNuQyxNQUFNRyxJQUFJLEdBQUdILE9BQU8sQ0FBQyxnQkFBZ0IsQ0FBQztBQUV0QyxNQUFNSSxNQUFNLEdBQUdILE9BQU8sQ0FBQ0ksWUFBWSxDQUFDO0VBQ2xDQyxLQUFLLEVBQUVKLE1BQU0sQ0FBQ0UsTUFBTSxDQUFDRSxLQUFLO0VBQzFCQyxNQUFNLEVBQUVOLE9BQU8sQ0FBQ00sTUFBTSxDQUFDQyxPQUFPLENBQzVCUCxPQUFPLENBQUNNLE1BQU0sQ0FBQ0UsU0FBUyxDQUFDLENBQUMsRUFDMUJSLE9BQU8sQ0FBQ00sTUFBTSxDQUFDRyxNQUFNLENBQUM7SUFBRUMsS0FBSyxFQUFFO0VBQUssQ0FBQyxDQUFDLEVBQ3RDVixPQUFPLENBQUNNLE1BQU0sQ0FBQ0ssSUFBSSxDQUFDLENBQ3RCLENBQUM7RUFDREMsV0FBVyxFQUFFO0lBQUVDLE9BQU8sRUFBRTtFQUFtQixDQUFDO0VBQzVDQyxVQUFVLEVBQUUsQ0FDVixJQUFJZCxPQUFPLENBQUNjLFVBQVUsQ0FBQ0MsSUFBSSxDQUFDO0lBQUVDLFFBQVEsRUFBRTtFQUFrQixDQUFDLENBQUMsRUFDNUQsSUFBSWhCLE9BQU8sQ0FBQ2MsVUFBVSxDQUFDRyxPQUFPLENBQUM7SUFDN0JYLE1BQU0sRUFBRU4sT0FBTyxDQUFDTSxNQUFNLENBQUNDLE9BQU8sQ0FDNUJQLE9BQU8sQ0FBQ00sTUFBTSxDQUFDWSxRQUFRLENBQUMsQ0FBQyxFQUN6QmxCLE9BQU8sQ0FBQ00sTUFBTSxDQUFDYSxNQUFNLENBQUMsQ0FDeEI7RUFDRixDQUFDLENBQUM7QUFFTixDQUFDLENBQUM7O0FBRUY7QUFDQSxNQUFNQyxtQkFBbUIsR0FBRyxNQUFBQSxDQUFPQyxHQUFHLEVBQUVDLEdBQUcsRUFBRUMsSUFBSSxLQUFLO0VBQ3BELElBQUk7SUFDRkMsT0FBTyxDQUFDQyxHQUFHLENBQUMsOENBQThDLEVBQUU7TUFDMURDLEdBQUcsRUFBRUwsR0FBRyxDQUFDSyxHQUFHO01BQ1pDLE1BQU0sRUFBRU4sR0FBRyxDQUFDTSxNQUFNO01BQ2xCQyxTQUFTLEVBQUVQLEdBQUcsQ0FBQ1EsU0FBUztNQUN4QkMsYUFBYSxFQUFFLENBQUMsQ0FBQ1QsR0FBRyxDQUFDVSxPQUFPO01BQzVCQyxXQUFXLEVBQUVYLEdBQUcsQ0FBQ1UsT0FBTyxHQUFHO1FBQ3pCRSxhQUFhLEVBQUVaLEdBQUcsQ0FBQ1UsT0FBTyxDQUFDRSxhQUFhO1FBQ3hDQyxNQUFNLEVBQUViLEdBQUcsQ0FBQ1UsT0FBTyxDQUFDRyxNQUFNO1FBQzFCQyxRQUFRLEVBQUVkLEdBQUcsQ0FBQ1UsT0FBTyxDQUFDSSxRQUFRO1FBQzlCQyxJQUFJLEVBQUVmLEdBQUcsQ0FBQ1UsT0FBTyxDQUFDSyxJQUFJO1FBQ3RCQyxTQUFTLEVBQUVoQixHQUFHLENBQUNVLE9BQU8sQ0FBQ00sU0FBUztRQUNoQ0MsU0FBUyxFQUFFakIsR0FBRyxDQUFDVSxPQUFPLENBQUNPLFNBQVMsRUFBRUMsU0FBUyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsR0FBRztNQUN0RCxDQUFDLEdBQUc7SUFDTixDQUFDLENBQUM7O0lBRUY7SUFDQSxJQUFJbEIsR0FBRyxDQUFDVSxPQUFPLElBQUlWLEdBQUcsQ0FBQ1UsT0FBTyxDQUFDRSxhQUFhLElBQUlaLEdBQUcsQ0FBQ1UsT0FBTyxDQUFDRyxNQUFNLEVBQUU7TUFDbEVWLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLDRDQUE0QyxFQUFFSixHQUFHLENBQUNVLE9BQU8sQ0FBQ0csTUFBTSxDQUFDO01BQzdFVixPQUFPLENBQUNDLEdBQUcsQ0FBQywrQkFBK0IsRUFBRTtRQUMzQ2UsR0FBRyxFQUFFbkIsR0FBRyxDQUFDUSxTQUFTO1FBQ2xCUyxTQUFTLEVBQUVqQixHQUFHLENBQUNVLE9BQU8sQ0FBQ08sU0FBUyxFQUFFQyxTQUFTLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxHQUFHLEtBQUs7UUFDekRFLFNBQVMsRUFBRXBCLEdBQUcsQ0FBQ1UsT0FBTyxDQUFDVSxTQUFTLEVBQUVGLFNBQVMsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLEdBQUcsS0FBSztRQUMxREYsU0FBUyxFQUFFaEIsR0FBRyxDQUFDVSxPQUFPLENBQUNNO01BQ3pCLENBQUMsQ0FBQztNQUVGLE1BQU1LLElBQUksR0FBRyxNQUFNeEMsSUFBSSxDQUFDeUMsUUFBUSxDQUFDdEIsR0FBRyxDQUFDVSxPQUFPLENBQUNHLE1BQU0sQ0FBQztNQUNwRCxJQUFJUSxJQUFJLEVBQUU7UUFDUmxCLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLDZCQUE2QixFQUFFO1VBQ3pDVSxRQUFRLEVBQUVPLElBQUksQ0FBQ1AsUUFBUTtVQUN2QlMsRUFBRSxFQUFFRixJQUFJLENBQUNHLEdBQUc7VUFDWkMsTUFBTSxFQUFFSixJQUFJLENBQUNJLE1BQU07VUFDbkJDLFlBQVksRUFBRTtRQUNoQixDQUFDLENBQUM7UUFDRjFCLEdBQUcsQ0FBQzJCLFdBQVcsR0FBR04sSUFBSSxDQUFDLENBQUM7O1FBRXhCO1FBQ0EsSUFBSXJCLEdBQUcsQ0FBQ1UsT0FBTyxDQUFDTyxTQUFTLElBQUlqQixHQUFHLENBQUNVLE9BQU8sQ0FBQ1UsU0FBUyxFQUFFO1VBQ2xEcEIsR0FBRyxDQUFDVSxPQUFPLENBQUNrQixnQkFBZ0IsR0FBRyxJQUFJQyxJQUFJLENBQUMsQ0FBQyxDQUFDQyxXQUFXLENBQUMsQ0FBQztVQUN2RDNCLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLDZDQUE2QyxDQUFDO1FBQzVEO01BQ0YsQ0FBQyxNQUFNO1FBQ0xELE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLG9EQUFvRCxFQUFFSixHQUFHLENBQUNVLE9BQU8sQ0FBQ0csTUFBTSxDQUFDO1FBQ3JGO1FBQ0EsT0FBT2IsR0FBRyxDQUFDVSxPQUFPLENBQUNFLGFBQWE7UUFDaEMsT0FBT1osR0FBRyxDQUFDVSxPQUFPLENBQUNHLE1BQU07UUFDekIsT0FBT2IsR0FBRyxDQUFDVSxPQUFPLENBQUNJLFFBQVE7UUFDM0IsT0FBT2QsR0FBRyxDQUFDVSxPQUFPLENBQUNLLElBQUk7TUFDekI7SUFDRixDQUFDLE1BQU07TUFDTFosT0FBTyxDQUFDQyxHQUFHLENBQUMsOERBQThELEVBQUU7UUFDMUVHLFNBQVMsRUFBRVAsR0FBRyxDQUFDUSxTQUFTO1FBQ3hCRSxPQUFPLEVBQUUsQ0FBQyxDQUFDVixHQUFHLENBQUNVLE9BQU87UUFDdEJFLGFBQWEsRUFBRVosR0FBRyxDQUFDVSxPQUFPLEVBQUVFLGFBQWE7UUFDekNDLE1BQU0sRUFBRWIsR0FBRyxDQUFDVSxPQUFPLEVBQUVHO01BQ3ZCLENBQUMsQ0FBQztNQUNGYixHQUFHLENBQUMyQixXQUFXLEdBQUcsSUFBSSxDQUFDLENBQUM7SUFDMUI7SUFDQXpCLElBQUksQ0FBQyxDQUFDO0VBQ1IsQ0FBQyxDQUFDLE9BQU82QixLQUFLLEVBQUU7SUFDZGpELE1BQU0sQ0FBQ2tELElBQUksQ0FBQywrQkFBK0IsRUFBRTtNQUMzQ0QsS0FBSyxFQUFFQSxLQUFLLENBQUNFLE9BQU87TUFDcEIxQixTQUFTLEVBQUVQLEdBQUcsQ0FBQ1EsU0FBUztNQUN4QjBCLEVBQUUsRUFBRWxDLEdBQUcsQ0FBQ2tDO0lBQ1YsQ0FBQyxDQUFDO0lBQ0ZsQyxHQUFHLENBQUMyQixXQUFXLEdBQUcsSUFBSSxDQUFDLENBQUM7SUFDeEJ6QixJQUFJLENBQUMsQ0FBQztFQUNSO0FBQ0YsQ0FBQzs7QUFFRDtBQUNBLE1BQU1pQyxpQkFBaUIsR0FBRyxNQUFBQSxDQUFPbkMsR0FBRyxFQUFFQyxHQUFHLEVBQUVDLElBQUksS0FBSztFQUNsRCxJQUFJO0lBQ0ZDLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLDBDQUEwQyxFQUFFO01BQUVDLEdBQUcsRUFBRUwsR0FBRyxDQUFDSyxHQUFHO01BQUVDLE1BQU0sRUFBRU4sR0FBRyxDQUFDTTtJQUFPLENBQUMsQ0FBQztJQUM3RixNQUFNOEIsVUFBVSxHQUFHcEMsR0FBRyxDQUFDcUMsT0FBTyxDQUFDLGVBQWUsQ0FBQztJQUMvQyxNQUFNQyxLQUFLLEdBQUdGLFVBQVUsSUFBSUEsVUFBVSxDQUFDRyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQzs7SUFFdERwQyxPQUFPLENBQUNDLEdBQUcsQ0FBQyw2QkFBNkIsRUFBRTtNQUFFb0MsYUFBYSxFQUFFLENBQUMsQ0FBQ0osVUFBVTtNQUFFSyxRQUFRLEVBQUUsQ0FBQyxDQUFDSDtJQUFNLENBQUMsQ0FBQztJQUU5RixJQUFJLENBQUNBLEtBQUssRUFBRTtNQUNWbkMsT0FBTyxDQUFDQyxHQUFHLENBQUMscUJBQXFCLENBQUM7TUFDbEMsT0FBT0gsR0FBRyxDQUFDd0IsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDbkMsSUFBSSxDQUFDO1FBQzFCeUMsS0FBSyxFQUFFLHVCQUF1QjtRQUM5QlcsSUFBSSxFQUFFO01BQ1IsQ0FBQyxDQUFDO0lBQ0o7SUFFQSxNQUFNQyxPQUFPLEdBQUdsRSxHQUFHLENBQUNtRSxNQUFNLENBQUNOLEtBQUssRUFBRTFELE1BQU0sQ0FBQ2lFLFFBQVEsQ0FBQ0MsU0FBUyxDQUFDO0lBQzVEM0MsT0FBTyxDQUFDQyxHQUFHLENBQUMsZ0JBQWdCLEVBQUU7TUFBRVMsTUFBTSxFQUFFOEIsT0FBTyxDQUFDOUIsTUFBTTtNQUFFQyxRQUFRLEVBQUU2QixPQUFPLENBQUM3QjtJQUFTLENBQUMsQ0FBQztJQUNyRixNQUFNTyxJQUFJLEdBQUcsTUFBTXhDLElBQUksQ0FBQ3lDLFFBQVEsQ0FBQ3FCLE9BQU8sQ0FBQzlCLE1BQU0sQ0FBQztJQUVoRCxJQUFJLENBQUNRLElBQUksRUFBRTtNQUNUbEIsT0FBTyxDQUFDQyxHQUFHLENBQUMsd0NBQXdDLEVBQUV1QyxPQUFPLENBQUM5QixNQUFNLENBQUM7TUFDckUsT0FBT1osR0FBRyxDQUFDd0IsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDbkMsSUFBSSxDQUFDO1FBQzFCeUMsS0FBSyxFQUFFLGdCQUFnQjtRQUN2QlcsSUFBSSxFQUFFO01BQ1IsQ0FBQyxDQUFDO0lBQ0o7SUFFQTFDLEdBQUcsQ0FBQ3FCLElBQUksR0FBR0EsSUFBSTtJQUNmbEIsT0FBTyxDQUFDQyxHQUFHLENBQUMsMkNBQTJDLEVBQUVpQixJQUFJLENBQUNQLFFBQVEsRUFBRTtNQUFFUyxFQUFFLEVBQUVGLElBQUksQ0FBQ0csR0FBRztNQUFFQyxNQUFNLEVBQUVKLElBQUksQ0FBQ0k7SUFBTyxDQUFDLENBQUM7SUFDOUd2QixJQUFJLENBQUMsQ0FBQztFQUNSLENBQUMsQ0FBQyxPQUFPNkIsS0FBSyxFQUFFO0lBQ2RqRCxNQUFNLENBQUNrRCxJQUFJLENBQUMsNEJBQTRCLEVBQUU7TUFDeENELEtBQUssRUFBRUEsS0FBSyxDQUFDRSxPQUFPO01BQ3BCQyxFQUFFLEVBQUVsQyxHQUFHLENBQUNrQztJQUNWLENBQUMsQ0FBQztJQUVGLElBQUlILEtBQUssQ0FBQ2dCLElBQUksS0FBSyxtQkFBbUIsRUFBRTtNQUN0QyxPQUFPOUMsR0FBRyxDQUFDd0IsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDbkMsSUFBSSxDQUFDO1FBQzFCeUMsS0FBSyxFQUFFLHNCQUFzQjtRQUM3QlcsSUFBSSxFQUFFO01BQ1IsQ0FBQyxDQUFDO0lBQ0o7SUFFQSxJQUFJWCxLQUFLLENBQUNnQixJQUFJLEtBQUssbUJBQW1CLEVBQUU7TUFDdEMsT0FBTzlDLEdBQUcsQ0FBQ3dCLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQ25DLElBQUksQ0FBQztRQUMxQnlDLEtBQUssRUFBRSxtQkFBbUI7UUFDMUJXLElBQUksRUFBRTtNQUNSLENBQUMsQ0FBQztJQUNKO0lBRUEsT0FBT3pDLEdBQUcsQ0FBQ3dCLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQ25DLElBQUksQ0FBQztNQUMxQnlDLEtBQUssRUFBRSwyQkFBMkI7TUFDbENXLElBQUksRUFBRTtJQUNSLENBQUMsQ0FBQztFQUNKO0FBQ0YsQ0FBQzs7QUFFRDtBQUNBLE1BQU1NLGdCQUFnQixHQUFHLE1BQUFBLENBQU9oRCxHQUFHLEVBQUVDLEdBQUcsRUFBRUMsSUFBSSxLQUFLO0VBQ2pELElBQUk7SUFDRixJQUFJLENBQUNGLEdBQUcsQ0FBQ3FCLElBQUksRUFBRTtNQUNiLE9BQU9wQixHQUFHLENBQUN3QixNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNuQyxJQUFJLENBQUM7UUFDMUJ5QyxLQUFLLEVBQUUseUJBQXlCO1FBQ2hDVyxJQUFJLEVBQUU7TUFDUixDQUFDLENBQUM7SUFDSjtJQUVBLElBQUksQ0FBQzFDLEdBQUcsQ0FBQ3FCLElBQUksQ0FBQzRCLHNCQUFzQixDQUFDLENBQUMsRUFBRTtNQUN0QyxPQUFPaEQsR0FBRyxDQUFDd0IsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDbkMsSUFBSSxDQUFDO1FBQzFCeUMsS0FBSyxFQUFFLCtCQUErQjtRQUN0Q1csSUFBSSxFQUFFO01BQ1IsQ0FBQyxDQUFDO0lBQ0o7SUFFQXhDLElBQUksQ0FBQyxDQUFDO0VBQ1IsQ0FBQyxDQUFDLE9BQU82QixLQUFLLEVBQUU7SUFDZGpELE1BQU0sQ0FBQ2lELEtBQUssQ0FBQyx3QkFBd0IsRUFBRUEsS0FBSyxDQUFDO0lBQzdDOUIsR0FBRyxDQUFDd0IsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDbkMsSUFBSSxDQUFDO01BQ25CeUMsS0FBSyxFQUFFLHlDQUF5QztNQUNoRFcsSUFBSSxFQUFFO0lBQ1IsQ0FBQyxDQUFDO0VBQ0o7QUFDRixDQUFDO0FBRUQsTUFBTVEsWUFBWSxHQUFHLE1BQUFBLENBQU9sRCxHQUFHLEVBQUVDLEdBQUcsRUFBRUMsSUFBSSxLQUFLO0VBQzdDLElBQUk7SUFDRixJQUFJLENBQUNGLEdBQUcsQ0FBQ3FCLElBQUksRUFBRTtNQUNiLE9BQU9wQixHQUFHLENBQUN3QixNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNuQyxJQUFJLENBQUM7UUFDMUJ5QyxLQUFLLEVBQUUseUJBQXlCO1FBQ2hDVyxJQUFJLEVBQUU7TUFDUixDQUFDLENBQUM7SUFDSjtJQUVBLElBQUksQ0FBQzFDLEdBQUcsQ0FBQ3FCLElBQUksQ0FBQzhCLGtCQUFrQixDQUFDLENBQUMsRUFBRTtNQUNsQyxPQUFPbEQsR0FBRyxDQUFDd0IsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDbkMsSUFBSSxDQUFDO1FBQzFCeUMsS0FBSyxFQUFFLG1DQUFtQztRQUMxQ1csSUFBSSxFQUFFO01BQ1IsQ0FBQyxDQUFDO0lBQ0o7SUFFQXhDLElBQUksQ0FBQyxDQUFDO0VBQ1IsQ0FBQyxDQUFDLE9BQU82QixLQUFLLEVBQUU7SUFDZGpELE1BQU0sQ0FBQ2lELEtBQUssQ0FBQyxvQkFBb0IsRUFBRUEsS0FBSyxDQUFDO0lBQ3pDOUIsR0FBRyxDQUFDd0IsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDbkMsSUFBSSxDQUFDO01BQ25CeUMsS0FBSyxFQUFFLHlDQUF5QztNQUNoRFcsSUFBSSxFQUFFO0lBQ1IsQ0FBQyxDQUFDO0VBQ0o7QUFDRixDQUFDO0FBRURVLE1BQU0sQ0FBQ0MsT0FBTyxHQUFHO0VBQ2Z0RCxtQkFBbUI7RUFDbkJvQyxpQkFBaUI7RUFDakJhLGdCQUFnQjtFQUNoQkUsWUFBWTtFQUNacEU7QUFDRixDQUFDIiwiaWdub3JlTGlzdCI6W119