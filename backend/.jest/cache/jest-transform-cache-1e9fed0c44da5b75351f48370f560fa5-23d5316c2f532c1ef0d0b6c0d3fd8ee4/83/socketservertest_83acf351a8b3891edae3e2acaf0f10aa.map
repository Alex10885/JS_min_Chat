{"version":3,"names":["http","require","socketIo","express","jwt","cors","connectDB","closeDB","User","Channel","Message","SocketTestServer","constructor","port","app","server","createServer","io","origin","methods","onlineUsers","Map","voiceChannels","userConnections","setupExpress","setupSocketIO","use","json","post","req","res","nickname","body","user","findOne","status","error","save","token","sign","id","_id","role","process","env","JWT_SECRET","expiresIn","message","socket","next","handshake","auth","console","log","substring","Error","decoded","verify","findById","userId","connectionCount","get","newConnectionCount","set","updatedUser","findOneAndUpdate","$set","lastActive","Date","new","runValidators","err","on","room","data","trim","length","emit","code","channel","leave","join","joinMessage","author","text","type","to","timestamp","roomUsers","Array","from","values","filter","u","map","history","find","$or","target","sort","limit","msg","messageData","recipient","privateMessage","recipientUser","recipientSocket","keys","socketId","speaking","channelId","has","peerConnection","stream","voiceChannel","channelPeers","delete","size","offer","targetSocketId","fromNickname","answer","candidate","currentCount","newCount","Math","max","findByIdAndUpdate","leaveMessage","start","Promise","resolve","reject","timeout","setTimeout","listen","clearTimeout","assignedPort","address","stop","close","clear","getPort","describe","it","expect","toBe","module","exports"],"sources":["socket-server.test.js"],"sourcesContent":["const http = require('http');\nconst socketIo = require('socket.io');\nconst express = require('express');\nconst jwt = require('jsonwebtoken');\nconst cors = require('cors');\nconst { connectDB, closeDB } = require('../db/connection');\nconst User = require('../models/User');\nconst Channel = require('../models/Channel');\nconst Message = require('../models/Message');\n\n// Test server for Socket.IO integration tests\nclass SocketTestServer {\n  constructor(port = 0) { // Use 0 to get random available port\n    this.port = port;\n    this.app = express();\n    this.server = http.createServer(this.app);\n    this.io = socketIo(this.server, {\n      cors: {\n        origin: true,\n        methods: [\"GET\", \"POST\"]\n      }\n    });\n\n    this.onlineUsers = new Map();\n    this.voiceChannels = new Map();\n    this.userConnections = new Map(); // Track user connection counts\n\n    this.setupExpress();\n    this.setupSocketIO();\n  }\n\n  setupExpress() {\n    this.app.use(cors());\n    this.app.use(express.json());\n\n    // Minimal auth route for getting tokens\n    this.app.post('/test-login', async (req, res) => {\n      try {\n        const { nickname } = req.body;\n        const user = await User.findOne({ nickname });\n\n        if (!user) {\n          return res.status(404).json({ error: 'User not found' });\n        }\n\n        // Set user as online for socket auth\n        user.status = 'online';\n        await user.save();\n\n        const token = jwt.sign(\n          { id: user._id, nickname: user.nickname, role: user.role },\n          process.env.JWT_SECRET,\n          { expiresIn: '24h' }\n        );\n\n        res.json({ token, user: { id: user._id, nickname: user.nickname, role: user.role } });\n      } catch (error) {\n        res.status(500).json({ error: error.message });\n      }\n    });\n  }\n\n  setupSocketIO() {\n    this.io.use(async (socket, next) => {\n      const token = socket.handshake.auth.token;\n      console.log('Socket.IO auth middleware: received token:', token ? token.substring(0, 20) + '...' : 'null');\n\n      if (!token) {\n        console.log('Socket.IO auth middleware: no token provided');\n        return next(new Error('Authentication token required'));\n      }\n\n      try {\n        const decoded = jwt.verify(token, process.env.JWT_SECRET);\n        console.log('Socket.IO auth middleware: decoded token:', { id: decoded.id, nickname: decoded.nickname });\n        const user = await User.findById(decoded.id);\n        console.log('Socket.IO auth middleware: user found in DB:', user ? { id: user._id, status: user.status, nickname: user.nickname } : 'null');\n\n        if (!user) {\n          console.log('Socket.IO auth middleware: ERROR - user not found in DB');\n          return next(new Error('User not found or not online'));\n        }\n\n        console.log('Socket.IO auth middleware: checking user status:', user.status);\n\n        // Check if user is marked as offline during authentication\n        if (user.status === 'offline') {\n          console.log('Socket.IO auth middleware: ERROR - user status is offline');\n          return next(new Error('User not found or not online'));\n        }\n\n        // Handle user status update based on connection count\n        const userId = decoded.id;\n        const connectionCount = this.userConnections.get(userId) || 0;\n        const newConnectionCount = connectionCount + 1;\n        this.userConnections.set(userId, newConnectionCount);\n\n        console.log(`Socket.IO auth middleware: updating user ${userId} to online, connection count: ${newConnectionCount}`);\n\n        // Update user status to online during authentication\n        const updatedUser = await User.findOneAndUpdate(\n          { _id: userId },\n          {\n            $set: {\n              status: 'online',\n              lastActive: new Date()\n            }\n          },\n          { new: true, runValidators: true }\n        );\n\n        console.log('Socket.IO auth middleware: user updated to:', updatedUser ? { id: updatedUser._id, status: updatedUser.status } : 'null');\n\n        socket.userId = decoded.id;\n        socket.nickname = decoded.nickname;\n        socket.role = decoded.role;\n        console.log('Socket.IO auth middleware: authentication successful for user:', socket.nickname);\n        return next();\n      } catch (err) {\n        console.log('Socket.IO auth middleware: ERROR during auth:', err.message);\n        return next(new Error('Authentication failed'));\n      }\n    });\n\n    this.io.on('connection', (socket) => {\n      // Track online user\n      this.onlineUsers.set(socket.id, {\n        userId: socket.userId,\n        nickname: socket.nickname,\n        role: socket.role,\n        room: null\n      });\n\n      socket.on('join_room', async (data) => {\n        const { room } = data;\n        if (!room || typeof room !== 'string' || room.trim().length === 0) {\n          socket.emit('error', {\n            message: 'Invalid room name',\n            code: 'INVALID_ROOM_FORMAT'\n          });\n          return;\n        }\n\n        try {\n          const channel = await Channel.findOne({ id: room });\n          if (!channel) {\n            socket.emit('error', {\n              message: `Channel '${room}' not found`,\n              code: 'CHANNEL_NOT_FOUND'\n            });\n            return;\n          }\n\n          // Leave previous room\n          if (socket.room) {\n            socket.leave(socket.room);\n            this.onlineUsers.set(socket.id, { ...this.onlineUsers.get(socket.id), room: null });\n          }\n\n          socket.room = room;\n          socket.join(socket.room);\n\n          this.onlineUsers.set(socket.id, {\n            ...this.onlineUsers.get(socket.id),\n            room: socket.room\n          });\n\n          // Send join system message\n          const joinMessage = new Message({\n            author: 'System',\n            channel: socket.room,\n            text: `${socket.nickname} joined the channel.`,\n            type: 'system'\n          });\n          await joinMessage.save();\n\n          this.io.to(socket.room).emit('message', {\n            author: joinMessage.author,\n            channel: joinMessage.channel,\n            text: joinMessage.text,\n            type: joinMessage.type,\n            timestamp: joinMessage.timestamp\n          });\n\n          // Send online users\n          const roomUsers = Array.from(this.onlineUsers.values())\n            .filter(u => u.room === socket.room)\n            .map(u => ({ nickname: u.nickname, role: u.role }));\n          this.io.to(socket.room).emit('online_users', roomUsers);\n\n          // Send message history\n          const history = await Message.find({\n            channel: socket.room,\n            $or: [\n              { type: 'public' },\n              { type: 'system' },\n              { author: socket.nickname },\n              { target: socket.nickname }\n            ]\n          })\n            .sort({ timestamp: -1 })\n            .limit(100)\n            .sort({ timestamp: 1 });\n\n          socket.emit('history', history.map(msg => ({\n            author: msg.author,\n            room: msg.channel,\n            text: msg.text,\n            type: msg.type,\n            target: msg.target,\n            timestamp: msg.timestamp\n          })));\n\n        } catch (error) {\n          socket.emit('error', { message: 'Failed to join room' });\n        }\n      });\n\n      socket.on('message', async (data) => {\n        if (!socket.room || !data.text?.trim()) return;\n\n        try {\n          const message = new Message({\n            author: socket.nickname,\n            channel: socket.room,\n            text: data.text.trim(),\n            type: 'public'\n          });\n\n          await message.save();\n\n          const messageData = {\n            author: message.author,\n            room: message.channel,\n            text: message.text,\n            timestamp: message.timestamp,\n            status: 'delivered',\n            type: message.type\n          };\n\n          this.io.to(socket.room).emit('message', messageData);\n        } catch (error) {\n          socket.emit('error', { message: 'Failed to send message' });\n        }\n      });\n\n      socket.on('private_message', async (data) => {\n        const { to, text } = data;\n        if (!to || !text?.trim()) return;\n\n        try {\n          // Find recipient user\n          const recipient = await User.findOne({ nickname: to });\n          if (!recipient) {\n            socket.emit('error', { message: 'Recipient not found' });\n            return;\n          }\n\n          // Create private message\n          const privateMessage = new Message({\n            author: socket.nickname,\n            target: to,\n            text: text.trim(),\n            type: 'private'\n          });\n\n          await privateMessage.save();\n\n          const messageData = {\n            author: privateMessage.author,\n            text: privateMessage.text,\n            target: privateMessage.target,\n            timestamp: privateMessage.timestamp,\n            type: 'private_message'\n          };\n\n          // Send to recipient if online\n          const recipientUser = Array.from(this.onlineUsers.values()).find(u => u.nickname === to);\n          if (recipientUser) {\n            const recipientSocket = Array.from(this.onlineUsers.keys()).find(socketId =>\n              this.onlineUsers.get(socketId).nickname === to\n            );\n            if (recipientSocket) {\n              this.io.to(recipientSocket).emit('private_message', messageData);\n            }\n          }\n\n          // Send to sender as confirmation\n          socket.emit('private_message', messageData);\n\n        } catch (error) {\n          socket.emit('error', { message: 'Failed to send private message' });\n        }\n      });\n\n      socket.on('speaking', (data) => {\n        socket.to(socket.room).emit('speaking', {\n          nickname: socket.nickname,\n          speaking: data.speaking\n        });\n      });\n\n      socket.on('join_voice_channel', async (data) => {\n        const { channelId } = data;\n        if (!channelId) return;\n\n        try {\n          const channel = await Channel.findOne({ id: channelId, type: 'voice' });\n          if (!channel) {\n            socket.emit('voice_error', { message: 'Voice channel not found' });\n            return;\n          }\n\n          if (!this.voiceChannels.has(channelId)) {\n            this.voiceChannels.set(channelId, new Map());\n          }\n\n          socket.to(channelId).emit('user_joined_voice', {\n            nickname: socket.nickname,\n            socketId: socket.id\n          });\n\n          socket.join(channelId);\n          this.voiceChannels.get(channelId).set(socket.id, { peerConnection: null, stream: null });\n\n          socket.voiceChannel = channelId;\n          socket.emit('voice_joined', { channelId });\n\n        } catch (error) {\n          socket.emit('voice_error', { message: 'Failed to join voice channel' });\n        }\n      });\n\n      socket.on('leave_voice_channel', () => {\n        if (!socket.voiceChannel) return;\n\n        const channelId = socket.voiceChannel;\n        const channelPeers = this.voiceChannels.get(channelId);\n\n        if (channelPeers) {\n          channelPeers.delete(socket.id);\n          if (channelPeers.size === 0) {\n            this.voiceChannels.delete(channelId);\n          }\n        }\n\n        socket.to(channelId).emit('user_left_voice', {\n          nickname: socket.nickname,\n          socketId: socket.id\n        });\n\n        socket.leave(channelId);\n        socket.voiceChannel = null;\n        socket.emit('voice_left');\n      });\n\n      // Voice signaling\n      socket.on('voice_offer', (data) => {\n        const { offer, targetSocketId } = data;\n        socket.to(targetSocketId).emit('voice_offer', {\n          offer,\n          from: socket.id,\n          fromNickname: socket.nickname\n        });\n      });\n\n      socket.on('voice_answer', (data) => {\n        const { answer, targetSocketId } = data;\n        socket.to(targetSocketId).emit('voice_answer', {\n          answer,\n          from: socket.id,\n          fromNickname: socket.nickname\n        });\n      });\n\n      socket.on('ice_candidate', (data) => {\n        const { candidate, targetSocketId } = data;\n        socket.to(targetSocketId).emit('ice_candidate', {\n          candidate,\n          from: socket.id,\n          fromNickname: socket.nickname\n        });\n      });\n\n      socket.on('disconnect', async () => {\n        // Decrease connection count for this user\n        const userId = socket.userId;\n        if (userId) {\n          const currentCount = this.userConnections.get(userId) || 0;\n          const newCount = Math.max(0, currentCount - 1);\n          this.userConnections.set(userId, newCount);\n\n          // Update user status in database if this was the last connection\n          if (newCount === 0) {\n            await User.findByIdAndUpdate(userId, {\n              status: 'offline',\n              lastActive: new Date()\n            });\n          }\n        }\n\n        // Leave voice channel if in one\n        if (socket.voiceChannel) {\n          const channelId = socket.voiceChannel;\n          const channelPeers = this.voiceChannels.get(channelId);\n\n          if (channelPeers) {\n            channelPeers.delete(socket.id);\n            if (channelPeers.size === 0) {\n              this.voiceChannels.delete(channelId);\n            }\n          }\n\n          socket.to(channelId).emit('user_left_voice', {\n            nickname: socket.nickname,\n            socketId: socket.id\n          });\n        }\n\n        if (socket.room) {\n          socket.leave(socket.room);\n\n          const leaveMessage = new Message({\n            author: 'System',\n            channel: socket.room,\n            text: `${socket.nickname} left the channel.`,\n            type: 'system'\n          });\n          await leaveMessage.save();\n\n          this.io.to(socket.room).emit('message', {\n            author: leaveMessage.author,\n            room: leaveMessage.channel,\n            text: leaveMessage.text,\n            type: leaveMessage.type,\n            timestamp: leaveMessage.timestamp\n          });\n\n          const roomUsers = Array.from(this.onlineUsers.values())\n            .filter(u => u.room === socket.room && u.userId !== socket.userId)\n            .map(u => ({ nickname: u.nickname, role: u.role }));\n          this.io.to(socket.room).emit('online_users', roomUsers);\n        }\n\n        this.onlineUsers.delete(socket.id);\n      });\n    });\n  }\n\n  async start() {\n    console.log(`Starting socket server on port ${this.port}...`);\n    return new Promise((resolve, reject) => {\n      const timeout = setTimeout(() => {\n        reject(new Error('Server startup timeout after 10 seconds'));\n      }, 10000);\n\n      this.server.listen(this.port, (err) => {\n        clearTimeout(timeout);\n        if (err) {\n          console.error('Failed to start socket server:', err.message);\n          reject(err);\n        } else {\n          const assignedPort = this.server.address().port;\n          console.log(`Socket server successfully started on port ${assignedPort}`);\n          resolve(assignedPort);\n        }\n      });\n    });\n  }\n\n  async stop() {\n    return new Promise((resolve) => {\n      this.server.close(() => {\n        this.onlineUsers.clear();\n        this.voiceChannels.clear();\n        resolve();\n      });\n    });\n  }\n\n  getPort() {\n    return this.server.address()?.port;\n  }\n}\n\ndescribe('Socket.IO Test Server Helper', () => {\n  it('should be a basic test to prevent empty test suite error', () => {\n    expect(1).toBe(1);\n  });\n});\n\nmodule.exports = SocketTestServer;"],"mappings":"AAAA,MAAMA,IAAI,GAAGC,OAAO,CAAC,MAAM,CAAC;AAC5B,MAAMC,QAAQ,GAAGD,OAAO,CAAC,WAAW,CAAC;AACrC,MAAME,OAAO,GAAGF,OAAO,CAAC,SAAS,CAAC;AAClC,MAAMG,GAAG,GAAGH,OAAO,CAAC,cAAc,CAAC;AACnC,MAAMI,IAAI,GAAGJ,OAAO,CAAC,MAAM,CAAC;AAC5B,MAAM;EAAEK,SAAS;EAAEC;AAAQ,CAAC,GAAGN,OAAO,CAAC,kBAAkB,CAAC;AAC1D,MAAMO,IAAI,GAAGP,OAAO,CAAC,gBAAgB,CAAC;AACtC,MAAMQ,OAAO,GAAGR,OAAO,CAAC,mBAAmB,CAAC;AAC5C,MAAMS,OAAO,GAAGT,OAAO,CAAC,mBAAmB,CAAC;;AAE5C;AACA,MAAMU,gBAAgB,CAAC;EACrBC,WAAWA,CAACC,IAAI,GAAG,CAAC,EAAE;IAAE;IACtB,IAAI,CAACA,IAAI,GAAGA,IAAI;IAChB,IAAI,CAACC,GAAG,GAAGX,OAAO,CAAC,CAAC;IACpB,IAAI,CAACY,MAAM,GAAGf,IAAI,CAACgB,YAAY,CAAC,IAAI,CAACF,GAAG,CAAC;IACzC,IAAI,CAACG,EAAE,GAAGf,QAAQ,CAAC,IAAI,CAACa,MAAM,EAAE;MAC9BV,IAAI,EAAE;QACJa,MAAM,EAAE,IAAI;QACZC,OAAO,EAAE,CAAC,KAAK,EAAE,MAAM;MACzB;IACF,CAAC,CAAC;IAEF,IAAI,CAACC,WAAW,GAAG,IAAIC,GAAG,CAAC,CAAC;IAC5B,IAAI,CAACC,aAAa,GAAG,IAAID,GAAG,CAAC,CAAC;IAC9B,IAAI,CAACE,eAAe,GAAG,IAAIF,GAAG,CAAC,CAAC,CAAC,CAAC;;IAElC,IAAI,CAACG,YAAY,CAAC,CAAC;IACnB,IAAI,CAACC,aAAa,CAAC,CAAC;EACtB;EAEAD,YAAYA,CAAA,EAAG;IACb,IAAI,CAACV,GAAG,CAACY,GAAG,CAACrB,IAAI,CAAC,CAAC,CAAC;IACpB,IAAI,CAACS,GAAG,CAACY,GAAG,CAACvB,OAAO,CAACwB,IAAI,CAAC,CAAC,CAAC;;IAE5B;IACA,IAAI,CAACb,GAAG,CAACc,IAAI,CAAC,aAAa,EAAE,OAAOC,GAAG,EAAEC,GAAG,KAAK;MAC/C,IAAI;QACF,MAAM;UAAEC;QAAS,CAAC,GAAGF,GAAG,CAACG,IAAI;QAC7B,MAAMC,IAAI,GAAG,MAAMzB,IAAI,CAAC0B,OAAO,CAAC;UAAEH;QAAS,CAAC,CAAC;QAE7C,IAAI,CAACE,IAAI,EAAE;UACT,OAAOH,GAAG,CAACK,MAAM,CAAC,GAAG,CAAC,CAACR,IAAI,CAAC;YAAES,KAAK,EAAE;UAAiB,CAAC,CAAC;QAC1D;;QAEA;QACAH,IAAI,CAACE,MAAM,GAAG,QAAQ;QACtB,MAAMF,IAAI,CAACI,IAAI,CAAC,CAAC;QAEjB,MAAMC,KAAK,GAAGlC,GAAG,CAACmC,IAAI,CACpB;UAAEC,EAAE,EAAEP,IAAI,CAACQ,GAAG;UAAEV,QAAQ,EAAEE,IAAI,CAACF,QAAQ;UAAEW,IAAI,EAAET,IAAI,CAACS;QAAK,CAAC,EAC1DC,OAAO,CAACC,GAAG,CAACC,UAAU,EACtB;UAAEC,SAAS,EAAE;QAAM,CACrB,CAAC;QAEDhB,GAAG,CAACH,IAAI,CAAC;UAAEW,KAAK;UAAEL,IAAI,EAAE;YAAEO,EAAE,EAAEP,IAAI,CAACQ,GAAG;YAAEV,QAAQ,EAAEE,IAAI,CAACF,QAAQ;YAAEW,IAAI,EAAET,IAAI,CAACS;UAAK;QAAE,CAAC,CAAC;MACvF,CAAC,CAAC,OAAON,KAAK,EAAE;QACdN,GAAG,CAACK,MAAM,CAAC,GAAG,CAAC,CAACR,IAAI,CAAC;UAAES,KAAK,EAAEA,KAAK,CAACW;QAAQ,CAAC,CAAC;MAChD;IACF,CAAC,CAAC;EACJ;EAEAtB,aAAaA,CAAA,EAAG;IACd,IAAI,CAACR,EAAE,CAACS,GAAG,CAAC,OAAOsB,MAAM,EAAEC,IAAI,KAAK;MAClC,MAAMX,KAAK,GAAGU,MAAM,CAACE,SAAS,CAACC,IAAI,CAACb,KAAK;MACzCc,OAAO,CAACC,GAAG,CAAC,4CAA4C,EAAEf,KAAK,GAAGA,KAAK,CAACgB,SAAS,CAAC,CAAC,EAAE,EAAE,CAAC,GAAG,KAAK,GAAG,MAAM,CAAC;MAE1G,IAAI,CAAChB,KAAK,EAAE;QACVc,OAAO,CAACC,GAAG,CAAC,8CAA8C,CAAC;QAC3D,OAAOJ,IAAI,CAAC,IAAIM,KAAK,CAAC,+BAA+B,CAAC,CAAC;MACzD;MAEA,IAAI;QACF,MAAMC,OAAO,GAAGpD,GAAG,CAACqD,MAAM,CAACnB,KAAK,EAAEK,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC;QACzDO,OAAO,CAACC,GAAG,CAAC,2CAA2C,EAAE;UAAEb,EAAE,EAAEgB,OAAO,CAAChB,EAAE;UAAET,QAAQ,EAAEyB,OAAO,CAACzB;QAAS,CAAC,CAAC;QACxG,MAAME,IAAI,GAAG,MAAMzB,IAAI,CAACkD,QAAQ,CAACF,OAAO,CAAChB,EAAE,CAAC;QAC5CY,OAAO,CAACC,GAAG,CAAC,8CAA8C,EAAEpB,IAAI,GAAG;UAAEO,EAAE,EAAEP,IAAI,CAACQ,GAAG;UAAEN,MAAM,EAAEF,IAAI,CAACE,MAAM;UAAEJ,QAAQ,EAAEE,IAAI,CAACF;QAAS,CAAC,GAAG,MAAM,CAAC;QAE3I,IAAI,CAACE,IAAI,EAAE;UACTmB,OAAO,CAACC,GAAG,CAAC,yDAAyD,CAAC;UACtE,OAAOJ,IAAI,CAAC,IAAIM,KAAK,CAAC,8BAA8B,CAAC,CAAC;QACxD;QAEAH,OAAO,CAACC,GAAG,CAAC,kDAAkD,EAAEpB,IAAI,CAACE,MAAM,CAAC;;QAE5E;QACA,IAAIF,IAAI,CAACE,MAAM,KAAK,SAAS,EAAE;UAC7BiB,OAAO,CAACC,GAAG,CAAC,2DAA2D,CAAC;UACxE,OAAOJ,IAAI,CAAC,IAAIM,KAAK,CAAC,8BAA8B,CAAC,CAAC;QACxD;;QAEA;QACA,MAAMI,MAAM,GAAGH,OAAO,CAAChB,EAAE;QACzB,MAAMoB,eAAe,GAAG,IAAI,CAACrC,eAAe,CAACsC,GAAG,CAACF,MAAM,CAAC,IAAI,CAAC;QAC7D,MAAMG,kBAAkB,GAAGF,eAAe,GAAG,CAAC;QAC9C,IAAI,CAACrC,eAAe,CAACwC,GAAG,CAACJ,MAAM,EAAEG,kBAAkB,CAAC;QAEpDV,OAAO,CAACC,GAAG,CAAC,4CAA4CM,MAAM,iCAAiCG,kBAAkB,EAAE,CAAC;;QAEpH;QACA,MAAME,WAAW,GAAG,MAAMxD,IAAI,CAACyD,gBAAgB,CAC7C;UAAExB,GAAG,EAAEkB;QAAO,CAAC,EACf;UACEO,IAAI,EAAE;YACJ/B,MAAM,EAAE,QAAQ;YAChBgC,UAAU,EAAE,IAAIC,IAAI,CAAC;UACvB;QACF,CAAC,EACD;UAAEC,GAAG,EAAE,IAAI;UAAEC,aAAa,EAAE;QAAK,CACnC,CAAC;QAEDlB,OAAO,CAACC,GAAG,CAAC,6CAA6C,EAAEW,WAAW,GAAG;UAAExB,EAAE,EAAEwB,WAAW,CAACvB,GAAG;UAAEN,MAAM,EAAE6B,WAAW,CAAC7B;QAAO,CAAC,GAAG,MAAM,CAAC;QAEtIa,MAAM,CAACW,MAAM,GAAGH,OAAO,CAAChB,EAAE;QAC1BQ,MAAM,CAACjB,QAAQ,GAAGyB,OAAO,CAACzB,QAAQ;QAClCiB,MAAM,CAACN,IAAI,GAAGc,OAAO,CAACd,IAAI;QAC1BU,OAAO,CAACC,GAAG,CAAC,gEAAgE,EAAEL,MAAM,CAACjB,QAAQ,CAAC;QAC9F,OAAOkB,IAAI,CAAC,CAAC;MACf,CAAC,CAAC,OAAOsB,GAAG,EAAE;QACZnB,OAAO,CAACC,GAAG,CAAC,+CAA+C,EAAEkB,GAAG,CAACxB,OAAO,CAAC;QACzE,OAAOE,IAAI,CAAC,IAAIM,KAAK,CAAC,uBAAuB,CAAC,CAAC;MACjD;IACF,CAAC,CAAC;IAEF,IAAI,CAACtC,EAAE,CAACuD,EAAE,CAAC,YAAY,EAAGxB,MAAM,IAAK;MACnC;MACA,IAAI,CAAC5B,WAAW,CAAC2C,GAAG,CAACf,MAAM,CAACR,EAAE,EAAE;QAC9BmB,MAAM,EAAEX,MAAM,CAACW,MAAM;QACrB5B,QAAQ,EAAEiB,MAAM,CAACjB,QAAQ;QACzBW,IAAI,EAAEM,MAAM,CAACN,IAAI;QACjB+B,IAAI,EAAE;MACR,CAAC,CAAC;MAEFzB,MAAM,CAACwB,EAAE,CAAC,WAAW,EAAE,MAAOE,IAAI,IAAK;QACrC,MAAM;UAAED;QAAK,CAAC,GAAGC,IAAI;QACrB,IAAI,CAACD,IAAI,IAAI,OAAOA,IAAI,KAAK,QAAQ,IAAIA,IAAI,CAACE,IAAI,CAAC,CAAC,CAACC,MAAM,KAAK,CAAC,EAAE;UACjE5B,MAAM,CAAC6B,IAAI,CAAC,OAAO,EAAE;YACnB9B,OAAO,EAAE,mBAAmB;YAC5B+B,IAAI,EAAE;UACR,CAAC,CAAC;UACF;QACF;QAEA,IAAI;UACF,MAAMC,OAAO,GAAG,MAAMtE,OAAO,CAACyB,OAAO,CAAC;YAAEM,EAAE,EAAEiC;UAAK,CAAC,CAAC;UACnD,IAAI,CAACM,OAAO,EAAE;YACZ/B,MAAM,CAAC6B,IAAI,CAAC,OAAO,EAAE;cACnB9B,OAAO,EAAE,YAAY0B,IAAI,aAAa;cACtCK,IAAI,EAAE;YACR,CAAC,CAAC;YACF;UACF;;UAEA;UACA,IAAI9B,MAAM,CAACyB,IAAI,EAAE;YACfzB,MAAM,CAACgC,KAAK,CAAChC,MAAM,CAACyB,IAAI,CAAC;YACzB,IAAI,CAACrD,WAAW,CAAC2C,GAAG,CAACf,MAAM,CAACR,EAAE,EAAE;cAAE,GAAG,IAAI,CAACpB,WAAW,CAACyC,GAAG,CAACb,MAAM,CAACR,EAAE,CAAC;cAAEiC,IAAI,EAAE;YAAK,CAAC,CAAC;UACrF;UAEAzB,MAAM,CAACyB,IAAI,GAAGA,IAAI;UAClBzB,MAAM,CAACiC,IAAI,CAACjC,MAAM,CAACyB,IAAI,CAAC;UAExB,IAAI,CAACrD,WAAW,CAAC2C,GAAG,CAACf,MAAM,CAACR,EAAE,EAAE;YAC9B,GAAG,IAAI,CAACpB,WAAW,CAACyC,GAAG,CAACb,MAAM,CAACR,EAAE,CAAC;YAClCiC,IAAI,EAAEzB,MAAM,CAACyB;UACf,CAAC,CAAC;;UAEF;UACA,MAAMS,WAAW,GAAG,IAAIxE,OAAO,CAAC;YAC9ByE,MAAM,EAAE,QAAQ;YAChBJ,OAAO,EAAE/B,MAAM,CAACyB,IAAI;YACpBW,IAAI,EAAE,GAAGpC,MAAM,CAACjB,QAAQ,sBAAsB;YAC9CsD,IAAI,EAAE;UACR,CAAC,CAAC;UACF,MAAMH,WAAW,CAAC7C,IAAI,CAAC,CAAC;UAExB,IAAI,CAACpB,EAAE,CAACqE,EAAE,CAACtC,MAAM,CAACyB,IAAI,CAAC,CAACI,IAAI,CAAC,SAAS,EAAE;YACtCM,MAAM,EAAED,WAAW,CAACC,MAAM;YAC1BJ,OAAO,EAAEG,WAAW,CAACH,OAAO;YAC5BK,IAAI,EAAEF,WAAW,CAACE,IAAI;YACtBC,IAAI,EAAEH,WAAW,CAACG,IAAI;YACtBE,SAAS,EAAEL,WAAW,CAACK;UACzB,CAAC,CAAC;;UAEF;UACA,MAAMC,SAAS,GAAGC,KAAK,CAACC,IAAI,CAAC,IAAI,CAACtE,WAAW,CAACuE,MAAM,CAAC,CAAC,CAAC,CACpDC,MAAM,CAACC,CAAC,IAAIA,CAAC,CAACpB,IAAI,KAAKzB,MAAM,CAACyB,IAAI,CAAC,CACnCqB,GAAG,CAACD,CAAC,KAAK;YAAE9D,QAAQ,EAAE8D,CAAC,CAAC9D,QAAQ;YAAEW,IAAI,EAAEmD,CAAC,CAACnD;UAAK,CAAC,CAAC,CAAC;UACrD,IAAI,CAACzB,EAAE,CAACqE,EAAE,CAACtC,MAAM,CAACyB,IAAI,CAAC,CAACI,IAAI,CAAC,cAAc,EAAEW,SAAS,CAAC;;UAEvD;UACA,MAAMO,OAAO,GAAG,MAAMrF,OAAO,CAACsF,IAAI,CAAC;YACjCjB,OAAO,EAAE/B,MAAM,CAACyB,IAAI;YACpBwB,GAAG,EAAE,CACH;cAAEZ,IAAI,EAAE;YAAS,CAAC,EAClB;cAAEA,IAAI,EAAE;YAAS,CAAC,EAClB;cAAEF,MAAM,EAAEnC,MAAM,CAACjB;YAAS,CAAC,EAC3B;cAAEmE,MAAM,EAAElD,MAAM,CAACjB;YAAS,CAAC;UAE/B,CAAC,CAAC,CACCoE,IAAI,CAAC;YAAEZ,SAAS,EAAE,CAAC;UAAE,CAAC,CAAC,CACvBa,KAAK,CAAC,GAAG,CAAC,CACVD,IAAI,CAAC;YAAEZ,SAAS,EAAE;UAAE,CAAC,CAAC;UAEzBvC,MAAM,CAAC6B,IAAI,CAAC,SAAS,EAAEkB,OAAO,CAACD,GAAG,CAACO,GAAG,KAAK;YACzClB,MAAM,EAAEkB,GAAG,CAAClB,MAAM;YAClBV,IAAI,EAAE4B,GAAG,CAACtB,OAAO;YACjBK,IAAI,EAAEiB,GAAG,CAACjB,IAAI;YACdC,IAAI,EAAEgB,GAAG,CAAChB,IAAI;YACda,MAAM,EAAEG,GAAG,CAACH,MAAM;YAClBX,SAAS,EAAEc,GAAG,CAACd;UACjB,CAAC,CAAC,CAAC,CAAC;QAEN,CAAC,CAAC,OAAOnD,KAAK,EAAE;UACdY,MAAM,CAAC6B,IAAI,CAAC,OAAO,EAAE;YAAE9B,OAAO,EAAE;UAAsB,CAAC,CAAC;QAC1D;MACF,CAAC,CAAC;MAEFC,MAAM,CAACwB,EAAE,CAAC,SAAS,EAAE,MAAOE,IAAI,IAAK;QACnC,IAAI,CAAC1B,MAAM,CAACyB,IAAI,IAAI,CAACC,IAAI,CAACU,IAAI,EAAET,IAAI,CAAC,CAAC,EAAE;QAExC,IAAI;UACF,MAAM5B,OAAO,GAAG,IAAIrC,OAAO,CAAC;YAC1ByE,MAAM,EAAEnC,MAAM,CAACjB,QAAQ;YACvBgD,OAAO,EAAE/B,MAAM,CAACyB,IAAI;YACpBW,IAAI,EAAEV,IAAI,CAACU,IAAI,CAACT,IAAI,CAAC,CAAC;YACtBU,IAAI,EAAE;UACR,CAAC,CAAC;UAEF,MAAMtC,OAAO,CAACV,IAAI,CAAC,CAAC;UAEpB,MAAMiE,WAAW,GAAG;YAClBnB,MAAM,EAAEpC,OAAO,CAACoC,MAAM;YACtBV,IAAI,EAAE1B,OAAO,CAACgC,OAAO;YACrBK,IAAI,EAAErC,OAAO,CAACqC,IAAI;YAClBG,SAAS,EAAExC,OAAO,CAACwC,SAAS;YAC5BpD,MAAM,EAAE,WAAW;YACnBkD,IAAI,EAAEtC,OAAO,CAACsC;UAChB,CAAC;UAED,IAAI,CAACpE,EAAE,CAACqE,EAAE,CAACtC,MAAM,CAACyB,IAAI,CAAC,CAACI,IAAI,CAAC,SAAS,EAAEyB,WAAW,CAAC;QACtD,CAAC,CAAC,OAAOlE,KAAK,EAAE;UACdY,MAAM,CAAC6B,IAAI,CAAC,OAAO,EAAE;YAAE9B,OAAO,EAAE;UAAyB,CAAC,CAAC;QAC7D;MACF,CAAC,CAAC;MAEFC,MAAM,CAACwB,EAAE,CAAC,iBAAiB,EAAE,MAAOE,IAAI,IAAK;QAC3C,MAAM;UAAEY,EAAE;UAAEF;QAAK,CAAC,GAAGV,IAAI;QACzB,IAAI,CAACY,EAAE,IAAI,CAACF,IAAI,EAAET,IAAI,CAAC,CAAC,EAAE;QAE1B,IAAI;UACF;UACA,MAAM4B,SAAS,GAAG,MAAM/F,IAAI,CAAC0B,OAAO,CAAC;YAAEH,QAAQ,EAAEuD;UAAG,CAAC,CAAC;UACtD,IAAI,CAACiB,SAAS,EAAE;YACdvD,MAAM,CAAC6B,IAAI,CAAC,OAAO,EAAE;cAAE9B,OAAO,EAAE;YAAsB,CAAC,CAAC;YACxD;UACF;;UAEA;UACA,MAAMyD,cAAc,GAAG,IAAI9F,OAAO,CAAC;YACjCyE,MAAM,EAAEnC,MAAM,CAACjB,QAAQ;YACvBmE,MAAM,EAAEZ,EAAE;YACVF,IAAI,EAAEA,IAAI,CAACT,IAAI,CAAC,CAAC;YACjBU,IAAI,EAAE;UACR,CAAC,CAAC;UAEF,MAAMmB,cAAc,CAACnE,IAAI,CAAC,CAAC;UAE3B,MAAMiE,WAAW,GAAG;YAClBnB,MAAM,EAAEqB,cAAc,CAACrB,MAAM;YAC7BC,IAAI,EAAEoB,cAAc,CAACpB,IAAI;YACzBc,MAAM,EAAEM,cAAc,CAACN,MAAM;YAC7BX,SAAS,EAAEiB,cAAc,CAACjB,SAAS;YACnCF,IAAI,EAAE;UACR,CAAC;;UAED;UACA,MAAMoB,aAAa,GAAGhB,KAAK,CAACC,IAAI,CAAC,IAAI,CAACtE,WAAW,CAACuE,MAAM,CAAC,CAAC,CAAC,CAACK,IAAI,CAACH,CAAC,IAAIA,CAAC,CAAC9D,QAAQ,KAAKuD,EAAE,CAAC;UACxF,IAAImB,aAAa,EAAE;YACjB,MAAMC,eAAe,GAAGjB,KAAK,CAACC,IAAI,CAAC,IAAI,CAACtE,WAAW,CAACuF,IAAI,CAAC,CAAC,CAAC,CAACX,IAAI,CAACY,QAAQ,IACvE,IAAI,CAACxF,WAAW,CAACyC,GAAG,CAAC+C,QAAQ,CAAC,CAAC7E,QAAQ,KAAKuD,EAC9C,CAAC;YACD,IAAIoB,eAAe,EAAE;cACnB,IAAI,CAACzF,EAAE,CAACqE,EAAE,CAACoB,eAAe,CAAC,CAAC7B,IAAI,CAAC,iBAAiB,EAAEyB,WAAW,CAAC;YAClE;UACF;;UAEA;UACAtD,MAAM,CAAC6B,IAAI,CAAC,iBAAiB,EAAEyB,WAAW,CAAC;QAE7C,CAAC,CAAC,OAAOlE,KAAK,EAAE;UACdY,MAAM,CAAC6B,IAAI,CAAC,OAAO,EAAE;YAAE9B,OAAO,EAAE;UAAiC,CAAC,CAAC;QACrE;MACF,CAAC,CAAC;MAEFC,MAAM,CAACwB,EAAE,CAAC,UAAU,EAAGE,IAAI,IAAK;QAC9B1B,MAAM,CAACsC,EAAE,CAACtC,MAAM,CAACyB,IAAI,CAAC,CAACI,IAAI,CAAC,UAAU,EAAE;UACtC9C,QAAQ,EAAEiB,MAAM,CAACjB,QAAQ;UACzB8E,QAAQ,EAAEnC,IAAI,CAACmC;QACjB,CAAC,CAAC;MACJ,CAAC,CAAC;MAEF7D,MAAM,CAACwB,EAAE,CAAC,oBAAoB,EAAE,MAAOE,IAAI,IAAK;QAC9C,MAAM;UAAEoC;QAAU,CAAC,GAAGpC,IAAI;QAC1B,IAAI,CAACoC,SAAS,EAAE;QAEhB,IAAI;UACF,MAAM/B,OAAO,GAAG,MAAMtE,OAAO,CAACyB,OAAO,CAAC;YAAEM,EAAE,EAAEsE,SAAS;YAAEzB,IAAI,EAAE;UAAQ,CAAC,CAAC;UACvE,IAAI,CAACN,OAAO,EAAE;YACZ/B,MAAM,CAAC6B,IAAI,CAAC,aAAa,EAAE;cAAE9B,OAAO,EAAE;YAA0B,CAAC,CAAC;YAClE;UACF;UAEA,IAAI,CAAC,IAAI,CAACzB,aAAa,CAACyF,GAAG,CAACD,SAAS,CAAC,EAAE;YACtC,IAAI,CAACxF,aAAa,CAACyC,GAAG,CAAC+C,SAAS,EAAE,IAAIzF,GAAG,CAAC,CAAC,CAAC;UAC9C;UAEA2B,MAAM,CAACsC,EAAE,CAACwB,SAAS,CAAC,CAACjC,IAAI,CAAC,mBAAmB,EAAE;YAC7C9C,QAAQ,EAAEiB,MAAM,CAACjB,QAAQ;YACzB6E,QAAQ,EAAE5D,MAAM,CAACR;UACnB,CAAC,CAAC;UAEFQ,MAAM,CAACiC,IAAI,CAAC6B,SAAS,CAAC;UACtB,IAAI,CAACxF,aAAa,CAACuC,GAAG,CAACiD,SAAS,CAAC,CAAC/C,GAAG,CAACf,MAAM,CAACR,EAAE,EAAE;YAAEwE,cAAc,EAAE,IAAI;YAAEC,MAAM,EAAE;UAAK,CAAC,CAAC;UAExFjE,MAAM,CAACkE,YAAY,GAAGJ,SAAS;UAC/B9D,MAAM,CAAC6B,IAAI,CAAC,cAAc,EAAE;YAAEiC;UAAU,CAAC,CAAC;QAE5C,CAAC,CAAC,OAAO1E,KAAK,EAAE;UACdY,MAAM,CAAC6B,IAAI,CAAC,aAAa,EAAE;YAAE9B,OAAO,EAAE;UAA+B,CAAC,CAAC;QACzE;MACF,CAAC,CAAC;MAEFC,MAAM,CAACwB,EAAE,CAAC,qBAAqB,EAAE,MAAM;QACrC,IAAI,CAACxB,MAAM,CAACkE,YAAY,EAAE;QAE1B,MAAMJ,SAAS,GAAG9D,MAAM,CAACkE,YAAY;QACrC,MAAMC,YAAY,GAAG,IAAI,CAAC7F,aAAa,CAACuC,GAAG,CAACiD,SAAS,CAAC;QAEtD,IAAIK,YAAY,EAAE;UAChBA,YAAY,CAACC,MAAM,CAACpE,MAAM,CAACR,EAAE,CAAC;UAC9B,IAAI2E,YAAY,CAACE,IAAI,KAAK,CAAC,EAAE;YAC3B,IAAI,CAAC/F,aAAa,CAAC8F,MAAM,CAACN,SAAS,CAAC;UACtC;QACF;QAEA9D,MAAM,CAACsC,EAAE,CAACwB,SAAS,CAAC,CAACjC,IAAI,CAAC,iBAAiB,EAAE;UAC3C9C,QAAQ,EAAEiB,MAAM,CAACjB,QAAQ;UACzB6E,QAAQ,EAAE5D,MAAM,CAACR;QACnB,CAAC,CAAC;QAEFQ,MAAM,CAACgC,KAAK,CAAC8B,SAAS,CAAC;QACvB9D,MAAM,CAACkE,YAAY,GAAG,IAAI;QAC1BlE,MAAM,CAAC6B,IAAI,CAAC,YAAY,CAAC;MAC3B,CAAC,CAAC;;MAEF;MACA7B,MAAM,CAACwB,EAAE,CAAC,aAAa,EAAGE,IAAI,IAAK;QACjC,MAAM;UAAE4C,KAAK;UAAEC;QAAe,CAAC,GAAG7C,IAAI;QACtC1B,MAAM,CAACsC,EAAE,CAACiC,cAAc,CAAC,CAAC1C,IAAI,CAAC,aAAa,EAAE;UAC5CyC,KAAK;UACL5B,IAAI,EAAE1C,MAAM,CAACR,EAAE;UACfgF,YAAY,EAAExE,MAAM,CAACjB;QACvB,CAAC,CAAC;MACJ,CAAC,CAAC;MAEFiB,MAAM,CAACwB,EAAE,CAAC,cAAc,EAAGE,IAAI,IAAK;QAClC,MAAM;UAAE+C,MAAM;UAAEF;QAAe,CAAC,GAAG7C,IAAI;QACvC1B,MAAM,CAACsC,EAAE,CAACiC,cAAc,CAAC,CAAC1C,IAAI,CAAC,cAAc,EAAE;UAC7C4C,MAAM;UACN/B,IAAI,EAAE1C,MAAM,CAACR,EAAE;UACfgF,YAAY,EAAExE,MAAM,CAACjB;QACvB,CAAC,CAAC;MACJ,CAAC,CAAC;MAEFiB,MAAM,CAACwB,EAAE,CAAC,eAAe,EAAGE,IAAI,IAAK;QACnC,MAAM;UAAEgD,SAAS;UAAEH;QAAe,CAAC,GAAG7C,IAAI;QAC1C1B,MAAM,CAACsC,EAAE,CAACiC,cAAc,CAAC,CAAC1C,IAAI,CAAC,eAAe,EAAE;UAC9C6C,SAAS;UACThC,IAAI,EAAE1C,MAAM,CAACR,EAAE;UACfgF,YAAY,EAAExE,MAAM,CAACjB;QACvB,CAAC,CAAC;MACJ,CAAC,CAAC;MAEFiB,MAAM,CAACwB,EAAE,CAAC,YAAY,EAAE,YAAY;QAClC;QACA,MAAMb,MAAM,GAAGX,MAAM,CAACW,MAAM;QAC5B,IAAIA,MAAM,EAAE;UACV,MAAMgE,YAAY,GAAG,IAAI,CAACpG,eAAe,CAACsC,GAAG,CAACF,MAAM,CAAC,IAAI,CAAC;UAC1D,MAAMiE,QAAQ,GAAGC,IAAI,CAACC,GAAG,CAAC,CAAC,EAAEH,YAAY,GAAG,CAAC,CAAC;UAC9C,IAAI,CAACpG,eAAe,CAACwC,GAAG,CAACJ,MAAM,EAAEiE,QAAQ,CAAC;;UAE1C;UACA,IAAIA,QAAQ,KAAK,CAAC,EAAE;YAClB,MAAMpH,IAAI,CAACuH,iBAAiB,CAACpE,MAAM,EAAE;cACnCxB,MAAM,EAAE,SAAS;cACjBgC,UAAU,EAAE,IAAIC,IAAI,CAAC;YACvB,CAAC,CAAC;UACJ;QACF;;QAEA;QACA,IAAIpB,MAAM,CAACkE,YAAY,EAAE;UACvB,MAAMJ,SAAS,GAAG9D,MAAM,CAACkE,YAAY;UACrC,MAAMC,YAAY,GAAG,IAAI,CAAC7F,aAAa,CAACuC,GAAG,CAACiD,SAAS,CAAC;UAEtD,IAAIK,YAAY,EAAE;YAChBA,YAAY,CAACC,MAAM,CAACpE,MAAM,CAACR,EAAE,CAAC;YAC9B,IAAI2E,YAAY,CAACE,IAAI,KAAK,CAAC,EAAE;cAC3B,IAAI,CAAC/F,aAAa,CAAC8F,MAAM,CAACN,SAAS,CAAC;YACtC;UACF;UAEA9D,MAAM,CAACsC,EAAE,CAACwB,SAAS,CAAC,CAACjC,IAAI,CAAC,iBAAiB,EAAE;YAC3C9C,QAAQ,EAAEiB,MAAM,CAACjB,QAAQ;YACzB6E,QAAQ,EAAE5D,MAAM,CAACR;UACnB,CAAC,CAAC;QACJ;QAEA,IAAIQ,MAAM,CAACyB,IAAI,EAAE;UACfzB,MAAM,CAACgC,KAAK,CAAChC,MAAM,CAACyB,IAAI,CAAC;UAEzB,MAAMuD,YAAY,GAAG,IAAItH,OAAO,CAAC;YAC/ByE,MAAM,EAAE,QAAQ;YAChBJ,OAAO,EAAE/B,MAAM,CAACyB,IAAI;YACpBW,IAAI,EAAE,GAAGpC,MAAM,CAACjB,QAAQ,oBAAoB;YAC5CsD,IAAI,EAAE;UACR,CAAC,CAAC;UACF,MAAM2C,YAAY,CAAC3F,IAAI,CAAC,CAAC;UAEzB,IAAI,CAACpB,EAAE,CAACqE,EAAE,CAACtC,MAAM,CAACyB,IAAI,CAAC,CAACI,IAAI,CAAC,SAAS,EAAE;YACtCM,MAAM,EAAE6C,YAAY,CAAC7C,MAAM;YAC3BV,IAAI,EAAEuD,YAAY,CAACjD,OAAO;YAC1BK,IAAI,EAAE4C,YAAY,CAAC5C,IAAI;YACvBC,IAAI,EAAE2C,YAAY,CAAC3C,IAAI;YACvBE,SAAS,EAAEyC,YAAY,CAACzC;UAC1B,CAAC,CAAC;UAEF,MAAMC,SAAS,GAAGC,KAAK,CAACC,IAAI,CAAC,IAAI,CAACtE,WAAW,CAACuE,MAAM,CAAC,CAAC,CAAC,CACpDC,MAAM,CAACC,CAAC,IAAIA,CAAC,CAACpB,IAAI,KAAKzB,MAAM,CAACyB,IAAI,IAAIoB,CAAC,CAAClC,MAAM,KAAKX,MAAM,CAACW,MAAM,CAAC,CACjEmC,GAAG,CAACD,CAAC,KAAK;YAAE9D,QAAQ,EAAE8D,CAAC,CAAC9D,QAAQ;YAAEW,IAAI,EAAEmD,CAAC,CAACnD;UAAK,CAAC,CAAC,CAAC;UACrD,IAAI,CAACzB,EAAE,CAACqE,EAAE,CAACtC,MAAM,CAACyB,IAAI,CAAC,CAACI,IAAI,CAAC,cAAc,EAAEW,SAAS,CAAC;QACzD;QAEA,IAAI,CAACpE,WAAW,CAACgG,MAAM,CAACpE,MAAM,CAACR,EAAE,CAAC;MACpC,CAAC,CAAC;IACJ,CAAC,CAAC;EACJ;EAEA,MAAMyF,KAAKA,CAAA,EAAG;IACZ7E,OAAO,CAACC,GAAG,CAAC,kCAAkC,IAAI,CAACxC,IAAI,KAAK,CAAC;IAC7D,OAAO,IAAIqH,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;MACtC,MAAMC,OAAO,GAAGC,UAAU,CAAC,MAAM;QAC/BF,MAAM,CAAC,IAAI7E,KAAK,CAAC,yCAAyC,CAAC,CAAC;MAC9D,CAAC,EAAE,KAAK,CAAC;MAET,IAAI,CAACxC,MAAM,CAACwH,MAAM,CAAC,IAAI,CAAC1H,IAAI,EAAG0D,GAAG,IAAK;QACrCiE,YAAY,CAACH,OAAO,CAAC;QACrB,IAAI9D,GAAG,EAAE;UACPnB,OAAO,CAAChB,KAAK,CAAC,gCAAgC,EAAEmC,GAAG,CAACxB,OAAO,CAAC;UAC5DqF,MAAM,CAAC7D,GAAG,CAAC;QACb,CAAC,MAAM;UACL,MAAMkE,YAAY,GAAG,IAAI,CAAC1H,MAAM,CAAC2H,OAAO,CAAC,CAAC,CAAC7H,IAAI;UAC/CuC,OAAO,CAACC,GAAG,CAAC,8CAA8CoF,YAAY,EAAE,CAAC;UACzEN,OAAO,CAACM,YAAY,CAAC;QACvB;MACF,CAAC,CAAC;IACJ,CAAC,CAAC;EACJ;EAEA,MAAME,IAAIA,CAAA,EAAG;IACX,OAAO,IAAIT,OAAO,CAAEC,OAAO,IAAK;MAC9B,IAAI,CAACpH,MAAM,CAAC6H,KAAK,CAAC,MAAM;QACtB,IAAI,CAACxH,WAAW,CAACyH,KAAK,CAAC,CAAC;QACxB,IAAI,CAACvH,aAAa,CAACuH,KAAK,CAAC,CAAC;QAC1BV,OAAO,CAAC,CAAC;MACX,CAAC,CAAC;IACJ,CAAC,CAAC;EACJ;EAEAW,OAAOA,CAAA,EAAG;IACR,OAAO,IAAI,CAAC/H,MAAM,CAAC2H,OAAO,CAAC,CAAC,EAAE7H,IAAI;EACpC;AACF;AAEAkI,QAAQ,CAAC,8BAA8B,EAAE,MAAM;EAC7CC,EAAE,CAAC,0DAA0D,EAAE,MAAM;IACnEC,MAAM,CAAC,CAAC,CAAC,CAACC,IAAI,CAAC,CAAC,CAAC;EACnB,CAAC,CAAC;AACJ,CAAC,CAAC;AAEFC,MAAM,CAACC,OAAO,GAAGzI,gBAAgB","ignoreList":[]}