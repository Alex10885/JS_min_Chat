{"version":3,"names":["cov_22vlcxzn2h","actualCoverage","MongoStore","s","require","config","sessionConfig","secret","security","sessionSecret","resave","saveUninitialized","store","create","mongoUrl","database","mongoUri","collectionName","ttl","autoRemove","touchAfter","cookie","secure","server","nodeEnv","httpOnly","maxAge","sameSite","name","rolling","rollingExpire","unset","module","exports"],"sources":["session.js"],"sourcesContent":["const MongoStore = require('connect-mongo');\nconst config = require('./index');\n\nconst sessionConfig = {\n  secret: config.security.sessionSecret,\n  resave: false,\n  saveUninitialized: false,\n  store: MongoStore.create({\n    mongoUrl: config.database.mongoUri,\n    collectionName: 'sessions',\n    ttl: 24 * 60 * 60, // 1 day in seconds\n    autoRemove: 'native',\n    touchAfter: 1 * 3600 // Limit session saves to every 1 hour to reduce DB load\n  }),\n  cookie: {\n    secure: config.server.nodeEnv === 'production', // HTTPS only in production\n    httpOnly: true, // Prevent XSS access to cookie\n    maxAge: 2 * 60 * 60 * 1000, // 2 hours active session time\n    sameSite: 'strict' // Enhanced CSRF protection - stricter than 'lax'\n  },\n  name: 'chatSession', // Custom name to avoid default 'connect.sid'\n  rolling: true, // Extend cookie expiration on each request (sliding expiration)\n  rollingExpire: 2 * 60 * 60 * 1000, // Reset maxAge to 2 hours on activity\n  unset: 'destroy' // Destroy session on logout\n};\n\nmodule.exports = sessionConfig;"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAeY;IAAAA,cAAA,YAAAA,CAAA;MAAA,OAAAC,cAAA;IAAA;EAAA;EAAA,OAAAA,cAAA;AAAA;AAAAD,cAAA;AAfZ,MAAME,UAAU;AAAA;AAAA,CAAAF,cAAA,GAAAG,CAAA,OAAGC,OAAO,CAAC,eAAe,CAAC;AAC3C,MAAMC,MAAM;AAAA;AAAA,CAAAL,cAAA,GAAAG,CAAA,OAAGC,OAAO,CAAC,SAAS,CAAC;AAEjC,MAAME,aAAa;AAAA;AAAA,CAAAN,cAAA,GAAAG,CAAA,OAAG;EACpBI,MAAM,EAAEF,MAAM,CAACG,QAAQ,CAACC,aAAa;EACrCC,MAAM,EAAE,KAAK;EACbC,iBAAiB,EAAE,KAAK;EACxBC,KAAK,EAAEV,UAAU,CAACW,MAAM,CAAC;IACvBC,QAAQ,EAAET,MAAM,CAACU,QAAQ,CAACC,QAAQ;IAClCC,cAAc,EAAE,UAAU;IAC1BC,GAAG,EAAE,EAAE,GAAG,EAAE,GAAG,EAAE;IAAE;IACnBC,UAAU,EAAE,QAAQ;IACpBC,UAAU,EAAE,CAAC,GAAG,IAAI,CAAC;EACvB,CAAC,CAAC;EACFC,MAAM,EAAE;IACNC,MAAM,EAAEjB,MAAM,CAACkB,MAAM,CAACC,OAAO,KAAK,YAAY;IAAE;IAChDC,QAAQ,EAAE,IAAI;IAAE;IAChBC,MAAM,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,IAAI;IAAE;IAC5BC,QAAQ,EAAE,QAAQ,CAAC;EACrB,CAAC;EACDC,IAAI,EAAE,aAAa;EAAE;EACrBC,OAAO,EAAE,IAAI;EAAE;EACfC,aAAa,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,IAAI;EAAE;EACnCC,KAAK,EAAE,SAAS,CAAC;AACnB,CAAC;AAAC;AAAA/B,cAAA,GAAAG,CAAA;AAEF6B,MAAM,CAACC,OAAO,GAAG3B,aAAa","ignoreList":[]}