a0896731458034d69bcefc74fb458ebf
/* istanbul ignore next */
function cov_8huahnvr1() {
  var path = "/home/raerlim/Chat-JS/backend/services/emailService.js";
  var hash = "6a8328c386e0108747007f056e1789c64ab81ad2";
  var global = new Function("return this")();
  var gcv = "__coverage__";
  var coverageData = {
    path: "/home/raerlim/Chat-JS/backend/services/emailService.js",
    statementMap: {
      "0": {
        start: {
          line: 1,
          column: 19
        },
        end: {
          line: 1,
          column: 40
        }
      },
      "1": {
        start: {
          line: 5,
          column: 4
        },
        end: {
          line: 13,
          column: 7
        }
      },
      "2": {
        start: {
          line: 17,
          column: 21
        },
        end: {
          line: 17,
          column: 106
        }
      },
      "3": {
        start: {
          line: 19,
          column: 24
        },
        end: {
          line: 83,
          column: 5
        }
      },
      "4": {
        start: {
          line: 85,
          column: 4
        },
        end: {
          line: 92,
          column: 5
        }
      },
      "5": {
        start: {
          line: 86,
          column: 19
        },
        end: {
          line: 86,
          column: 63
        }
      },
      "6": {
        start: {
          line: 87,
          column: 6
        },
        end: {
          line: 87,
          column: 64
        }
      },
      "7": {
        start: {
          line: 88,
          column: 6
        },
        end: {
          line: 88,
          column: 58
        }
      },
      "8": {
        start: {
          line: 90,
          column: 6
        },
        end: {
          line: 90,
          column: 66
        }
      },
      "9": {
        start: {
          line: 91,
          column: 6
        },
        end: {
          line: 91,
          column: 18
        }
      },
      "10": {
        start: {
          line: 96,
          column: 24
        },
        end: {
          line: 147,
          column: 5
        }
      },
      "11": {
        start: {
          line: 149,
          column: 4
        },
        end: {
          line: 156,
          column: 5
        }
      },
      "12": {
        start: {
          line: 150,
          column: 19
        },
        end: {
          line: 150,
          column: 63
        }
      },
      "13": {
        start: {
          line: 151,
          column: 6
        },
        end: {
          line: 151,
          column: 72
        }
      },
      "14": {
        start: {
          line: 152,
          column: 6
        },
        end: {
          line: 152,
          column: 58
        }
      },
      "15": {
        start: {
          line: 154,
          column: 6
        },
        end: {
          line: 154,
          column: 74
        }
      },
      "16": {
        start: {
          line: 155,
          column: 6
        },
        end: {
          line: 155,
          column: 18
        }
      },
      "17": {
        start: {
          line: 160,
          column: 0
        },
        end: {
          line: 160,
          column: 36
        }
      }
    },
    fnMap: {
      "0": {
        name: "(anonymous_0)",
        decl: {
          start: {
            line: 4,
            column: 2
          },
          end: {
            line: 4,
            column: 3
          }
        },
        loc: {
          start: {
            line: 4,
            column: 16
          },
          end: {
            line: 14,
            column: 3
          }
        },
        line: 4
      },
      "1": {
        name: "(anonymous_1)",
        decl: {
          start: {
            line: 16,
            column: 2
          },
          end: {
            line: 16,
            column: 3
          }
        },
        loc: {
          start: {
            line: 16,
            column: 50
          },
          end: {
            line: 93,
            column: 3
          }
        },
        line: 16
      },
      "2": {
        name: "(anonymous_2)",
        decl: {
          start: {
            line: 95,
            column: 2
          },
          end: {
            line: 95,
            column: 3
          }
        },
        loc: {
          start: {
            line: 95,
            column: 45
          },
          end: {
            line: 157,
            column: 3
          }
        },
        line: 95
      }
    },
    branchMap: {
      "0": {
        loc: {
          start: {
            line: 6,
            column: 12
          },
          end: {
            line: 6,
            column: 53
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 6,
            column: 12
          },
          end: {
            line: 6,
            column: 33
          }
        }, {
          start: {
            line: 6,
            column: 37
          },
          end: {
            line: 6,
            column: 53
          }
        }],
        line: 6
      },
      "1": {
        loc: {
          start: {
            line: 7,
            column: 12
          },
          end: {
            line: 7,
            column: 40
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 7,
            column: 12
          },
          end: {
            line: 7,
            column: 33
          }
        }, {
          start: {
            line: 7,
            column: 37
          },
          end: {
            line: 7,
            column: 40
          }
        }],
        line: 7
      },
      "2": {
        loc: {
          start: {
            line: 17,
            column: 24
          },
          end: {
            line: 17,
            column: 75
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 17,
            column: 24
          },
          end: {
            line: 17,
            column: 48
          }
        }, {
          start: {
            line: 17,
            column: 52
          },
          end: {
            line: 17,
            column: 75
          }
        }],
        line: 17
      }
    },
    s: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0,
      "10": 0,
      "11": 0,
      "12": 0,
      "13": 0,
      "14": 0,
      "15": 0,
      "16": 0,
      "17": 0
    },
    f: {
      "0": 0,
      "1": 0,
      "2": 0
    },
    b: {
      "0": [0, 0],
      "1": [0, 0],
      "2": [0, 0]
    },
    _coverageSchema: "1a1c01bbd47fc00a2c39e90264f33305004495a9",
    hash: "6a8328c386e0108747007f056e1789c64ab81ad2"
  };
  var coverage = global[gcv] || (global[gcv] = {});
  if (!coverage[path] || coverage[path].hash !== hash) {
    coverage[path] = coverageData;
  }
  var actualCoverage = coverage[path];
  {
    // @ts-ignore
    cov_8huahnvr1 = function () {
      return actualCoverage;
    };
  }
  return actualCoverage;
}
cov_8huahnvr1();
const nodemailer =
/* istanbul ignore next */
(cov_8huahnvr1().s[0]++, require('nodemailer'));
class EmailService {
  constructor() {
    /* istanbul ignore next */
    cov_8huahnvr1().f[0]++;
    cov_8huahnvr1().s[1]++;
    this.transporter = nodemailer.createTransport({
      host:
      /* istanbul ignore next */
      (cov_8huahnvr1().b[0][0]++, process.env.SMTP_HOST) ||
      /* istanbul ignore next */
      (cov_8huahnvr1().b[0][1]++, 'smtp.gmail.com'),
      port:
      /* istanbul ignore next */
      (cov_8huahnvr1().b[1][0]++, process.env.SMTP_PORT) ||
      /* istanbul ignore next */
      (cov_8huahnvr1().b[1][1]++, 587),
      secure: false,
      // true for 465, false for other ports
      auth: {
        user: process.env.SMTP_USER,
        pass: process.env.SMTP_PASS
      }
    });
  }
  async sendPasswordResetEmail(email, resetToken) {
    /* istanbul ignore next */
    cov_8huahnvr1().f[1]++;
    const resetUrl =
    /* istanbul ignore next */
    (cov_8huahnvr1().s[2]++, `${
    /* istanbul ignore next */
    (cov_8huahnvr1().b[2][0]++, process.env.FRONTEND_URL) ||
    /* istanbul ignore next */
    (cov_8huahnvr1().b[2][1]++, 'http://localhost:3000')}/reset-password/${resetToken}`);
    const mailOptions =
    /* istanbul ignore next */
    (cov_8huahnvr1().s[3]++, {
      from: {
        name: 'Chat-JS Support',
        address: process.env.SMTP_USER
      },
      to: email,
      subject: 'Password Reset Request - Chat-JS',
      html: `
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>Password Reset</title>
            <style>
                body { font-family: Arial, sans-serif; line-height: 1.6; color: #333; }
                .container { max-width: 600px; margin: 0 auto; padding: 20px; }
                .header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 10px 10px 0 0; }
                .content { background: #f8f9fa; padding: 20px; border: 1px solid #dee2e6; }
                .button { display: inline-block; padding: 12px 24px; background: #007bff; color: white; text-decoration: none; border-radius: 5px; margin: 20px 0; }
                .footer { background: #6c757d; color: white; padding: 20px; border-radius: 0 0 10px 10px; font-size: 12px; }
            </style>
        </head>
        <body>
            <div class="container">
                <div class="header">
                    <h2>Password Reset Request</h2>
                </div>
                <div class="content">
                    <p>You have requested to reset your password for your Chat-JS account.</p>
                    <p>Please click the button below to reset your password:</p>

                    <a href="${resetUrl}" class="button">Reset Password</a>

                    <p><strong>This link will expire in 1 hour.</strong></p>

                    <p>If you did not request this password reset, please ignore this email.</p>

                    <p>For security reasons, this link can only be used once.</p>
                </div>
                <div class="footer">
                    <p>If the button doesn't work, copy and paste this URL into your browser:</p>
                    <p>${resetUrl}</p>
                    <p>&copy; 2024 Chat-JS. All rights reserved.</p>
                </div>
            </div>
        </body>
        </html>
      `,
      text: `
        Password Reset Request - Chat-JS

        You have requested to reset your password.

        Please use the following link to reset your password:
        ${resetUrl}

        This link will expire in 1 hour.

        If you did not request this password reset, please ignore this email.

        Best regards,
        Chat-JS Support Team
      `
    });
    /* istanbul ignore next */
    cov_8huahnvr1().s[4]++;
    try {
      const info =
      /* istanbul ignore next */
      (cov_8huahnvr1().s[5]++, await this.transporter.sendMail(mailOptions));
      /* istanbul ignore next */
      cov_8huahnvr1().s[6]++;
      console.log('Password reset email sent:', info.messageId);
      /* istanbul ignore next */
      cov_8huahnvr1().s[7]++;
      return {
        success: true,
        messageId: info.messageId
      };
    } catch (error) {
      /* istanbul ignore next */
      cov_8huahnvr1().s[8]++;
      console.error('Error sending password reset email:', error);
      /* istanbul ignore next */
      cov_8huahnvr1().s[9]++;
      throw error;
    }
  }
  async sendPasswordResetSuccessEmail(email) {
    /* istanbul ignore next */
    cov_8huahnvr1().f[2]++;
    const mailOptions =
    /* istanbul ignore next */
    (cov_8huahnvr1().s[10]++, {
      from: {
        name: 'Chat-JS Support',
        address: process.env.SMTP_USER
      },
      to: email,
      subject: 'Password Reset Successful - Chat-JS',
      html: `
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>Password Reset Successful</title>
            <style>
                body { font-family: Arial, sans-serif; line-height: 1.6; color: #333; }
                .container { max-width: 600px; margin: 0 auto; padding: 20px; }
                .header { background: linear-gradient(135deg, #28a745 0%, #20c997 100%); color: white; padding: 20px; border-radius: 10px 10px 0 0; }
                .content { background: #f8f9fa; padding: 20px; border: 1px solid #dee2e6; }
                .footer { background: #6c757d; color: white; padding: 20px; border-radius: 0 0 10px 10px; font-size: 12px; }
            </style>
        </head>
        <body>
            <div class="container">
                <div class="header">
                    <h2>Password Reset Successful</h2>
                </div>
                <div class="content">
                    <p>Your password has been successfully reset!</p>
                    <p>You can now sign in to your Chat-JS account with your new password.</p>
                    <p>If you did not make this change, please contact our support team immediately.</p>
                </div>
                <div class="footer">
                    <p>&copy; 2024 Chat-JS. All rights reserved.</p>
                </div>
            </div>
        </body>
        </html>
      `,
      text: `
        Password Reset Successful - Chat-JS

        Your password has been successfully reset!

        You can now sign in to your Chat-JS account with your new password.

        If you did not make this change, please contact our support team immediately.

        Best regards,
        Chat-JS Support Team
      `
    });
    /* istanbul ignore next */
    cov_8huahnvr1().s[11]++;
    try {
      const info =
      /* istanbul ignore next */
      (cov_8huahnvr1().s[12]++, await this.transporter.sendMail(mailOptions));
      /* istanbul ignore next */
      cov_8huahnvr1().s[13]++;
      console.log('Password reset success email sent:', info.messageId);
      /* istanbul ignore next */
      cov_8huahnvr1().s[14]++;
      return {
        success: true,
        messageId: info.messageId
      };
    } catch (error) {
      /* istanbul ignore next */
      cov_8huahnvr1().s[15]++;
      console.error('Error sending password reset success email:', error);
      /* istanbul ignore next */
      cov_8huahnvr1().s[16]++;
      throw error;
    }
  }
}
/* istanbul ignore next */
cov_8huahnvr1().s[17]++;
module.exports = new EmailService();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfOGh1YWhudnIxIiwiYWN0dWFsQ292ZXJhZ2UiLCJub2RlbWFpbGVyIiwicyIsInJlcXVpcmUiLCJFbWFpbFNlcnZpY2UiLCJjb25zdHJ1Y3RvciIsImYiLCJ0cmFuc3BvcnRlciIsImNyZWF0ZVRyYW5zcG9ydCIsImhvc3QiLCJiIiwicHJvY2VzcyIsImVudiIsIlNNVFBfSE9TVCIsInBvcnQiLCJTTVRQX1BPUlQiLCJzZWN1cmUiLCJhdXRoIiwidXNlciIsIlNNVFBfVVNFUiIsInBhc3MiLCJTTVRQX1BBU1MiLCJzZW5kUGFzc3dvcmRSZXNldEVtYWlsIiwiZW1haWwiLCJyZXNldFRva2VuIiwicmVzZXRVcmwiLCJGUk9OVEVORF9VUkwiLCJtYWlsT3B0aW9ucyIsImZyb20iLCJuYW1lIiwiYWRkcmVzcyIsInRvIiwic3ViamVjdCIsImh0bWwiLCJ0ZXh0IiwiaW5mbyIsInNlbmRNYWlsIiwiY29uc29sZSIsImxvZyIsIm1lc3NhZ2VJZCIsInN1Y2Nlc3MiLCJlcnJvciIsInNlbmRQYXNzd29yZFJlc2V0U3VjY2Vzc0VtYWlsIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbImVtYWlsU2VydmljZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBub2RlbWFpbGVyID0gcmVxdWlyZSgnbm9kZW1haWxlcicpO1xuXG5jbGFzcyBFbWFpbFNlcnZpY2Uge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLnRyYW5zcG9ydGVyID0gbm9kZW1haWxlci5jcmVhdGVUcmFuc3BvcnQoe1xuICAgICAgaG9zdDogcHJvY2Vzcy5lbnYuU01UUF9IT1NUIHx8ICdzbXRwLmdtYWlsLmNvbScsXG4gICAgICBwb3J0OiBwcm9jZXNzLmVudi5TTVRQX1BPUlQgfHwgNTg3LFxuICAgICAgc2VjdXJlOiBmYWxzZSwgLy8gdHJ1ZSBmb3IgNDY1LCBmYWxzZSBmb3Igb3RoZXIgcG9ydHNcbiAgICAgIGF1dGg6IHtcbiAgICAgICAgdXNlcjogcHJvY2Vzcy5lbnYuU01UUF9VU0VSLFxuICAgICAgICBwYXNzOiBwcm9jZXNzLmVudi5TTVRQX1BBU1NcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIGFzeW5jIHNlbmRQYXNzd29yZFJlc2V0RW1haWwoZW1haWwsIHJlc2V0VG9rZW4pIHtcbiAgICBjb25zdCByZXNldFVybCA9IGAke3Byb2Nlc3MuZW52LkZST05URU5EX1VSTCB8fCAnaHR0cDovL2xvY2FsaG9zdDozMDAwJ30vcmVzZXQtcGFzc3dvcmQvJHtyZXNldFRva2VufWA7XG5cbiAgICBjb25zdCBtYWlsT3B0aW9ucyA9IHtcbiAgICAgIGZyb206IHtcbiAgICAgICAgbmFtZTogJ0NoYXQtSlMgU3VwcG9ydCcsXG4gICAgICAgIGFkZHJlc3M6IHByb2Nlc3MuZW52LlNNVFBfVVNFUlxuICAgICAgfSxcbiAgICAgIHRvOiBlbWFpbCxcbiAgICAgIHN1YmplY3Q6ICdQYXNzd29yZCBSZXNldCBSZXF1ZXN0IC0gQ2hhdC1KUycsXG4gICAgICBodG1sOiBgXG4gICAgICAgIDwhRE9DVFlQRSBodG1sPlxuICAgICAgICA8aHRtbCBsYW5nPVwiZW5cIj5cbiAgICAgICAgPGhlYWQ+XG4gICAgICAgICAgICA8bWV0YSBjaGFyc2V0PVwiVVRGLThcIj5cbiAgICAgICAgICAgIDxtZXRhIG5hbWU9XCJ2aWV3cG9ydFwiIGNvbnRlbnQ9XCJ3aWR0aD1kZXZpY2Utd2lkdGgsIGluaXRpYWwtc2NhbGU9MS4wXCI+XG4gICAgICAgICAgICA8dGl0bGU+UGFzc3dvcmQgUmVzZXQ8L3RpdGxlPlxuICAgICAgICAgICAgPHN0eWxlPlxuICAgICAgICAgICAgICAgIGJvZHkgeyBmb250LWZhbWlseTogQXJpYWwsIHNhbnMtc2VyaWY7IGxpbmUtaGVpZ2h0OiAxLjY7IGNvbG9yOiAjMzMzOyB9XG4gICAgICAgICAgICAgICAgLmNvbnRhaW5lciB7IG1heC13aWR0aDogNjAwcHg7IG1hcmdpbjogMCBhdXRvOyBwYWRkaW5nOiAyMHB4OyB9XG4gICAgICAgICAgICAgICAgLmhlYWRlciB7IGJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCgxMzVkZWcsICM2NjdlZWEgMCUsICM3NjRiYTIgMTAwJSk7IGNvbG9yOiB3aGl0ZTsgcGFkZGluZzogMjBweDsgYm9yZGVyLXJhZGl1czogMTBweCAxMHB4IDAgMDsgfVxuICAgICAgICAgICAgICAgIC5jb250ZW50IHsgYmFja2dyb3VuZDogI2Y4ZjlmYTsgcGFkZGluZzogMjBweDsgYm9yZGVyOiAxcHggc29saWQgI2RlZTJlNjsgfVxuICAgICAgICAgICAgICAgIC5idXR0b24geyBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IHBhZGRpbmc6IDEycHggMjRweDsgYmFja2dyb3VuZDogIzAwN2JmZjsgY29sb3I6IHdoaXRlOyB0ZXh0LWRlY29yYXRpb246IG5vbmU7IGJvcmRlci1yYWRpdXM6IDVweDsgbWFyZ2luOiAyMHB4IDA7IH1cbiAgICAgICAgICAgICAgICAuZm9vdGVyIHsgYmFja2dyb3VuZDogIzZjNzU3ZDsgY29sb3I6IHdoaXRlOyBwYWRkaW5nOiAyMHB4OyBib3JkZXItcmFkaXVzOiAwIDAgMTBweCAxMHB4OyBmb250LXNpemU6IDEycHg7IH1cbiAgICAgICAgICAgIDwvc3R5bGU+XG4gICAgICAgIDwvaGVhZD5cbiAgICAgICAgPGJvZHk+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwiY29udGFpbmVyXCI+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImhlYWRlclwiPlxuICAgICAgICAgICAgICAgICAgICA8aDI+UGFzc3dvcmQgUmVzZXQgUmVxdWVzdDwvaDI+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImNvbnRlbnRcIj5cbiAgICAgICAgICAgICAgICAgICAgPHA+WW91IGhhdmUgcmVxdWVzdGVkIHRvIHJlc2V0IHlvdXIgcGFzc3dvcmQgZm9yIHlvdXIgQ2hhdC1KUyBhY2NvdW50LjwvcD5cbiAgICAgICAgICAgICAgICAgICAgPHA+UGxlYXNlIGNsaWNrIHRoZSBidXR0b24gYmVsb3cgdG8gcmVzZXQgeW91ciBwYXNzd29yZDo8L3A+XG5cbiAgICAgICAgICAgICAgICAgICAgPGEgaHJlZj1cIiR7cmVzZXRVcmx9XCIgY2xhc3M9XCJidXR0b25cIj5SZXNldCBQYXNzd29yZDwvYT5cblxuICAgICAgICAgICAgICAgICAgICA8cD48c3Ryb25nPlRoaXMgbGluayB3aWxsIGV4cGlyZSBpbiAxIGhvdXIuPC9zdHJvbmc+PC9wPlxuXG4gICAgICAgICAgICAgICAgICAgIDxwPklmIHlvdSBkaWQgbm90IHJlcXVlc3QgdGhpcyBwYXNzd29yZCByZXNldCwgcGxlYXNlIGlnbm9yZSB0aGlzIGVtYWlsLjwvcD5cblxuICAgICAgICAgICAgICAgICAgICA8cD5Gb3Igc2VjdXJpdHkgcmVhc29ucywgdGhpcyBsaW5rIGNhbiBvbmx5IGJlIHVzZWQgb25jZS48L3A+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImZvb3RlclwiPlxuICAgICAgICAgICAgICAgICAgICA8cD5JZiB0aGUgYnV0dG9uIGRvZXNuJ3Qgd29yaywgY29weSBhbmQgcGFzdGUgdGhpcyBVUkwgaW50byB5b3VyIGJyb3dzZXI6PC9wPlxuICAgICAgICAgICAgICAgICAgICA8cD4ke3Jlc2V0VXJsfTwvcD5cbiAgICAgICAgICAgICAgICAgICAgPHA+JmNvcHk7IDIwMjQgQ2hhdC1KUy4gQWxsIHJpZ2h0cyByZXNlcnZlZC48L3A+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9ib2R5PlxuICAgICAgICA8L2h0bWw+XG4gICAgICBgLFxuICAgICAgdGV4dDogYFxuICAgICAgICBQYXNzd29yZCBSZXNldCBSZXF1ZXN0IC0gQ2hhdC1KU1xuXG4gICAgICAgIFlvdSBoYXZlIHJlcXVlc3RlZCB0byByZXNldCB5b3VyIHBhc3N3b3JkLlxuXG4gICAgICAgIFBsZWFzZSB1c2UgdGhlIGZvbGxvd2luZyBsaW5rIHRvIHJlc2V0IHlvdXIgcGFzc3dvcmQ6XG4gICAgICAgICR7cmVzZXRVcmx9XG5cbiAgICAgICAgVGhpcyBsaW5rIHdpbGwgZXhwaXJlIGluIDEgaG91ci5cblxuICAgICAgICBJZiB5b3UgZGlkIG5vdCByZXF1ZXN0IHRoaXMgcGFzc3dvcmQgcmVzZXQsIHBsZWFzZSBpZ25vcmUgdGhpcyBlbWFpbC5cblxuICAgICAgICBCZXN0IHJlZ2FyZHMsXG4gICAgICAgIENoYXQtSlMgU3VwcG9ydCBUZWFtXG4gICAgICBgXG4gICAgfTtcblxuICAgIHRyeSB7XG4gICAgICBjb25zdCBpbmZvID0gYXdhaXQgdGhpcy50cmFuc3BvcnRlci5zZW5kTWFpbChtYWlsT3B0aW9ucyk7XG4gICAgICBjb25zb2xlLmxvZygnUGFzc3dvcmQgcmVzZXQgZW1haWwgc2VudDonLCBpbmZvLm1lc3NhZ2VJZCk7XG4gICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBtZXNzYWdlSWQ6IGluZm8ubWVzc2FnZUlkIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHNlbmRpbmcgcGFzc3dvcmQgcmVzZXQgZW1haWw6JywgZXJyb3IpO1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgc2VuZFBhc3N3b3JkUmVzZXRTdWNjZXNzRW1haWwoZW1haWwpIHtcbiAgICBjb25zdCBtYWlsT3B0aW9ucyA9IHtcbiAgICAgIGZyb206IHtcbiAgICAgICAgbmFtZTogJ0NoYXQtSlMgU3VwcG9ydCcsXG4gICAgICAgIGFkZHJlc3M6IHByb2Nlc3MuZW52LlNNVFBfVVNFUlxuICAgICAgfSxcbiAgICAgIHRvOiBlbWFpbCxcbiAgICAgIHN1YmplY3Q6ICdQYXNzd29yZCBSZXNldCBTdWNjZXNzZnVsIC0gQ2hhdC1KUycsXG4gICAgICBodG1sOiBgXG4gICAgICAgIDwhRE9DVFlQRSBodG1sPlxuICAgICAgICA8aHRtbCBsYW5nPVwiZW5cIj5cbiAgICAgICAgPGhlYWQ+XG4gICAgICAgICAgICA8bWV0YSBjaGFyc2V0PVwiVVRGLThcIj5cbiAgICAgICAgICAgIDxtZXRhIG5hbWU9XCJ2aWV3cG9ydFwiIGNvbnRlbnQ9XCJ3aWR0aD1kZXZpY2Utd2lkdGgsIGluaXRpYWwtc2NhbGU9MS4wXCI+XG4gICAgICAgICAgICA8dGl0bGU+UGFzc3dvcmQgUmVzZXQgU3VjY2Vzc2Z1bDwvdGl0bGU+XG4gICAgICAgICAgICA8c3R5bGU+XG4gICAgICAgICAgICAgICAgYm9keSB7IGZvbnQtZmFtaWx5OiBBcmlhbCwgc2Fucy1zZXJpZjsgbGluZS1oZWlnaHQ6IDEuNjsgY29sb3I6ICMzMzM7IH1cbiAgICAgICAgICAgICAgICAuY29udGFpbmVyIHsgbWF4LXdpZHRoOiA2MDBweDsgbWFyZ2luOiAwIGF1dG87IHBhZGRpbmc6IDIwcHg7IH1cbiAgICAgICAgICAgICAgICAuaGVhZGVyIHsgYmFja2dyb3VuZDogbGluZWFyLWdyYWRpZW50KDEzNWRlZywgIzI4YTc0NSAwJSwgIzIwYzk5NyAxMDAlKTsgY29sb3I6IHdoaXRlOyBwYWRkaW5nOiAyMHB4OyBib3JkZXItcmFkaXVzOiAxMHB4IDEwcHggMCAwOyB9XG4gICAgICAgICAgICAgICAgLmNvbnRlbnQgeyBiYWNrZ3JvdW5kOiAjZjhmOWZhOyBwYWRkaW5nOiAyMHB4OyBib3JkZXI6IDFweCBzb2xpZCAjZGVlMmU2OyB9XG4gICAgICAgICAgICAgICAgLmZvb3RlciB7IGJhY2tncm91bmQ6ICM2Yzc1N2Q7IGNvbG9yOiB3aGl0ZTsgcGFkZGluZzogMjBweDsgYm9yZGVyLXJhZGl1czogMCAwIDEwcHggMTBweDsgZm9udC1zaXplOiAxMnB4OyB9XG4gICAgICAgICAgICA8L3N0eWxlPlxuICAgICAgICA8L2hlYWQ+XG4gICAgICAgIDxib2R5PlxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cImNvbnRhaW5lclwiPlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJoZWFkZXJcIj5cbiAgICAgICAgICAgICAgICAgICAgPGgyPlBhc3N3b3JkIFJlc2V0IFN1Y2Nlc3NmdWw8L2gyPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJjb250ZW50XCI+XG4gICAgICAgICAgICAgICAgICAgIDxwPllvdXIgcGFzc3dvcmQgaGFzIGJlZW4gc3VjY2Vzc2Z1bGx5IHJlc2V0ITwvcD5cbiAgICAgICAgICAgICAgICAgICAgPHA+WW91IGNhbiBub3cgc2lnbiBpbiB0byB5b3VyIENoYXQtSlMgYWNjb3VudCB3aXRoIHlvdXIgbmV3IHBhc3N3b3JkLjwvcD5cbiAgICAgICAgICAgICAgICAgICAgPHA+SWYgeW91IGRpZCBub3QgbWFrZSB0aGlzIGNoYW5nZSwgcGxlYXNlIGNvbnRhY3Qgb3VyIHN1cHBvcnQgdGVhbSBpbW1lZGlhdGVseS48L3A+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImZvb3RlclwiPlxuICAgICAgICAgICAgICAgICAgICA8cD4mY29weTsgMjAyNCBDaGF0LUpTLiBBbGwgcmlnaHRzIHJlc2VydmVkLjwvcD5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L2JvZHk+XG4gICAgICAgIDwvaHRtbD5cbiAgICAgIGAsXG4gICAgICB0ZXh0OiBgXG4gICAgICAgIFBhc3N3b3JkIFJlc2V0IFN1Y2Nlc3NmdWwgLSBDaGF0LUpTXG5cbiAgICAgICAgWW91ciBwYXNzd29yZCBoYXMgYmVlbiBzdWNjZXNzZnVsbHkgcmVzZXQhXG5cbiAgICAgICAgWW91IGNhbiBub3cgc2lnbiBpbiB0byB5b3VyIENoYXQtSlMgYWNjb3VudCB3aXRoIHlvdXIgbmV3IHBhc3N3b3JkLlxuXG4gICAgICAgIElmIHlvdSBkaWQgbm90IG1ha2UgdGhpcyBjaGFuZ2UsIHBsZWFzZSBjb250YWN0IG91ciBzdXBwb3J0IHRlYW0gaW1tZWRpYXRlbHkuXG5cbiAgICAgICAgQmVzdCByZWdhcmRzLFxuICAgICAgICBDaGF0LUpTIFN1cHBvcnQgVGVhbVxuICAgICAgYFxuICAgIH07XG5cbiAgICB0cnkge1xuICAgICAgY29uc3QgaW5mbyA9IGF3YWl0IHRoaXMudHJhbnNwb3J0ZXIuc2VuZE1haWwobWFpbE9wdGlvbnMpO1xuICAgICAgY29uc29sZS5sb2coJ1Bhc3N3b3JkIHJlc2V0IHN1Y2Nlc3MgZW1haWwgc2VudDonLCBpbmZvLm1lc3NhZ2VJZCk7XG4gICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBtZXNzYWdlSWQ6IGluZm8ubWVzc2FnZUlkIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHNlbmRpbmcgcGFzc3dvcmQgcmVzZXQgc3VjY2VzcyBlbWFpbDonLCBlcnJvcik7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gIH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSBuZXcgRW1haWxTZXJ2aWNlKCk7Il0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztJQWVZO0lBQUFBLGFBQUEsWUFBQUEsQ0FBQTtNQUFBLE9BQUFDLGNB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