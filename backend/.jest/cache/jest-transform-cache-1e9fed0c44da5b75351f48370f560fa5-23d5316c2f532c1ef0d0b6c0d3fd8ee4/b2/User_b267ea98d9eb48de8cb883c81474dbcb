04892e4151f6fff8985026b196b2eec4
const mongoose = require('mongoose');
const bcrypt = require('bcryptjs');
const crypto = require('crypto');
const userSchema = new mongoose.Schema({
  nickname: {
    type: String,
    required: true,
    unique: true,
    trim: true,
    minlength: 3,
    maxlength: 50,
    index: true // Remove duplicate index call below
  },
  email: {
    type: String,
    required: true,
    unique: true,
    lowercase: true,
    trim: true,
    index: true // Remove duplicate index call below
  },
  password: {
    type: String,
    required: true,
    minlength: 6
  },
  role: {
    type: String,
    enum: ['admin', 'moderator', 'member'],
    default: 'member'
  },
  createdAt: {
    type: Date,
    default: Date.now
  },
  lastActive: {
    type: Date,
    default: Date.now
  },
  status: {
    type: String,
    enum: ['online', 'offline'],
    default: 'offline'
  },
  // Moderation fields
  banned: {
    type: Boolean,
    default: false
  },
  banReason: {
    type: String,
    default: null
  },
  banExpires: {
    type: Date,
    default: null
  },
  warnings: [{
    reason: String,
    issuedBy: {
      type: mongoose.Schema.Types.ObjectId,
      ref: 'User'
    },
    issuedAt: {
      type: Date,
      default: Date.now
    },
    expires: Date
  }],
  muteExpires: {
    type: Date,
    default: null
  },
  // Temporary tokens
  resetPasswordToken: {
    type: String,
    default: null
  },
  resetPasswordExpires: {
    type: Date,
    default: null
  },
  moderationToken: {
    type: String,
    default: null
  },
  moderationTokenExpires: {
    type: Date,
    default: null
  }
});

// Hash password before saving
userSchema.pre('save', async function (next) {
  if (!this.isModified('password')) return next();
  console.log('Hashing password for user:', this.nickname);
  try {
    const salt = await bcrypt.genSalt(12);
    console.log('Salt generated:', salt);
    this.password = await bcrypt.hash(this.password, salt);
    console.log('Password hashed successfully');
    next();
  } catch (error) {
    console.error('Error hashing password:', error.message);
    next(error);
  }
});

// Compare password method
userSchema.methods.comparePassword = async function (candidatePassword) {
  return bcrypt.compare(candidatePassword, this.password);
};

// Generate reset password token
userSchema.methods.generateResetToken = function () {
  // Generate random token
  const resetToken = crypto.randomBytes(32).toString('hex');

  // Hash token before storing
  this.resetPasswordToken = crypto.createHash('sha256').update(resetToken).digest('hex');

  // Set expiration (1 hour from now)
  this.resetPasswordExpires = Date.now() + 60 * 60 * 1000; // 1 hour

  return resetToken;
};

// Reset password using token
userSchema.methods.resetPassword = function (token, newPassword) {
  const hashedToken = crypto.createHash('sha256').update(token).digest('hex');
  if (hashedToken !== this.resetPasswordToken) {
    throw new Error('Invalid or expired password reset token');
  }
  if (Date.now() > this.resetPasswordExpires) {
    throw new Error('Password reset token has expired');
  }
  this.password = newPassword;
  this.resetPasswordToken = null;
  this.resetPasswordExpires = null;
  return this.save();
};

// Ban user
userSchema.methods.ban = function (reason, duration = null, issuedBy = null) {
  this.banned = true;
  this.banReason = reason;
  if (duration) {
    this.banExpires = new Date(Date.now() + duration);
  } else {
    this.banExpires = null; // permanent ban
  }
  return this.save();
};

// Unban user
userSchema.methods.unban = function () {
  this.banned = false;
  this.banReason = null;
  this.banExpires = null;
  return this.save();
};

// Check if user is banned and if ban is active
userSchema.methods.isBanned = function () {
  if (!this.banned) return false;
  if (!this.banExpires) return true; // permanent ban
  return this.banExpires > new Date(); // temporary ban still active
};

// Add warning to user
userSchema.methods.warn = function (reason, issuedBy, duration = null) {
  const warning = {
    reason: reason,
    issuedBy: issuedBy,
    issuedAt: new Date(),
    expires: duration ? new Date(Date.now() + duration) : null
  };
  this.warnings.push(warning);
  return this.save();
};

// Remove expired warnings
userSchema.methods.cleanWarnings = function () {
  this.warnings = this.warnings.filter(warning => {
    return !warning.expires || warning.expires > new Date();
  });
  return this.save();
};

// Get active warnings count
userSchema.methods.getActiveWarningsCount = function () {
  this.cleanWarnings();
  return this.warnings.length;
};

// Mute user (for chat)
userSchema.methods.mute = function (duration = 3600000) {
  // default 1 hour
  this.muteExpires = new Date(Date.now() + duration);
  return this.save();
};

// Unmute user
userSchema.methods.unmute = function () {
  this.muteExpires = null;
  return this.save();
};

// Check if user is muted
userSchema.methods.isMuted = function () {
  return this.muteExpires && this.muteExpires > new Date();
};

// Generate moderation token for admin actions
userSchema.methods.generateModerationToken = function () {
  const moderationToken = crypto.randomBytes(32).toString('hex');
  this.moderationToken = crypto.createHash('sha256').update(moderationToken).digest('hex');
  this.moderationTokenExpires = Date.now() + 3600000; // 1 hour
  return this.save().then(() => moderationToken);
};

// Verify moderation token
userSchema.methods.verifyModerationToken = function (token) {
  const hashedToken = crypto.createHash('sha256').update(token).digest('hex');
  if (hashedToken !== this.moderationToken) {
    throw new Error('Invalid moderation token');
  }
  if (Date.now() > this.moderationTokenExpires) {
    throw new Error('Moderation token expired');
  }
  this.moderationToken = null;
  this.moderationTokenExpires = null;
  return this.save();
};

// Check if user has moderator/admin permissions
userSchema.methods.hasModeratorPrivileges = function () {
  return this.role === 'admin' || this.role === 'moderator';
};
userSchema.methods.hasAdminPrivileges = function () {
  return this.role === 'admin';
};

// Remove password and sensitive data from JSON output
userSchema.methods.toJSON = function () {
  const userObject = this.toObject();
  delete userObject.password;
  delete userObject.resetPasswordToken;
  delete userObject.resetPasswordExpires;
  delete userObject.moderationToken;
  delete userObject.moderationTokenExpires;
  // Don't show ban details to regular users
  if (!this.hasModeratorPrivileges()) {
    delete userObject.banReason;
    delete userObject.banExpires;
    delete userObject.warnings;
  }
  return userObject;
};

// Prevent OverwriteModelError by checking existing models
module.exports = mongoose.models.User || mongoose.model('User', userSchema);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJtb25nb29zZSIsInJlcXVpcmUiLCJiY3J5cHQiLCJjcnlwdG8iLCJ1c2VyU2NoZW1hIiwiU2NoZW1hIiwibmlja25hbWUiLCJ0eXBlIiwiU3RyaW5nIiwicmVxdWlyZWQiLCJ1bmlxdWUiLCJ0cmltIiwibWlubGVuZ3RoIiwibWF4bGVuZ3RoIiwiaW5kZXgiLCJlbWFpbCIsImxvd2VyY2FzZSIsInBhc3N3b3JkIiwicm9sZSIsImVudW0iLCJkZWZhdWx0IiwiY3JlYXRlZEF0IiwiRGF0ZSIsIm5vdyIsImxhc3RBY3RpdmUiLCJzdGF0dXMiLCJiYW5uZWQiLCJCb29sZWFuIiwiYmFuUmVhc29uIiwiYmFuRXhwaXJlcyIsIndhcm5pbmdzIiwicmVhc29uIiwiaXNzdWVkQnkiLCJUeXBlcyIsIk9iamVjdElkIiwicmVmIiwiaXNzdWVkQXQiLCJleHBpcmVzIiwibXV0ZUV4cGlyZXMiLCJyZXNldFBhc3N3b3JkVG9rZW4iLCJyZXNldFBhc3N3b3JkRXhwaXJlcyIsIm1vZGVyYXRpb25Ub2tlbiIsIm1vZGVyYXRpb25Ub2tlbkV4cGlyZXMiLCJwcmUiLCJuZXh0IiwiaXNNb2RpZmllZCIsImNvbnNvbGUiLCJsb2ciLCJzYWx0IiwiZ2VuU2FsdCIsImhhc2giLCJlcnJvciIsIm1lc3NhZ2UiLCJtZXRob2RzIiwiY29tcGFyZVBhc3N3b3JkIiwiY2FuZGlkYXRlUGFzc3dvcmQiLCJjb21wYXJlIiwiZ2VuZXJhdGVSZXNldFRva2VuIiwicmVzZXRUb2tlbiIsInJhbmRvbUJ5dGVzIiwidG9TdHJpbmciLCJjcmVhdGVIYXNoIiwidXBkYXRlIiwiZGlnZXN0IiwicmVzZXRQYXNzd29yZCIsInRva2VuIiwibmV3UGFzc3dvcmQiLCJoYXNoZWRUb2tlbiIsIkVycm9yIiwic2F2ZSIsImJhbiIsImR1cmF0aW9uIiwidW5iYW4iLCJpc0Jhbm5lZCIsIndhcm4iLCJ3YXJuaW5nIiwicHVzaCIsImNsZWFuV2FybmluZ3MiLCJmaWx0ZXIiLCJnZXRBY3RpdmVXYXJuaW5nc0NvdW50IiwibGVuZ3RoIiwibXV0ZSIsInVubXV0ZSIsImlzTXV0ZWQiLCJnZW5lcmF0ZU1vZGVyYXRpb25Ub2tlbiIsInRoZW4iLCJ2ZXJpZnlNb2RlcmF0aW9uVG9rZW4iLCJoYXNNb2RlcmF0b3JQcml2aWxlZ2VzIiwiaGFzQWRtaW5Qcml2aWxlZ2VzIiwidG9KU09OIiwidXNlck9iamVjdCIsInRvT2JqZWN0IiwibW9kdWxlIiwiZXhwb3J0cyIsIm1vZGVscyIsIlVzZXIiLCJtb2RlbCJdLCJzb3VyY2VzIjpbIlVzZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgbW9uZ29vc2UgPSByZXF1aXJlKCdtb25nb29zZScpO1xuY29uc3QgYmNyeXB0ID0gcmVxdWlyZSgnYmNyeXB0anMnKTtcbmNvbnN0IGNyeXB0byA9IHJlcXVpcmUoJ2NyeXB0bycpO1xuXG5jb25zdCB1c2VyU2NoZW1hID0gbmV3IG1vbmdvb3NlLlNjaGVtYSh7XG4gIG5pY2tuYW1lOiB7XG4gICAgdHlwZTogU3RyaW5nLFxuICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIHVuaXF1ZTogdHJ1ZSxcbiAgICB0cmltOiB0cnVlLFxuICAgIG1pbmxlbmd0aDogMyxcbiAgICBtYXhsZW5ndGg6IDUwLFxuICAgIGluZGV4OiB0cnVlIC8vIFJlbW92ZSBkdXBsaWNhdGUgaW5kZXggY2FsbCBiZWxvd1xuICB9LFxuICBlbWFpbDoge1xuICAgIHR5cGU6IFN0cmluZyxcbiAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICB1bmlxdWU6IHRydWUsXG4gICAgbG93ZXJjYXNlOiB0cnVlLFxuICAgIHRyaW06IHRydWUsXG4gICAgaW5kZXg6IHRydWUgLy8gUmVtb3ZlIGR1cGxpY2F0ZSBpbmRleCBjYWxsIGJlbG93XG4gIH0sXG4gIHBhc3N3b3JkOiB7XG4gICAgdHlwZTogU3RyaW5nLFxuICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIG1pbmxlbmd0aDogNlxuICB9LFxuICByb2xlOiB7XG4gICAgdHlwZTogU3RyaW5nLFxuICAgIGVudW06IFsnYWRtaW4nLCAnbW9kZXJhdG9yJywgJ21lbWJlciddLFxuICAgIGRlZmF1bHQ6ICdtZW1iZXInXG4gIH0sXG4gIGNyZWF0ZWRBdDoge1xuICAgIHR5cGU6IERhdGUsXG4gICAgZGVmYXVsdDogRGF0ZS5ub3dcbiAgfSxcbiAgbGFzdEFjdGl2ZToge1xuICAgIHR5cGU6IERhdGUsXG4gICAgZGVmYXVsdDogRGF0ZS5ub3dcbiAgfSxcbiAgc3RhdHVzOiB7XG4gICAgdHlwZTogU3RyaW5nLFxuICAgIGVudW06IFsnb25saW5lJywgJ29mZmxpbmUnXSxcbiAgICBkZWZhdWx0OiAnb2ZmbGluZSdcbiAgfSxcbiAgLy8gTW9kZXJhdGlvbiBmaWVsZHNcbiAgYmFubmVkOiB7XG4gICAgdHlwZTogQm9vbGVhbixcbiAgICBkZWZhdWx0OiBmYWxzZVxuICB9LFxuICBiYW5SZWFzb246IHtcbiAgICB0eXBlOiBTdHJpbmcsXG4gICAgZGVmYXVsdDogbnVsbFxuICB9LFxuICBiYW5FeHBpcmVzOiB7XG4gICAgdHlwZTogRGF0ZSxcbiAgICBkZWZhdWx0OiBudWxsXG4gIH0sXG4gIHdhcm5pbmdzOiBbe1xuICAgIHJlYXNvbjogU3RyaW5nLFxuICAgIGlzc3VlZEJ5OiB7IHR5cGU6IG1vbmdvb3NlLlNjaGVtYS5UeXBlcy5PYmplY3RJZCwgcmVmOiAnVXNlcicgfSxcbiAgICBpc3N1ZWRBdDogeyB0eXBlOiBEYXRlLCBkZWZhdWx0OiBEYXRlLm5vdyB9LFxuICAgIGV4cGlyZXM6IERhdGVcbiAgfV0sXG4gIG11dGVFeHBpcmVzOiB7XG4gICAgdHlwZTogRGF0ZSxcbiAgICBkZWZhdWx0OiBudWxsXG4gIH0sXG4gIC8vIFRlbXBvcmFyeSB0b2tlbnNcbiAgcmVzZXRQYXNzd29yZFRva2VuOiB7XG4gICAgdHlwZTogU3RyaW5nLFxuICAgIGRlZmF1bHQ6IG51bGxcbiAgfSxcbiAgcmVzZXRQYXNzd29yZEV4cGlyZXM6IHtcbiAgICB0eXBlOiBEYXRlLFxuICAgIGRlZmF1bHQ6IG51bGxcbiAgfSxcbiAgbW9kZXJhdGlvblRva2VuOiB7XG4gICAgdHlwZTogU3RyaW5nLFxuICAgIGRlZmF1bHQ6IG51bGxcbiAgfSxcbiAgbW9kZXJhdGlvblRva2VuRXhwaXJlczoge1xuICAgIHR5cGU6IERhdGUsXG4gICAgZGVmYXVsdDogbnVsbFxuICB9XG59KTtcblxuLy8gSGFzaCBwYXNzd29yZCBiZWZvcmUgc2F2aW5nXG51c2VyU2NoZW1hLnByZSgnc2F2ZScsIGFzeW5jIGZ1bmN0aW9uKG5leHQpIHtcbiAgIGlmICghdGhpcy5pc01vZGlmaWVkKCdwYXNzd29yZCcpKSByZXR1cm4gbmV4dCgpO1xuXG4gICBjb25zb2xlLmxvZygnSGFzaGluZyBwYXNzd29yZCBmb3IgdXNlcjonLCB0aGlzLm5pY2tuYW1lKTtcbiAgIHRyeSB7XG4gICAgIGNvbnN0IHNhbHQgPSBhd2FpdCBiY3J5cHQuZ2VuU2FsdCgxMik7XG4gICAgIGNvbnNvbGUubG9nKCdTYWx0IGdlbmVyYXRlZDonLCBzYWx0KTtcbiAgICAgdGhpcy5wYXNzd29yZCA9IGF3YWl0IGJjcnlwdC5oYXNoKHRoaXMucGFzc3dvcmQsIHNhbHQpO1xuICAgICBjb25zb2xlLmxvZygnUGFzc3dvcmQgaGFzaGVkIHN1Y2Nlc3NmdWxseScpO1xuICAgICBuZXh0KCk7XG4gICB9IGNhdGNoIChlcnJvcikge1xuICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBoYXNoaW5nIHBhc3N3b3JkOicsIGVycm9yLm1lc3NhZ2UpO1xuICAgICBuZXh0KGVycm9yKTtcbiAgIH1cbiB9KTtcblxuLy8gQ29tcGFyZSBwYXNzd29yZCBtZXRob2RcbnVzZXJTY2hlbWEubWV0aG9kcy5jb21wYXJlUGFzc3dvcmQgPSBhc3luYyBmdW5jdGlvbihjYW5kaWRhdGVQYXNzd29yZCkge1xuICByZXR1cm4gYmNyeXB0LmNvbXBhcmUoY2FuZGlkYXRlUGFzc3dvcmQsIHRoaXMucGFzc3dvcmQpO1xufTtcblxuLy8gR2VuZXJhdGUgcmVzZXQgcGFzc3dvcmQgdG9rZW5cbnVzZXJTY2hlbWEubWV0aG9kcy5nZW5lcmF0ZVJlc2V0VG9rZW4gPSBmdW5jdGlvbigpIHtcbiAgLy8gR2VuZXJhdGUgcmFuZG9tIHRva2VuXG4gIGNvbnN0IHJlc2V0VG9rZW4gPSBjcnlwdG8ucmFuZG9tQnl0ZXMoMzIpLnRvU3RyaW5nKCdoZXgnKTtcblxuICAvLyBIYXNoIHRva2VuIGJlZm9yZSBzdG9yaW5nXG4gIHRoaXMucmVzZXRQYXNzd29yZFRva2VuID0gY3J5cHRvXG4gICAgLmNyZWF0ZUhhc2goJ3NoYTI1NicpXG4gICAgLnVwZGF0ZShyZXNldFRva2VuKVxuICAgIC5kaWdlc3QoJ2hleCcpO1xuXG4gIC8vIFNldCBleHBpcmF0aW9uICgxIGhvdXIgZnJvbSBub3cpXG4gIHRoaXMucmVzZXRQYXNzd29yZEV4cGlyZXMgPSBEYXRlLm5vdygpICsgNjAgKiA2MCAqIDEwMDA7IC8vIDEgaG91clxuXG4gIHJldHVybiByZXNldFRva2VuO1xufTtcblxuLy8gUmVzZXQgcGFzc3dvcmQgdXNpbmcgdG9rZW5cbnVzZXJTY2hlbWEubWV0aG9kcy5yZXNldFBhc3N3b3JkID0gZnVuY3Rpb24odG9rZW4sIG5ld1Bhc3N3b3JkKSB7XG4gIGNvbnN0IGhhc2hlZFRva2VuID0gY3J5cHRvXG4gICAgLmNyZWF0ZUhhc2goJ3NoYTI1NicpXG4gICAgLnVwZGF0ZSh0b2tlbilcbiAgICAuZGlnZXN0KCdoZXgnKTtcblxuICBpZiAoaGFzaGVkVG9rZW4gIT09IHRoaXMucmVzZXRQYXNzd29yZFRva2VuKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIG9yIGV4cGlyZWQgcGFzc3dvcmQgcmVzZXQgdG9rZW4nKTtcbiAgfVxuXG4gIGlmIChEYXRlLm5vdygpID4gdGhpcy5yZXNldFBhc3N3b3JkRXhwaXJlcykge1xuICAgIHRocm93IG5ldyBFcnJvcignUGFzc3dvcmQgcmVzZXQgdG9rZW4gaGFzIGV4cGlyZWQnKTtcbiAgfVxuXG4gIHRoaXMucGFzc3dvcmQgPSBuZXdQYXNzd29yZDtcbiAgdGhpcy5yZXNldFBhc3N3b3JkVG9rZW4gPSBudWxsO1xuICB0aGlzLnJlc2V0UGFzc3dvcmRFeHBpcmVzID0gbnVsbDtcblxuICByZXR1cm4gdGhpcy5zYXZlKCk7XG59O1xuXG4vLyBCYW4gdXNlclxudXNlclNjaGVtYS5tZXRob2RzLmJhbiA9IGZ1bmN0aW9uKHJlYXNvbiwgZHVyYXRpb24gPSBudWxsLCBpc3N1ZWRCeSA9IG51bGwpIHtcbiAgdGhpcy5iYW5uZWQgPSB0cnVlO1xuICB0aGlzLmJhblJlYXNvbiA9IHJlYXNvbjtcbiAgaWYgKGR1cmF0aW9uKSB7XG4gICAgdGhpcy5iYW5FeHBpcmVzID0gbmV3IERhdGUoRGF0ZS5ub3coKSArIGR1cmF0aW9uKTtcbiAgfSBlbHNlIHtcbiAgICB0aGlzLmJhbkV4cGlyZXMgPSBudWxsOyAvLyBwZXJtYW5lbnQgYmFuXG4gIH1cbiAgcmV0dXJuIHRoaXMuc2F2ZSgpO1xufTtcblxuLy8gVW5iYW4gdXNlclxudXNlclNjaGVtYS5tZXRob2RzLnVuYmFuID0gZnVuY3Rpb24oKSB7XG4gIHRoaXMuYmFubmVkID0gZmFsc2U7XG4gIHRoaXMuYmFuUmVhc29uID0gbnVsbDtcbiAgdGhpcy5iYW5FeHBpcmVzID0gbnVsbDtcbiAgcmV0dXJuIHRoaXMuc2F2ZSgpO1xufTtcblxuLy8gQ2hlY2sgaWYgdXNlciBpcyBiYW5uZWQgYW5kIGlmIGJhbiBpcyBhY3RpdmVcbnVzZXJTY2hlbWEubWV0aG9kcy5pc0Jhbm5lZCA9IGZ1bmN0aW9uKCkge1xuICBpZiAoIXRoaXMuYmFubmVkKSByZXR1cm4gZmFsc2U7XG4gIGlmICghdGhpcy5iYW5FeHBpcmVzKSByZXR1cm4gdHJ1ZTsgLy8gcGVybWFuZW50IGJhblxuICByZXR1cm4gdGhpcy5iYW5FeHBpcmVzID4gbmV3IERhdGUoKTsgLy8gdGVtcG9yYXJ5IGJhbiBzdGlsbCBhY3RpdmVcbn07XG5cbi8vIEFkZCB3YXJuaW5nIHRvIHVzZXJcbnVzZXJTY2hlbWEubWV0aG9kcy53YXJuID0gZnVuY3Rpb24ocmVhc29uLCBpc3N1ZWRCeSwgZHVyYXRpb24gPSBudWxsKSB7XG4gIGNvbnN0IHdhcm5pbmcgPSB7XG4gICAgcmVhc29uOiByZWFzb24sXG4gICAgaXNzdWVkQnk6IGlzc3VlZEJ5LFxuICAgIGlzc3VlZEF0OiBuZXcgRGF0ZSgpLFxuICAgIGV4cGlyZXM6IGR1cmF0aW9uID8gbmV3IERhdGUoRGF0ZS5ub3coKSArIGR1cmF0aW9uKSA6IG51bGxcbiAgfTtcbiAgdGhpcy53YXJuaW5ncy5wdXNoKHdhcm5pbmcpO1xuICByZXR1cm4gdGhpcy5zYXZlKCk7XG59O1xuXG4vLyBSZW1vdmUgZXhwaXJlZCB3YXJuaW5nc1xudXNlclNjaGVtYS5tZXRob2RzLmNsZWFuV2FybmluZ3MgPSBmdW5jdGlvbigpIHtcbiAgdGhpcy53YXJuaW5ncyA9IHRoaXMud2FybmluZ3MuZmlsdGVyKHdhcm5pbmcgPT4ge1xuICAgIHJldHVybiAhd2FybmluZy5leHBpcmVzIHx8IHdhcm5pbmcuZXhwaXJlcyA+IG5ldyBEYXRlKCk7XG4gIH0pO1xuICByZXR1cm4gdGhpcy5zYXZlKCk7XG59O1xuXG4vLyBHZXQgYWN0aXZlIHdhcm5pbmdzIGNvdW50XG51c2VyU2NoZW1hLm1ldGhvZHMuZ2V0QWN0aXZlV2FybmluZ3NDb3VudCA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLmNsZWFuV2FybmluZ3MoKTtcbiAgcmV0dXJuIHRoaXMud2FybmluZ3MubGVuZ3RoO1xufTtcblxuLy8gTXV0ZSB1c2VyIChmb3IgY2hhdClcbnVzZXJTY2hlbWEubWV0aG9kcy5tdXRlID0gZnVuY3Rpb24oZHVyYXRpb24gPSAzNjAwMDAwKSB7IC8vIGRlZmF1bHQgMSBob3VyXG4gIHRoaXMubXV0ZUV4cGlyZXMgPSBuZXcgRGF0ZShEYXRlLm5vdygpICsgZHVyYXRpb24pO1xuICByZXR1cm4gdGhpcy5zYXZlKCk7XG59O1xuXG4vLyBVbm11dGUgdXNlclxudXNlclNjaGVtYS5tZXRob2RzLnVubXV0ZSA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLm11dGVFeHBpcmVzID0gbnVsbDtcbiAgcmV0dXJuIHRoaXMuc2F2ZSgpO1xufTtcblxuLy8gQ2hlY2sgaWYgdXNlciBpcyBtdXRlZFxudXNlclNjaGVtYS5tZXRob2RzLmlzTXV0ZWQgPSBmdW5jdGlvbigpIHtcbiAgcmV0dXJuIHRoaXMubXV0ZUV4cGlyZXMgJiYgdGhpcy5tdXRlRXhwaXJlcyA+IG5ldyBEYXRlKCk7XG59O1xuXG4vLyBHZW5lcmF0ZSBtb2RlcmF0aW9uIHRva2VuIGZvciBhZG1pbiBhY3Rpb25zXG51c2VyU2NoZW1hLm1ldGhvZHMuZ2VuZXJhdGVNb2RlcmF0aW9uVG9rZW4gPSBmdW5jdGlvbigpIHtcbiAgY29uc3QgbW9kZXJhdGlvblRva2VuID0gY3J5cHRvLnJhbmRvbUJ5dGVzKDMyKS50b1N0cmluZygnaGV4Jyk7XG4gIHRoaXMubW9kZXJhdGlvblRva2VuID0gY3J5cHRvXG4gICAgLmNyZWF0ZUhhc2goJ3NoYTI1NicpXG4gICAgLnVwZGF0ZShtb2RlcmF0aW9uVG9rZW4pXG4gICAgLmRpZ2VzdCgnaGV4Jyk7XG4gIHRoaXMubW9kZXJhdGlvblRva2VuRXhwaXJlcyA9IERhdGUubm93KCkgKyAzNjAwMDAwOyAvLyAxIGhvdXJcbiAgcmV0dXJuIHRoaXMuc2F2ZSgpLnRoZW4oKCkgPT4gbW9kZXJhdGlvblRva2VuKTtcbn07XG5cbi8vIFZlcmlmeSBtb2RlcmF0aW9uIHRva2VuXG51c2VyU2NoZW1hLm1ldGhvZHMudmVyaWZ5TW9kZXJhdGlvblRva2VuID0gZnVuY3Rpb24odG9rZW4pIHtcbiAgY29uc3QgaGFzaGVkVG9rZW4gPSBjcnlwdG9cbiAgICAuY3JlYXRlSGFzaCgnc2hhMjU2JylcbiAgICAudXBkYXRlKHRva2VuKVxuICAgIC5kaWdlc3QoJ2hleCcpO1xuXG4gIGlmIChoYXNoZWRUb2tlbiAhPT0gdGhpcy5tb2RlcmF0aW9uVG9rZW4pIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgbW9kZXJhdGlvbiB0b2tlbicpO1xuICB9XG5cbiAgaWYgKERhdGUubm93KCkgPiB0aGlzLm1vZGVyYXRpb25Ub2tlbkV4cGlyZXMpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ01vZGVyYXRpb24gdG9rZW4gZXhwaXJlZCcpO1xuICB9XG5cbiAgdGhpcy5tb2RlcmF0aW9uVG9rZW4gPSBudWxsO1xuICB0aGlzLm1vZGVyYXRpb25Ub2tlbkV4cGlyZXMgPSBudWxsO1xuICByZXR1cm4gdGhpcy5zYXZlKCk7XG59O1xuXG4vLyBDaGVjayBpZiB1c2VyIGhhcyBtb2RlcmF0b3IvYWRtaW4gcGVybWlzc2lvbnNcbnVzZXJTY2hlbWEubWV0aG9kcy5oYXNNb2RlcmF0b3JQcml2aWxlZ2VzID0gZnVuY3Rpb24oKSB7XG4gIHJldHVybiB0aGlzLnJvbGUgPT09ICdhZG1pbicgfHwgdGhpcy5yb2xlID09PSAnbW9kZXJhdG9yJztcbn07XG5cbnVzZXJTY2hlbWEubWV0aG9kcy5oYXNBZG1pblByaXZpbGVnZXMgPSBmdW5jdGlvbigpIHtcbiAgcmV0dXJuIHRoaXMucm9sZSA9PT0gJ2FkbWluJztcbn07XG5cbi8vIFJlbW92ZSBwYXNzd29yZCBhbmQgc2Vuc2l0aXZlIGRhdGEgZnJvbSBKU09OIG91dHB1dFxudXNlclNjaGVtYS5tZXRob2RzLnRvSlNPTiA9IGZ1bmN0aW9uKCkge1xuICBjb25zdCB1c2VyT2JqZWN0ID0gdGhpcy50b09iamVjdCgpO1xuICBkZWxldGUgdXNlck9iamVjdC5wYXNzd29yZDtcbiAgZGVsZXRlIHVzZXJPYmplY3QucmVzZXRQYXNzd29yZFRva2VuO1xuICBkZWxldGUgdXNlck9iamVjdC5yZXNldFBhc3N3b3JkRXhwaXJlcztcbiAgZGVsZXRlIHVzZXJPYmplY3QubW9kZXJhdGlvblRva2VuO1xuICBkZWxldGUgdXNlck9iamVjdC5tb2RlcmF0aW9uVG9rZW5FeHBpcmVzO1xuICAvLyBEb24ndCBzaG93IGJhbiBkZXRhaWxzIHRvIHJlZ3VsYXIgdXNlcnNcbiAgaWYgKCF0aGlzLmhhc01vZGVyYXRvclByaXZpbGVnZXMoKSkge1xuICAgIGRlbGV0ZSB1c2VyT2JqZWN0LmJhblJlYXNvbjtcbiAgICBkZWxldGUgdXNlck9iamVjdC5iYW5FeHBpcmVzO1xuICAgIGRlbGV0ZSB1c2VyT2JqZWN0Lndhcm5pbmdzO1xuICB9XG4gIHJldHVybiB1c2VyT2JqZWN0O1xufTtcblxuLy8gUHJldmVudCBPdmVyd3JpdGVNb2RlbEVycm9yIGJ5IGNoZWNraW5nIGV4aXN0aW5nIG1vZGVsc1xubW9kdWxlLmV4cG9ydHMgPSBtb25nb29zZS5tb2RlbHMuVXNlciB8fCBtb25nb29zZS5tb2RlbCgnVXNlcicsIHVzZXJTY2hlbWEpOyJdLCJtYXBwaW5ncyI6IkFBQUEsTUFBTUEsUUFBUSxHQUFHQyxPQUFPLENBQUMsVUFBVSxDQUFDO0FBQ3BDLE1BQU1DLE1BQU0sR0FBR0QsT0FBTyxDQUFDLFVBQVUsQ0FBQztBQUNsQyxNQUFNRSxNQUFNLEdBQUdGLE9BQU8sQ0FBQyxRQUFRLENBQUM7QUFFaEMsTUFBTUcsVUFBVSxHQUFHLElBQUlKLFFBQVEsQ0FBQ0ssTUFBTSxDQUFDO0VBQ3JDQyxRQUFRLEVBQUU7SUFDUkMsSUFBSSxFQUFFQyxNQUFNO0lBQ1pDLFFBQVEsRUFBRSxJQUFJO0lBQ2RDLE1BQU0sRUFBRSxJQUFJO0lBQ1pDLElBQUksRUFBRSxJQUFJO0lBQ1ZDLFNBQVMsRUFBRSxDQUFDO0lBQ1pDLFNBQVMsRUFBRSxFQUFFO0lBQ2JDLEtBQUssRUFBRSxJQUFJLENBQUM7RUFDZCxDQUFDO0VBQ0RDLEtBQUssRUFBRTtJQUNMUixJQUFJLEVBQUVDLE1BQU07SUFDWkMsUUFBUSxFQUFFLElBQUk7SUFDZEMsTUFBTSxFQUFFLElBQUk7SUFDWk0sU0FBUyxFQUFFLElBQUk7SUFDZkwsSUFBSSxFQUFFLElBQUk7SUFDVkcsS0FBSyxFQUFFLElBQUksQ0FBQztFQUNkLENBQUM7RUFDREcsUUFBUSxFQUFFO0lBQ1JWLElBQUksRUFBRUMsTUFBTTtJQUNaQyxRQUFRLEVBQUUsSUFBSTtJQUNkRyxTQUFTLEVBQUU7RUFDYixDQUFDO0VBQ0RNLElBQUksRUFBRTtJQUNKWCxJQUFJLEVBQUVDLE1BQU07SUFDWlcsSUFBSSxFQUFFLENBQUMsT0FBTyxFQUFFLFdBQVcsRUFBRSxR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